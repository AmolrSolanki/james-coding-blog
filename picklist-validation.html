<!DOCTYPE html><html><head><title>Joys Of Apex | Picklist Validation</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><meta name="robots" content="index,follow"><meta name="theme-color" content="#212121"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><link rel="shortcut icon" href="/joys-of-apex/favicon.ico"><link href="https://fonts.googleapis.com/css?family=Hind:400,700&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:300,400&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/icon?family=Material+Icons|Material+Icons+Outlined" rel="stylesheet"><style>
      body, input, button {
        font-family: 'Hind', sans-serif;
      }

      code, .hljs {
        font-family: 'Source Code Pro', 'Courier New', Courier, monospace;
      }

      .icon-font {
        font-family: 'Material Icons';
        font-weight: normal;
        font-style: normal;
        font-size: 24px;  /* Preferred icon size */
        display: inline-block;
        line-height: 1;
        text-transform: none;
        letter-spacing: normal;
        word-wrap: normal;
        white-space: nowrap;
        direction: ltr;
      
        /* Support for all WebKit browsers. */
        -webkit-font-smoothing: antialiased;
        /* Support for Safari and Chrome. */
        text-rendering: optimizeLegibility;
      
        /* Support for Firefox. */
        -moz-osx-font-smoothing: grayscale;
      
        /* Support for IE. */
        font-feature-settings: 'liga';
      }

      .icon-font.outline {
        font-family: 'Material Icons Outlined';
      }
    </style><link href="/joys-of-apex/styles/codedoc-styles.css" rel="stylesheet"><script async="" defer="" src="/joys-of-apex/bundle/codedoc-bundle.js"></script><meta property="og:image" content="./img/joys-of-apex-thumbnail.png"><script>window.githubConfig={"repo":"james-coding-blog","user":"jamessimone"}</script><style>.container{padding-top: 0 !important}</style><style>#-codedoc-toc { backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px) }</style><meta name="twitter:title" content="Joys Of Apex | Picklist Validation"><meta property="og:type" content="article"><meta property="og:title" content="Joys Of Apex | Picklist Validation"></head><body><header style="margin-left: 1rem">Read more at <a href="https://wwww.jamessimone.net">jamessimone.net</a>, or return to the <a href="/joys-of-apex/">homepage</a></header><div id="-codedoc-container" class="container"><script>window.source = {"base":"posts","path":"picklist-validation.md","namespace":"/joys-of-apex","title":{"base":"Joys Of Apex","connector":" | "}}</script><div class="hero-0-0-8" style="margin-bottom: -156px"><img src="/joys-of-apex/img/the-joys-of-apex.png" class="image-0-0-9" data-hero=""><span class="caption-0-0-10"></span></div><marker><br>
<br>
<br>
<br>
<br>

</marker><h1 class="h-0-0-11 "><span style="color: green; 
      text-shadow: none; 
      font-size: 48px"><p>Picklist Validation</p></span></h1><script id="TkiTNFGUPn">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("TkiTNFGUPn", "kRzsgnV+B7EQTskbovy+YA==", {"src":"github","date":"2020-04-14T15:00:00.000Z"});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script><div hidden="" data-ignore-text="" data-meta-override-property="og:image"><p>./img/joys-of-apex-thumbnail.png</p></div><p>Picklists in Salesforce replace traditional HTML select fields on the frontend. They also are driven by complex metadata types that we don't have programmatic access to in our code. I'll discuss one potential approach to strongly typing a picklist's values based on describe results and a little boilerplate.</p><p>"Magic" strings have a special place in programming hell; while there have been some language attempts to relegate strings to their respective places (static, final strings come to mind ...), picklists in Salesforce walk us away from the safety that we typically can embrace in a strongly-typed language. Furthermore, since Apex is character-insensitive, you're just one slip of the Shift key away from accidentally setting a field's values to some lowercase variation of the value you wanted -- hello, data fixes and hotfixes! (Alternatively, if you're talking about a restricted custom picklist ... hopefully you're testing that code path, or hello exceptions!)</p><p>So what can we do to try to sew up the disconnect between where picklist values live (either <code>StandardValueSet</code> or <code>GlobalValueSet</code>), and some semblance of strong typing on the contents of their values?</p><h2 id="enter-describefieldresults" class="heading-0-0-12"><span class="anchor-0-0-13" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Enter DescribeFieldResults</h2><p>Savvy SFDC users know that there's metadata, and then there's <em>metadata</em>. <code>DescribeFieldResults</code> belong to the latter case of metadata; the good stuff that's available through the <code>getDescribe</code> methods available on SObjects (to say nothing of the global Describe metadata, that's a whole 'nother can of worms ...).</p><p>You can access metadata about any Salesforce SObjectField through the following syntax:</p><pre class=""><code class="java code-0-0-14" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16 " data-content="//typically held in some kind of helper class"><span class="lineCounter-0-0-15 prim">1</span><span class="token comment">//typically held in some kind of helper class</span></div><br><div class="line-0-0-16 " data-content="//we'll use the example of Account.Industry"><span class="lineCounter-0-0-15">2</span><span class="token comment">//we'll use the example of Account.Industry</span></div><br><div class="line-0-0-16 " data-content="public static List<String> getPicklistValues(SObjectField field) {"><span class="lineCounter-0-0-15">3</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getPicklistValues</span><span class="token punctuation">(</span><span class="token class-name">SObjectField</span> field<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  Schema.DescribeFieldResult fieldMetadata = field.getDescribe();"><span class="lineCounter-0-0-15">4</span>  <span class="token class-name">Schema</span><span class="token punctuation">.</span><span class="token class-name">DescribeFieldResult</span> fieldMetadata <span class="token operator">=</span> field<span class="token punctuation">.</span><span class="token function">getDescribe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  List<Schema.PicklistEntry> picklistEntries = fieldMetadata.getPicklistValues();"><span class="lineCounter-0-0-15 prim">5</span>  <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Schema</span><span class="token punctuation">.</span><span class="token class-name">PicklistEntry</span><span class="token punctuation">&gt;</span></span> picklistEntries <span class="token operator">=</span> fieldMetadata<span class="token punctuation">.</span><span class="token function">getPicklistValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">6</span></div><br><div class="line-0-0-16 " data-content="  List<String> picklistValues = new List<String>();"><span class="lineCounter-0-0-15">7</span>  <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> picklistValues <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  for(Schema.PicklistEntry picklistEntry : picklistEntries) {"><span class="lineCounter-0-0-15">8</span>  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Schema</span><span class="token punctuation">.</span><span class="token class-name">PicklistEntry</span> picklistEntry <span class="token operator">:</span> picklistEntries<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    picklistValues.add(picklistEntry.getValue());"><span class="lineCounter-0-0-15">9</span>    picklistValues<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>picklistEntry<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  }"><span class="lineCounter-0-0-15 prim">10</span>  <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="  return picklistValues;"><span class="lineCounter-0-0-15">11</span>  <span class="token keyword">return</span> picklistValues<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="}"><span class="lineCounter-0-0-15">12</span><span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">13</span></div><br><div class="line-0-0-16 " data-content="Schema.SObjectField industry = Account.Industry;"><span class="lineCounter-0-0-15">14</span><span class="token class-name">Schema</span><span class="token punctuation">.</span><span class="token class-name">SObjectField</span> industry <span class="token operator">=</span> <span class="token class-name">Account</span><span class="token punctuation">.</span><span class="token class-name">Industry</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="List<String> industries = getPicklistvalues(industry);"><span class="lineCounter-0-0-15 prim">15</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> industries <span class="token operator">=</span> <span class="token function">getPicklistvalues</span><span class="token punctuation">(</span>industry<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="//prints out Agriculture, Apparel, Banking, Biotechnology, etc ..."><span class="lineCounter-0-0-15 prim">16</span><span class="token comment">//prints out Agriculture, Apparel, Banking, Biotechnology, etc ...</span></div><br></code></pre><p>That's all well and good; we can access the contents of a picklist. If this is news to anybody, definitely check out the Salesforce Developer documentation for <a href="https://developer.salesforce.com/docs/atlas.en-us.apexcode.meta/apexcode/apex_class_Schema_PicklistEntry.htm">PicklistEntry</a>. I'm not going to cover much of it, and there are a handful of other interesting methods on the object that gets returned. In general, the <code>Describe</code> level metadata returned for fields and objects is worth digging into in the Apex Developer guide -- you'd be surprised to find out how much you have access to at this level.</p><p>You know the story, though -- simply having access to the fields isn't really going to do much in the way of providing you with intellisense / safely providing you with values. Plus, what happens if we try to unsafely access values that aren't part of a picklist?</p><pre class=""><code class="java code-0-0-14" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16 " data-content="@isTest"><span class="lineCounter-0-0-15 prim">1</span><span class="token annotation punctuation">@isTest</span></div><br><div class="line-0-0-16 " data-content="static void it_should_validate_field_is_a_picklist() {"><span class="lineCounter-0-0-15">2</span><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">it_should_validate_field_is_a_picklist</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  Exception e;"><span class="lineCounter-0-0-15">3</span>  <span class="token class-name">Exception</span> e<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  try {"><span class="lineCounter-0-0-15">4</span>  <span class="token keyword">try</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    getPicklistValues(Opportunity.Name);"><span class="lineCounter-0-0-15 prim">5</span>    <span class="token function">getPicklistValues</span><span class="token punctuation">(</span><span class="token class-name">Opportunity</span><span class="token punctuation">.</span><span class="token class-name">Name</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  } catch(Exception ex) {"><span class="lineCounter-0-0-15">6</span>  <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    e = ex;"><span class="lineCounter-0-0-15">7</span>    e <span class="token operator">=</span> ex<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  }"><span class="lineCounter-0-0-15">8</span>  <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">9</span></div><br><div class="line-0-0-16 " data-content="  System.assertEquals(null, e);"><span class="lineCounter-0-0-15 prim">10</span>  <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="}"><span class="lineCounter-0-0-15 prim">11</span><span class="token punctuation">}</span></div><br></code></pre><p>Whew. The test passes. Of course, the question about whether or not it's valid for a helper method to return an empty list for a non-valid field is one for the ages -- you may find yourself wanting to throw an exception there. That's fine. For the purposes of this exercise, I leave the matter of exception handling up to you.</p><h2 id="object-oriented-picklists" class="heading-0-0-12"><span class="anchor-0-0-13" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Object-Oriented Picklists</h2><p>We know how to get picklist values, but what's the best way to encapsulate them per SObjectField? We have some behavior -- namely, the population of the picklist fields for a given SObjectField, that we'd like to have shared. This, my friends, screams: "abstract class"!</p><pre class=""><code class="java code-0-0-14" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16 " data-content="public abstract class Picklist {"><span class="lineCounter-0-0-15 prim">1</span><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Picklist</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  private final SObjectField field;"><span class="lineCounter-0-0-15">2</span>  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">SObjectField</span> field<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  protected final List<String> picklistValues;"><span class="lineCounter-0-0-15">3</span>  <span class="token keyword">protected</span> <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> picklistValues<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">4</span></div><br><div class="line-0-0-16 " data-content="  @testVisible"><span class="lineCounter-0-0-15 prim">5</span>  <span class="token annotation punctuation">@testVisible</span></div><br><div class="line-0-0-16 " data-content="  protected Picklist(SObjectField field) {"><span class="lineCounter-0-0-15">6</span>  <span class="token keyword">protected</span> <span class="token class-name">Picklist</span><span class="token punctuation">(</span><span class="token class-name">SObjectField</span> field<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="      this.field = field;"><span class="lineCounter-0-0-15">7</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>field <span class="token operator">=</span> field<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="      this.picklistValues = this.getPicklistValues(field);"><span class="lineCounter-0-0-15">8</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>picklistValues <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getPicklistValues</span><span class="token punctuation">(</span>field<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  }"><span class="lineCounter-0-0-15">9</span>  <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15 prim">10</span></div><br><div class="line-0-0-16 " data-content="  protected String validatePicklistValue(String value) {"><span class="lineCounter-0-0-15">11</span>  <span class="token keyword">protected</span> <span class="token class-name">String</span> <span class="token function">validatePicklistValue</span><span class="token punctuation">(</span><span class="token class-name">String</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    if(!picklistValues.contains(value)) {"><span class="lineCounter-0-0-15">12</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>picklistValues<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="      throw new PicklistException(value + ' is not a valid entry for ' + this.field.getDescribe().getName() + '!');"><span class="lineCounter-0-0-15">13</span>      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">PicklistException</span><span class="token punctuation">(</span>value <span class="token operator">+</span> <span class="token string">' is not a valid entry for '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>field<span class="token punctuation">.</span><span class="token function">getDescribe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    }"><span class="lineCounter-0-0-15">14</span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15 prim">15</span></div><br><div class="line-0-0-16 " data-content="    return value;"><span class="lineCounter-0-0-15">16</span>    <span class="token keyword">return</span> value<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  }"><span class="lineCounter-0-0-15">17</span>  <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">18</span></div><br><div class="line-0-0-16 " data-content="  private List<String> getPicklistValues(SObjectField field) {"><span class="lineCounter-0-0-15">19</span>  <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getPicklistValues</span><span class="token punctuation">(</span><span class="token class-name">SObjectField</span> field<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    Schema.DescribeFieldResult fieldMetadata = field.getDescribe();"><span class="lineCounter-0-0-15 prim">20</span>    <span class="token class-name">Schema</span><span class="token punctuation">.</span><span class="token class-name">DescribeFieldResult</span> fieldMetadata <span class="token operator">=</span> field<span class="token punctuation">.</span><span class="token function">getDescribe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    List<Schema.PicklistEntry> picklistEntries = fieldMetadata.getPicklistValues();"><span class="lineCounter-0-0-15">21</span>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Schema</span><span class="token punctuation">.</span><span class="token class-name">PicklistEntry</span><span class="token punctuation">&gt;</span></span> picklistEntries <span class="token operator">=</span> fieldMetadata<span class="token punctuation">.</span><span class="token function">getPicklistValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">22</span></div><br><div class="line-0-0-16 " data-content="    List<String> returnValues = new List<String>();"><span class="lineCounter-0-0-15">23</span>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> returnValues <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    for(Schema.PicklistEntry picklistEntry : picklistEntries) {"><span class="lineCounter-0-0-15">24</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Schema</span><span class="token punctuation">.</span><span class="token class-name">PicklistEntry</span> picklistEntry <span class="token operator">:</span> picklistEntries<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="      returnValues.add(picklistEntry.getValue());"><span class="lineCounter-0-0-15 prim">25</span>      returnValues<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>picklistEntry<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    }"><span class="lineCounter-0-0-15">26</span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="    return returnValues;"><span class="lineCounter-0-0-15">27</span>    <span class="token keyword">return</span> returnValues<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  }"><span class="lineCounter-0-0-15">28</span>  <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">29</span></div><br><div class="line-0-0-16 " data-content="  private class PicklistException extends Exception {}"><span class="lineCounter-0-0-15 prim">30</span>  <span class="token keyword">private</span> <span class="token keyword">class</span> <span class="token class-name">PicklistException</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="}"><span class="lineCounter-0-0-15 prim">31</span><span class="token punctuation">}</span></div><br></code></pre><p>And here's how you would implement and test that picklist validation is working:</p><pre class=""><code class="java code-0-0-14" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16 " data-content="public class AccountIndustry extends Picklist {"><span class="lineCounter-0-0-15 prim">1</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AccountIndustry</span> <span class="token keyword">extends</span> <span class="token class-name">Picklist</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  private AccountIndustry() {"><span class="lineCounter-0-0-15">2</span>  <span class="token keyword">private</span> <span class="token class-name">AccountIndustry</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    super(Account.Industry);"><span class="lineCounter-0-0-15">3</span>    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token class-name">Account</span><span class="token punctuation">.</span><span class="token class-name">Industry</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  }"><span class="lineCounter-0-0-15">4</span>  <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15 prim">5</span></div><br><div class="line-0-0-16 " data-content="  //use the singleton pattern"><span class="lineCounter-0-0-15">6</span>  <span class="token comment">//use the singleton pattern</span></div><br><div class="line-0-0-16 " data-content="  //for ease of property access"><span class="lineCounter-0-0-15">7</span>  <span class="token comment">//for ease of property access</span></div><br><div class="line-0-0-16 " data-content="  public static AccountIndustry Instance {"><span class="lineCounter-0-0-15">8</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">AccountIndustry</span> <span class="token class-name">Instance</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    get {"><span class="lineCounter-0-0-15">9</span>    get <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="      if(Instance == null) {"><span class="lineCounter-0-0-15 prim">10</span>      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">Instance</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="        Instance = new AccountIndustry();"><span class="lineCounter-0-0-15">11</span>        <span class="token class-name">Instance</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AccountIndustry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="      }"><span class="lineCounter-0-0-15">12</span>      <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="      return Instance;"><span class="lineCounter-0-0-15">13</span>      <span class="token keyword">return</span> <span class="token class-name">Instance</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    }"><span class="lineCounter-0-0-15">14</span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="    private set;"><span class="lineCounter-0-0-15 prim">15</span>    <span class="token keyword">private</span> set<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  }"><span class="lineCounter-0-0-15">16</span>  <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">17</span></div><br><div class="line-0-0-16 " data-content="  public String AGRICULTURE { get { return this.validatePicklistValue('Agriculture'); }}"><span class="lineCounter-0-0-15">18</span>  <span class="token keyword">public</span> <span class="token class-name">String</span> AGRICULTURE <span class="token punctuation">{</span> get <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">validatePicklistValue</span><span class="token punctuation">(</span><span class="token string">'Agriculture'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="  public String APPAREL { get { return this.validatePicklistValue('Apparel'); }}"><span class="lineCounter-0-0-15">19</span>  <span class="token keyword">public</span> <span class="token class-name">String</span> APPAREL <span class="token punctuation">{</span> get <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">validatePicklistValue</span><span class="token punctuation">(</span><span class="token string">'Apparel'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="  //etc ..."><span class="lineCounter-0-0-15 prim">20</span>  <span class="token comment">//etc ...</span></div><br><div class="line-0-0-16 " data-content="}"><span class="lineCounter-0-0-15">21</span><span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">22</span></div><br><div class="line-0-0-16 " data-content="@isTest"><span class="lineCounter-0-0-15">23</span><span class="token annotation punctuation">@isTest</span></div><br><div class="line-0-0-16 " data-content="private class AccountIndustryTests {"><span class="lineCounter-0-0-15">24</span><span class="token keyword">private</span> <span class="token keyword">class</span> <span class="token class-name">AccountIndustryTests</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  @isTest"><span class="lineCounter-0-0-15 prim">25</span>  <span class="token annotation punctuation">@isTest</span></div><br><div class="line-0-0-16 " data-content="  static void it_should_return_account_industries() {"><span class="lineCounter-0-0-15">26</span>  <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">it_should_return_account_industries</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    System.assertEquals('Agriculture', AccountIndustry.Instance.AGRICULTURE);"><span class="lineCounter-0-0-15">27</span>    <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token string">'Agriculture'</span><span class="token punctuation">,</span> <span class="token class-name">AccountIndustry</span><span class="token punctuation">.</span><span class="token class-name">Instance</span><span class="token punctuation">.</span>AGRICULTURE<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    System.assertEquals('Apparel', AccountIndustry.Instance.APPAREL);"><span class="lineCounter-0-0-15">28</span>    <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token string">'Apparel'</span><span class="token punctuation">,</span> <span class="token class-name">AccountIndustry</span><span class="token punctuation">.</span><span class="token class-name">Instance</span><span class="token punctuation">.</span>APPAREL<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  }"><span class="lineCounter-0-0-15">29</span>  <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="}"><span class="lineCounter-0-0-15 prim">30</span><span class="token punctuation">}</span></div><br></code></pre><p>I'm not <em>crazy</em> about the singleton pattern (which you may remember we already covered in the <a href="/joys-of-apex/idiomatic-salesforce-apex/">Idiomatic Apex</a> post), but this is one of the main use-cases I feel it is acceptable: for exposing public methods in a static-y way while still allowing for use of the <code>this</code> keyword (here, primarily important for encapsulating the <code>validatePicklistValue</code> method within the parent <code>Picklist</code> class).</p><p>So long as you're generating test-coverage by attempting to access the strings like <code>AGRICULTURE</code>, you can 100% avoid getting bitten by errors like <code>bad value for restricted picklist field</code>:</p><pre class=""><code class="java code-0-0-14" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16 " data-content="//back in AccountIndustry"><span class="lineCounter-0-0-15 prim">1</span><span class="token comment">//back in AccountIndustry</span></div><br><div class="line-0-0-16 " data-content="//let's misspell something on purpose to prove the point"><span class="lineCounter-0-0-15">2</span><span class="token comment">//let's misspell something on purpose to prove the point</span></div><br><div class="line-0-0-16 " data-content="public String AGRICULTURE { get { return this.validatePicklistValue('Agricolae'); }}"><span class="lineCounter-0-0-15">3</span><span class="token keyword">public</span> <span class="token class-name">String</span> AGRICULTURE <span class="token punctuation">{</span> get <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">validatePicklistValue</span><span class="token punctuation">(</span><span class="token string">'Agricolae'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">4</span></div><br><div class="line-0-0-16 " data-content="//and in the tests:"><span class="lineCounter-0-0-15 prim">5</span><span class="token comment">//and in the tests:</span></div><br><div class="line-0-0-16 " data-content="@isTest"><span class="lineCounter-0-0-15">6</span><span class="token annotation punctuation">@isTest</span></div><br><div class="line-0-0-16 " data-content="static void it_should_return_account_industries() {"><span class="lineCounter-0-0-15">7</span><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">it_should_return_account_industries</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  System.assertEquals('Agriculture', AccountIndustry.Instance.AGRICULTURE);"><span class="lineCounter-0-0-15">8</span>  <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token string">'Agriculture'</span><span class="token punctuation">,</span> <span class="token class-name">AccountIndustry</span><span class="token punctuation">.</span><span class="token class-name">Instance</span><span class="token punctuation">.</span>AGRICULTURE<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  System.assertEquals('Apparel', AccountIndustry.Instance.APPAREL);"><span class="lineCounter-0-0-15">9</span>  <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token string">'Apparel'</span><span class="token punctuation">,</span> <span class="token class-name">AccountIndustry</span><span class="token punctuation">.</span><span class="token class-name">Instance</span><span class="token punctuation">.</span>APPAREL<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="}"><span class="lineCounter-0-0-15 prim">10</span><span class="token punctuation">}</span></div><br></code></pre><p>This causes the test to fail:</p><pre class=""><code class="undefined code-0-0-14" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16 " data-content="Picklist.PicklistException: Agricolae is not a valid entry for Industry!"><span class="lineCounter-0-0-15 prim">1</span>Picklist.PicklistException: Agricolae is not a valid entry for Industry!</div><br></code></pre><h2 id="picklists-in-a-nutshell" class="heading-0-0-12"><span class="anchor-0-0-13" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Picklists In A Nutshell</h2><p>At the end of the day, I think it's safe to say that picklists don't get a lot of love within the Salesforce community. Admins are constantly asking how to restrict values by profile instead of by record type; developers are kept busy trying to ensure the correct picklist values are used.</p><p>What do you think of this pattern? Is it useful for you in your own work? I like being able to get intellisense <strong>and</strong> test-validation for my restricted picklist values ... on the other hand, I hate writing singleton property accessors, and have spent more hours than I'd care to admit trying to "solve" that problem through a variety of abstract class hacks ... none of which has borne any fruit. That's the nature of progression, though -- failure is a part of the process. As Teddy Roosevelt once said:</p><blockquote><p>It is hard to fail, but it is worse never to have tried to succeed.</p></blockquote><p>Thanks for joining me for another read within <a href="/joys-of-apex/">The Joys Of Apex</a> -- I hope that even if strongly-typing your picklists isn't something you're likely to do, that you enjoyed the read. Till next time!</p><div class="contentnav-0-0-7" data-no-search=""><a href="#enter-describefieldresults" class="h2" data-content-highlight="enter-describefieldresults">Enter DescribeFieldResults</a><a href="#object-oriented-picklists" class="h2" data-content-highlight="object-oriented-picklists">Object-Oriented Picklists</a><a href="#picklists-in-a-nutshell" class="h2" data-content-highlight="picklists-in-a-nutshell">Picklists In A Nutshell</a></div></div><div id="-codedoc-toc" class="toc-0-0-4"><div class="content-0-0-5"><p><a href="/joys-of-apex/">Home</a>
<a href="/joys-of-apex/apex-logging-service">Apex Logging Service</a>
<a href="/joys-of-apex/apex-object-oriented-basics">Apex Object-Oriented Basics</a>
<a href="/joys-of-apex/batchable-and-queueable-apex">Batchable And Queueable Apex</a>
<a href="/joys-of-apex/building-a-better-singleton">Building A Better Singleton</a>
<a href="/joys-of-apex/continuous-integration-with-sfdx">Continuous Integration With SFDX</a>
<a href="/joys-of-apex/dependency-injection-factory-pattern">Dependency Injection &amp; Factory Pattern</a>
<a href="/joys-of-apex/enum-apex-class-gotchas">Enum Apex Class Gotchas</a>
<a href="/joys-of-apex/extendable-apis">Extendable Apis</a>
<a href="/joys-of-apex/future-method-callout-callback">Future Methods, Callouts &amp; Callbacks</a>
<a href="/joys-of-apex/idiomatic-salesforce-apex">Idiomatic Salesforce Apex</a>
<a href="/joys-of-apex/intro">Introduction &amp; Testing Philosophy</a>
<a href="/joys-of-apex/lazy-iterators">Lazy Iterators</a>
<a href="/joys-of-apex/lightweight-trigger-handler">Lightweight Trigger Handler</a>
<a href="/joys-of-apex/lwc-composable-pagination">LWC Composable Pagination</a>
<a href="/joys-of-apex/mocking-dml">Mocking DML</a>
<a href="/joys-of-apex/react-versus-lightning-web-components">React Versus Lightning Web Components</a>
<a href="/joys-of-apex/repository-pattern">Repository Pattern</a>
<a href="/joys-of-apex/sorting-and-performance-in-apex">Sorting And Performance In Apex</a>
<a href="/joys-of-apex/test-driven-development-example">Test Driven Development Example</a>
<a href="/joys-of-apex/writing-performance-apex-tests">Writing Performant Apex Tests</a></p><p><br><br></p><p><a href="https://www.jamessimone.net/">Read more tech articles</a></p></div></div><div class="footer-0-0-3"><div class="left"><script id="XxDJXrXoOH">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("XxDJXrXoOH", "BWW0vHR4333HbDOiwZ67JA==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script></div><div class="main"><div class="inside"></div></div><div class="right"><script id="NPRDhwJOeE">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("NPRDhwJOeE", "6yEdMfRRlNsUBKSBOTazFg==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script></div></div><script id="zCtXsS_SAv">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("zCtXsS_SAv", "wh9V9isakhdwzlz9ZUjvyw==", {"namespace":"/joys-of-apex"});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script></body></html>