<!DOCTYPE html><html><head><title>Joys Of Apex | React Versus Lightning Web Components</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><meta name="robots" content="index,follow"><meta name="theme-color" content="#212121"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><link rel="shortcut icon" href="/joys-of-apex/favicon.ico"><link href="https://fonts.googleapis.com/css?family=Hind:400,700&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:300,400&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/icon?family=Material+Icons|Material+Icons+Outlined" rel="stylesheet"><style>
      body, input, button {
        font-family: 'Hind', sans-serif;
      }

      code, .hljs {
        font-family: 'Source Code Pro', 'Courier New', Courier, monospace;
      }

      .icon-font {
        font-family: 'Material Icons';
        font-weight: normal;
        font-style: normal;
        font-size: 24px;  /* Preferred icon size */
        display: inline-block;
        line-height: 1;
        text-transform: none;
        letter-spacing: normal;
        word-wrap: normal;
        white-space: nowrap;
        direction: ltr;
      
        /* Support for all WebKit browsers. */
        -webkit-font-smoothing: antialiased;
        /* Support for Safari and Chrome. */
        text-rendering: optimizeLegibility;
      
        /* Support for Firefox. */
        -moz-osx-font-smoothing: grayscale;
      
        /* Support for IE. */
        font-feature-settings: 'liga';
      }

      .icon-font.outline {
        font-family: 'Material Icons Outlined';
      }
    </style><link href="/joys-of-apex/styles/codedoc-styles.css" rel="stylesheet"><script async="" defer="" src="/joys-of-apex/bundle/codedoc-bundle.js"></script><meta property="og:image" content="./img/joys-of-apex-thumbnail.png"><script>window.githubConfig={"repo":"james-coding-blog","user":"jamessimone"}</script><style>.container{padding-top: 0 !important}</style><style>#-codedoc-toc { backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px) }</style><meta name="twitter:title" content="Joys Of Apex | React Versus Lightning Web Components"><meta property="og:type" content="article"><meta property="og:title" content="Joys Of Apex | React Versus Lightning Web Components"></head><body><header style="margin-left: 1rem">Read more at <a href="https://wwww.jamessimone.net">jamessimone.net</a>, or return to the <a href="/joys-of-apex/">homepage</a></header><div id="-codedoc-container" class="container"><script>window.source = {"base":"posts","path":"react-versus-lightning-web-components.md","namespace":"/joys-of-apex","title":{"base":"Joys Of Apex","connector":" | "}}</script><div class="hero-0-0-8" style="margin-bottom: -156px"><img src="/joys-of-apex/img/the-joys-of-apex.png" class="image-0-0-9" data-hero=""><span class="caption-0-0-10"></span></div><marker><br>
<br>
<br>
<br>
<br>

</marker><h1 class="h-0-0-11 "><span style="color: green; 
      text-shadow: none; 
      font-size: 48px"><p>React Versus Lightning Web Components</p></span></h1><script id="HNoOZWnDcm">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("HNoOZWnDcm", "kRzsgnV+B7EQTskbovy+YA==", {"src":"github","date":"2020-03-17T15:12:03.284Z"});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script><div hidden="" data-ignore-text="" data-meta-override-property="og:image"><p>./img/joys-of-apex-thumbnail.png</p></div><p>I'm in the midst of writing a "back to basics" <a href="/joys-of-apex/apex-object-oriented-basics">post on object-oriented programming</a>, which has been a popular request for some time now. I was de-railed while working on that post after observing some other people talking about <a href="https://developer.salesforce.com/docs/component-library/documentation/lwc">Lightning Web Components</a> (LWC), the new-ish Salesforce frontend framework that has rapidly been pushed out the door to faze out the badly-aging Aura framework upon which Salesforce Lightning was first designed. LWC itself is based upon the open-source <a href="https://developer.mozilla.org/en-US/docs/Web/Web_Components">Web Components</a> standard, care of the great people at Mozilla.</p><p>On the backend, I come from a .Net / Java background, which made diving into Apex fairly easy. On the frontend, I worked on some old Backbone / Handlebars / Angular codebases, prior to making the jump into developing websites with React. By the time LWC came out, React had already begun favoring the usage of function components over class-based components, but the similarities were certainly there between the two. In truth, LWC shares more similarities to Vue.js than it does to React, but according to the <a href="https://2019.stateofjs.com/front-end-frameworks/">2019 State Of JavaScript</a>, React is still the frontend framework leader in terms of market-share. Comparisons between LWC and React are inevitable as a result.</p><p>Doing a little cross-comparison between the two frameworks seems like a fun exercise; specifically, I'm curous to see if there are significant performance differences between LWC and React.</p><h2 id="testing-in-a-reacttypescript-component" class="heading-0-0-12"><span class="anchor-0-0-13" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Testing In A React/Typescript Component</h2><p>This sample comes from a Typescript/React codebase for a client who needed to display an FAQ section on their site. If you're not familiar with Typescript/React, don't worry! Take a skim through and see if you recognize anything (or simply scroll through). See if you facepalm, as I did after re-reading what I'd written:</p><pre class="with-bar"><code class="typescript code-0-0-14" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span>src/components/faq/faq.tsx</span></span><div class="line-0-0-16 " data-content="import React, { FC, Reducer, useReducer } from &quot;react&quot;;"><span class="lineCounter-0-0-15 prim">1</span><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token constant">FC</span><span class="token punctuation">,</span> Reducer<span class="token punctuation">,</span> useReducer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">2</span></div><br><div class="line-0-0-16 " data-content="type Action = {"><span class="lineCounter-0-0-15">3</span><span class="token keyword">type</span> Action <span class="token operator">=</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  type: string;"><span class="lineCounter-0-0-15">4</span>  <span class="token keyword">type</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="};"><span class="lineCounter-0-0-15 prim">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">6</span></div><br><div class="line-0-0-16 " data-content="type FAQ = {"><span class="lineCounter-0-0-15">7</span><span class="token keyword">type</span> <span class="token constant">FAQ</span> <span class="token operator">=</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  answer: string;"><span class="lineCounter-0-0-15">8</span>  answer<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  question: string;"><span class="lineCounter-0-0-15">9</span>  question<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="};"><span class="lineCounter-0-0-15 prim">10</span><span class="token punctuation">}</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">11</span></div><br><div class="line-0-0-16 " data-content="type FAQProps = {"><span class="lineCounter-0-0-15">12</span><span class="token keyword">type</span> FAQProps <span class="token operator">=</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  faq: FAQ[];"><span class="lineCounter-0-0-15">13</span>  faq<span class="token operator">:</span> <span class="token constant">FAQ</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="};"><span class="lineCounter-0-0-15">14</span><span class="token punctuation">}</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15 prim">15</span></div><br><div class="line-0-0-16 " data-content="type State = {"><span class="lineCounter-0-0-15">16</span><span class="token keyword">type</span> State <span class="token operator">=</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  [key in string]: boolean;"><span class="lineCounter-0-0-15">17</span>  <span class="token punctuation">[</span>key <span class="token keyword">in</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="};"><span class="lineCounter-0-0-15">18</span><span class="token punctuation">}</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">19</span></div><br><div class="line-0-0-16 " data-content="const getInitialState = (faq: FAQ[]) =>"><span class="lineCounter-0-0-15 prim">20</span><span class="token keyword">const</span> <span class="token function-variable function">getInitialState</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">faq<span class="token operator">:</span> <span class="token constant">FAQ</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span></div><br><div class="line-0-0-16 " data-content="  faq"><span class="lineCounter-0-0-15">21</span>  faq</div><br><div class="line-0-0-16 " data-content="    .map((frequentlyAsked) => ({"><span class="lineCounter-0-0-15">22</span>    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">frequentlyAsked</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="      name: frequentlyAsked.question,"><span class="lineCounter-0-0-15">23</span>      name<span class="token operator">:</span> frequentlyAsked<span class="token punctuation">.</span>question<span class="token punctuation">,</span></div><br><div class="line-0-0-16 " data-content="      isExpanded: false,"><span class="lineCounter-0-0-15">24</span>      isExpanded<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span></div><br><div class="line-0-0-16 " data-content="    }))"><span class="lineCounter-0-0-15 prim">25</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span></div><br><div class="line-0-0-16 " data-content="    .reduce("><span class="lineCounter-0-0-15">26</span>    <span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span></div><br><div class="line-0-0-16 " data-content="      (previousValue, currentValue) => {"><span class="lineCounter-0-0-15">27</span>      <span class="token punctuation">(</span><span class="token parameter">previousValue<span class="token punctuation">,</span> currentValue</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="        return {"><span class="lineCounter-0-0-15">28</span>        <span class="token keyword">return</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="          ...previousValue,"><span class="lineCounter-0-0-15">29</span>          <span class="token operator">...</span>previousValue<span class="token punctuation">,</span></div><br><div class="line-0-0-16 " data-content="          [currentValue.name]: currentValue.isExpanded,"><span class="lineCounter-0-0-15 prim">30</span>          <span class="token punctuation">[</span>currentValue<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token operator">:</span> currentValue<span class="token punctuation">.</span>isExpanded<span class="token punctuation">,</span></div><br><div class="line-0-0-16 " data-content="        };"><span class="lineCounter-0-0-15">31</span>        <span class="token punctuation">}</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="      },"><span class="lineCounter-0-0-15">32</span>      <span class="token punctuation">}</span><span class="token punctuation">,</span></div><br><div class="line-0-0-16 " data-content="      { base: false }"><span class="lineCounter-0-0-15">33</span>      <span class="token punctuation">{</span> base<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="    );"><span class="lineCounter-0-0-15">34</span>    <span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15 prim">35</span></div><br><div class="line-0-0-16 " data-content="const reducer: Reducer<State, Action> = ("><span class="lineCounter-0-0-15">36</span><span class="token keyword">const</span> reducer<span class="token operator">:</span> Reducer<span class="token operator">&lt;</span>State<span class="token punctuation">,</span> Action<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">(</span></div><br><div class="line-0-0-16 " data-content="  state: State,"><span class="lineCounter-0-0-15">37</span>  state<span class="token operator">:</span> State<span class="token punctuation">,</span></div><br><div class="line-0-0-16 " data-content="  action: Action"><span class="lineCounter-0-0-15">38</span>  action<span class="token operator">:</span> Action</div><br><div class="line-0-0-16 " data-content="): State => {"><span class="lineCounter-0-0-15">39</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token parameter">State</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  const isExpanded = !state[action.type];"><span class="lineCounter-0-0-15 prim">40</span>  <span class="token keyword">const</span> isExpanded <span class="token operator">=</span> <span class="token operator">!</span>state<span class="token punctuation">[</span>action<span class="token punctuation">.</span><span class="token keyword">type</span><span class="token punctuation">]</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  return { ...state, [action.type]: isExpanded };"><span class="lineCounter-0-0-15">41</span>  <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> <span class="token punctuation">[</span>action<span class="token punctuation">.</span><span class="token keyword">type</span><span class="token punctuation">]</span><span class="token operator">:</span> isExpanded <span class="token punctuation">}</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="};"><span class="lineCounter-0-0-15">42</span><span class="token punctuation">}</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">43</span></div><br><div class="line-0-0-16 " data-content="const HideableSpan = ({ isExpanded }) => {"><span class="lineCounter-0-0-15">44</span><span class="token keyword">const</span> <span class="token function-variable function">HideableSpan</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> isExpanded <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  const transformStyle = `rotate(${!!isExpanded ? 90 : 0}deg)`;"><span class="lineCounter-0-0-15 prim">45</span>  <span class="token keyword">const</span> transformStyle <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">rotate(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token operator">!</span><span class="token operator">!</span>isExpanded <span class="token operator">?</span> <span class="token number">90</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">deg)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  return ("><span class="lineCounter-0-0-15">46</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span></div><br><div class="line-0-0-16 " data-content="    <span"><span class="lineCounter-0-0-15">47</span>    <span class="token operator">&lt;</span>span</div><br><div class="line-0-0-16 " data-content="      style={{"><span class="lineCounter-0-0-15">48</span>      style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="        display: &quot;block&quot;,"><span class="lineCounter-0-0-15">49</span>        display<span class="token operator">:</span> <span class="token string">"block"</span><span class="token punctuation">,</span></div><br><div class="line-0-0-16 " data-content="        marginLeft: &quot;-15px&quot;,"><span class="lineCounter-0-0-15 prim">50</span>        marginLeft<span class="token operator">:</span> <span class="token string">"-15px"</span><span class="token punctuation">,</span></div><br><div class="line-0-0-16 " data-content="        position: &quot;absolute&quot;,"><span class="lineCounter-0-0-15">51</span>        position<span class="token operator">:</span> <span class="token string">"absolute"</span><span class="token punctuation">,</span></div><br><div class="line-0-0-16 " data-content="        top: 0,"><span class="lineCounter-0-0-15">52</span>        top<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></div><br><div class="line-0-0-16 " data-content="        transform: transformStyle,"><span class="lineCounter-0-0-15">53</span>        transform<span class="token operator">:</span> transformStyle<span class="token punctuation">,</span></div><br><div class="line-0-0-16 " data-content="        transition: `ease 0.3s`,"><span class="lineCounter-0-0-15">54</span>        transition<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">ease 0.3s</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span></div><br><div class="line-0-0-16 " data-content="      }}"><span class="lineCounter-0-0-15 prim">55</span>      <span class="token punctuation">}</span><span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="    >"><span class="lineCounter-0-0-15">56</span>    <span class="token operator">&gt;</span></div><br><div class="line-0-0-16 " data-content="      →"><span class="lineCounter-0-0-15">57</span>      →</div><br><div class="line-0-0-16 " data-content="    </span>"><span class="lineCounter-0-0-15">58</span>    <span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span></div><br><div class="line-0-0-16 " data-content="  );"><span class="lineCounter-0-0-15">59</span>  <span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="};"><span class="lineCounter-0-0-15 prim">60</span><span class="token punctuation">}</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">61</span></div><br><div class="line-0-0-16 " data-content="export const FAQ: FC<FAQProps> = ({ faq }) => {"><span class="lineCounter-0-0-15">62</span><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">FAQ</span><span class="token operator">:</span> <span class="token constant">FC</span><span class="token operator">&lt;</span>FAQProps<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> faq <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  const initialState = getInitialState(faq);"><span class="lineCounter-0-0-15">63</span>  <span class="token keyword">const</span> initialState <span class="token operator">=</span> <span class="token function">getInitialState</span><span class="token punctuation">(</span>faq<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  const [state, dispatch] = useReducer(reducer, initialState);"><span class="lineCounter-0-0-15">64</span>  <span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> dispatch<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useReducer</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> initialState<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15 prim">65</span></div><br><div class="line-0-0-16 " data-content="  return ("><span class="lineCounter-0-0-15">66</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span></div><br><div class="line-0-0-16 " data-content="    <section>"><span class="lineCounter-0-0-15">67</span>    <span class="token operator">&lt;</span>section<span class="token operator">&gt;</span></div><br><div class="line-0-0-16 " data-content="      <h1>FAQ</h1>"><span class="lineCounter-0-0-15">68</span>      <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span><span class="token constant">FAQ</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span></div><br><div class="line-0-0-16 " data-content="      {faq.map((frequentlyAsked) => ("><span class="lineCounter-0-0-15">69</span>      <span class="token punctuation">{</span>faq<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">frequentlyAsked</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span></div><br><div class="line-0-0-16 " data-content="        //style omitted for brevity"><span class="lineCounter-0-0-15 prim">70</span>        <span class="token comment">//style omitted for brevity</span></div><br><div class="line-0-0-16 " data-content="        <div"><span class="lineCounter-0-0-15">71</span>        <span class="token operator">&lt;</span>div</div><br><div class="line-0-0-16 " data-content="          key={frequentlyAsked.question}"><span class="lineCounter-0-0-15">72</span>          key<span class="token operator">=</span><span class="token punctuation">{</span>frequentlyAsked<span class="token punctuation">.</span>question<span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="          onClick={() =>"><span class="lineCounter-0-0-15">73</span>          onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span></div><br><div class="line-0-0-16 " data-content="            dispatch({"><span class="lineCounter-0-0-15">74</span>            <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="              type: frequentlyAsked.question,"><span class="lineCounter-0-0-15 prim">75</span>              <span class="token keyword">type</span><span class="token operator">:</span> frequentlyAsked<span class="token punctuation">.</span>question<span class="token punctuation">,</span></div><br><div class="line-0-0-16 " data-content="            })"><span class="lineCounter-0-0-15">76</span>            <span class="token punctuation">}</span><span class="token punctuation">)</span></div><br><div class="line-0-0-16 " data-content="          }"><span class="lineCounter-0-0-15">77</span>          <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="        >"><span class="lineCounter-0-0-15">78</span>        <span class="token operator">&gt;</span></div><br><div class="line-0-0-16 " data-content="          <h2>"><span class="lineCounter-0-0-15">79</span>          <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span></div><br><div class="line-0-0-16 " data-content="            {frequentlyAsked.question}"><span class="lineCounter-0-0-15 prim">80</span>            <span class="token punctuation">{</span>frequentlyAsked<span class="token punctuation">.</span>question<span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="            <HideableSpan isExpanded={state[frequentlyAsked.question]} />"><span class="lineCounter-0-0-15">81</span>            <span class="token operator">&lt;</span>HideableSpan isExpanded<span class="token operator">=</span><span class="token punctuation">{</span>state<span class="token punctuation">[</span>frequentlyAsked<span class="token punctuation">.</span>question<span class="token punctuation">]</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span></div><br><div class="line-0-0-16 " data-content="          </h2>"><span class="lineCounter-0-0-15">82</span>          <span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span></div><br><div class="line-0-0-16 " data-content="          //styling not displayed for brevity //but similar to the HideableSpan"><span class="lineCounter-0-0-15">83</span>          <span class="token comment">//styling not displayed for brevity //but similar to the HideableSpan</span></div><br><div class="line-0-0-16 " data-content="          <small isExpanded={state[frequentlyAsked.question]}>"><span class="lineCounter-0-0-15">84</span>          <span class="token operator">&lt;</span>small isExpanded<span class="token operator">=</span><span class="token punctuation">{</span>state<span class="token punctuation">[</span>frequentlyAsked<span class="token punctuation">.</span>question<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token operator">&gt;</span></div><br><div class="line-0-0-16 " data-content="            {frequentlyAsked.answer}"><span class="lineCounter-0-0-15 prim">85</span>            <span class="token punctuation">{</span>frequentlyAsked<span class="token punctuation">.</span>answer<span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="          </small>"><span class="lineCounter-0-0-15">86</span>          <span class="token operator">&lt;</span><span class="token operator">/</span>small<span class="token operator">&gt;</span></div><br><div class="line-0-0-16 " data-content="        </div>"><span class="lineCounter-0-0-15">87</span>        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></div><br><div class="line-0-0-16 " data-content="      ))}"><span class="lineCounter-0-0-15">88</span>      <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="    </section>"><span class="lineCounter-0-0-15">89</span>    <span class="token operator">&lt;</span><span class="token operator">/</span>section<span class="token operator">&gt;</span></div><br><div class="line-0-0-16 " data-content="  );"><span class="lineCounter-0-0-15 prim">90</span>  <span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="};"><span class="lineCounter-0-0-15 prim">91</span><span class="token punctuation">}</span><span class="token punctuation">;</span></div><br></code></pre><p>This is a pretty minimal component that takes in a list of frequently asked questions and makes use of the lazily-loaded <code>useReducer</code> pattern for creating initial state, where all of the questions are mapped to a state object with the question used as a key and a boolean representing their expanded value. Clicking on the question shows the answer -- clicking again re-hides the answer. Fairly standard stuff for React. Probably the only notable thing about this example is the use of <code>useReducer</code> in general, because the <em>simplest</em> possible solution in React would be to <code>useState</code> ... except that here, that would already be pretty complicated, because we don't know how many questions are going to be loaded into this component to begin with.</p><p>Even though this is a relatively simple piece of code, it's also a mess. Most of the mess is contained within <code>getInitialState()</code>, which is essentially flattening the list of frequently asked questions into an object, as described. Why is it a mess? It's hard to follow, particularly the call to the native JS function <code>reduce</code>. It compiles and it works, but it's also totally inscrutable, particularly if anybody other than me should ever work on this codebase. What the hell is that <code>{ base: false }</code> section even doing, for example?</p><p>Let's look at how that <code>getInitialState</code> function might be suitably ... reduced to something more understandable:</p><pre class="with-bar"><code class="typescript code-0-0-14" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span>src/components/faq/faq.tsx</span></span><div class="line-0-0-16 " data-content="const getInitialState = (faq: FAQ[]) =>"><span class="lineCounter-0-0-15 prim">1</span><span class="token keyword">const</span> <span class="token function-variable function">getInitialState</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">faq<span class="token operator">:</span> <span class="token constant">FAQ</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span></div><br><div class="line-0-0-16 " data-content="  faq"><span class="lineCounter-0-0-15">2</span>  faq</div><br><div class="line-0-0-16 " data-content="    .map((frequentlyAsked) => ({"><span class="lineCounter-0-0-15">3</span>    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">frequentlyAsked</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="      [frequentlyAsked.question]: false,"><span class="lineCounter-0-0-15">4</span>      <span class="token punctuation">[</span>frequentlyAsked<span class="token punctuation">.</span>question<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span></div><br><div class="line-0-0-16 " data-content="    }))"><span class="lineCounter-0-0-15 prim">5</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span></div><br><div class="line-0-0-16 " data-content="    .reduce((previousValue, currentValue) => ({"><span class="lineCounter-0-0-15">6</span>    <span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">previousValue<span class="token punctuation">,</span> currentValue</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="      ...previousValue,"><span class="lineCounter-0-0-15">7</span>      <span class="token operator">...</span>previousValue<span class="token punctuation">,</span></div><br><div class="line-0-0-16 " data-content="      ...currentValue,"><span class="lineCounter-0-0-15">8</span>      <span class="token operator">...</span>currentValue<span class="token punctuation">,</span></div><br><div class="line-0-0-16 " data-content="    }));"><span class="lineCounter-0-0-15 prim">9</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br></code></pre><p>Now we're starting to get somewhere. Most people would probably take this as an acceptable solution and move on. But, to quote Mr. Money Mustache on the subject of coffee ... <a href="https://www.mrmoneymustache.com/2011/09/06/how-much-is-that-bitch-costin-ya/">"how much is that bitch costing ya?"</a>. People love love <em>love</em> to use <code>.map</code> and <code>.forEach</code> and <code>reduce</code> in JS, without regards to performance -- and, if this component were to be frequently re-rendered with a suitably large list of questions, iterating twice over the list of FAQs could indeed become a performance bottleneck (not to mention mapping over the values once more in the actual render method of the component). It's something that should at least be measured, so let's create an even faster FAQ component and use Jest + Enzyme to measure the costs of both components updating:</p><pre class="with-bar"><code class="typescript code-0-0-14" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span>src/components/faq/faq.tsx</span></span><div class="line-0-0-16 " data-content="export type FAQItem = {"><span class="lineCounter-0-0-15 prim">1</span><span class="token keyword">export</span> <span class="token keyword">type</span> FAQItem <span class="token operator">=</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  answer: string;"><span class="lineCounter-0-0-15">2</span>  answer<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  question: string;"><span class="lineCounter-0-0-15">3</span>  question<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="};"><span class="lineCounter-0-0-15">4</span><span class="token punctuation">}</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15 prim">5</span></div><br><div class="line-0-0-16 " data-content="type FAQProps = {"><span class="lineCounter-0-0-15">6</span><span class="token keyword">type</span> FAQProps <span class="token operator">=</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  faq: FAQItem[];"><span class="lineCounter-0-0-15">7</span>  faq<span class="token operator">:</span> FAQItem<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  getInitialState?: (faq: FAQItem[]) => State;"><span class="lineCounter-0-0-15">8</span>  getInitialState<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">faq<span class="token operator">:</span> FAQItem<span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> State<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="};"><span class="lineCounter-0-0-15">9</span><span class="token punctuation">}</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15 prim">10</span></div><br><div class="line-0-0-16 " data-content="//...."><span class="lineCounter-0-0-15">11</span><span class="token comment">//....</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">12</span></div><br><div class="line-0-0-16 " data-content="export const FAQ: FC<FAQProps> = ({ faq, getInitialState }) => {"><span class="lineCounter-0-0-15">13</span><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">FAQ</span><span class="token operator">:</span> <span class="token constant">FC</span><span class="token operator">&lt;</span>FAQProps<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> faq<span class="token punctuation">,</span> getInitialState <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  const initialState = !!getInitialState"><span class="lineCounter-0-0-15">14</span>  <span class="token keyword">const</span> initialState <span class="token operator">=</span> <span class="token operator">!</span><span class="token operator">!</span>getInitialState</div><br><div class="line-0-0-16 " data-content="    ? getInitialState(faq)"><span class="lineCounter-0-0-15 prim">15</span>    <span class="token operator">?</span> <span class="token function">getInitialState</span><span class="token punctuation">(</span>faq<span class="token punctuation">)</span></div><br><div class="line-0-0-16 " data-content="    : getInitialStateDefault(faq);"><span class="lineCounter-0-0-15">16</span>    <span class="token operator">:</span> <span class="token function">getInitialStateDefault</span><span class="token punctuation">(</span>faq<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  //.."><span class="lineCounter-0-0-15">17</span>  <span class="token comment">//..</span></div><br><div class="line-0-0-16 " data-content="};"><span class="lineCounter-0-0-15 prim">18</span><span class="token punctuation">}</span><span class="token punctuation">;</span></div><br></code></pre><p>You could get much crazier than that, and I considered it, but sometimes simple is best. Let's look at how these tests shape up:</p><pre class="with-bar"><code class="typescript code-0-0-14" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span>src/components/faq/__tests__/faq.test.js</span></span><div class="line-0-0-16 " data-content="import { mount } from &quot;enzyme&quot;;"><span class="lineCounter-0-0-15 prim">1</span><span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"enzyme"</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="import React from &quot;react&quot;;"><span class="lineCounter-0-0-15">2</span><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">3</span></div><br><div class="line-0-0-16 " data-content="import { FAQ } from &quot;../faq&quot;;"><span class="lineCounter-0-0-15">4</span><span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">FAQ</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"../faq"</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="import { FastFAQ } from &quot;../fast-faq&quot;;"><span class="lineCounter-0-0-15 prim">5</span><span class="token keyword">import</span> <span class="token punctuation">{</span> FastFAQ <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"../fast-faq"</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">6</span></div><br><div class="line-0-0-16 " data-content="const getList = () => {"><span class="lineCounter-0-0-15">7</span><span class="token keyword">const</span> <span class="token function-variable function">getList</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  const list = [];"><span class="lineCounter-0-0-15">8</span>  <span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  for (let index = 0; index < 1000; index++) {"><span class="lineCounter-0-0-15">9</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    list.push({ question: index, answer: &quot;some answer&quot; });"><span class="lineCounter-0-0-15 prim">10</span>    list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> question<span class="token operator">:</span> index<span class="token punctuation">,</span> answer<span class="token operator">:</span> <span class="token string">"some answer"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  }"><span class="lineCounter-0-0-15">11</span>  <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="  return list;"><span class="lineCounter-0-0-15">12</span>  <span class="token keyword">return</span> list<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="};"><span class="lineCounter-0-0-15">13</span><span class="token punctuation">}</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">14</span></div><br><div class="line-0-0-16 " data-content="const bigOldList = getList();"><span class="lineCounter-0-0-15 prim">15</span><span class="token keyword">const</span> bigOldList <span class="token operator">=</span> <span class="token function">getList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">16</span></div><br><div class="line-0-0-16 " data-content="const fastInitialState = (args: FAQItem[]) => {"><span class="lineCounter-0-0-15">17</span><span class="token keyword">const</span> <span class="token function-variable function">fastInitialState</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">args<span class="token operator">:</span> FAQItem<span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  const initialState = {};"><span class="lineCounter-0-0-15">18</span>  <span class="token keyword">const</span> initialState <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  for (let index = 0; index < args.length; index++) {"><span class="lineCounter-0-0-15">19</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> args<span class="token punctuation">.</span>length<span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    const frequentlyAsked = args[index];"><span class="lineCounter-0-0-15 prim">20</span>    <span class="token keyword">const</span> frequentlyAsked <span class="token operator">=</span> args<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    initialState[frequentlyAsked.question] = false;"><span class="lineCounter-0-0-15">21</span>    initialState<span class="token punctuation">[</span>frequentlyAsked<span class="token punctuation">.</span>question<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  }"><span class="lineCounter-0-0-15">22</span>  <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="  return initialState;"><span class="lineCounter-0-0-15">23</span>  <span class="token keyword">return</span> initialState<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="};"><span class="lineCounter-0-0-15">24</span><span class="token punctuation">}</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15 prim">25</span></div><br><div class="line-0-0-16 " data-content="describe(&quot;FAQ Performance&quot;, () => {"><span class="lineCounter-0-0-15">26</span><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">"FAQ Performance"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  it(&quot;should render faq&quot;, () => {"><span class="lineCounter-0-0-15">27</span>  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">"should render faq"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    const wrapper = mount(<FAQ faq={bigOldList} />);"><span class="lineCounter-0-0-15">28</span>    <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token constant">FAQ</span> faq<span class="token operator">=</span><span class="token punctuation">{</span>bigOldList<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    wrapper.update();"><span class="lineCounter-0-0-15">29</span>    wrapper<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  });"><span class="lineCounter-0-0-15 prim">30</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  it(&quot;should render fast-faq&quot;, () => {"><span class="lineCounter-0-0-15">31</span>  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">"should render fast-faq"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    const wrapper = mount("><span class="lineCounter-0-0-15">32</span>    <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span></div><br><div class="line-0-0-16 " data-content="      <FAQ faq={bigOldList} getInitialState={fastInitialState} />"><span class="lineCounter-0-0-15">33</span>      <span class="token operator">&lt;</span><span class="token constant">FAQ</span> faq<span class="token operator">=</span><span class="token punctuation">{</span>bigOldList<span class="token punctuation">}</span> getInitialState<span class="token operator">=</span><span class="token punctuation">{</span>fastInitialState<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span></div><br><div class="line-0-0-16 " data-content="    );"><span class="lineCounter-0-0-15">34</span>    <span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    wrapper.update();"><span class="lineCounter-0-0-15 prim">35</span>    wrapper<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  });"><span class="lineCounter-0-0-15">36</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="});"><span class="lineCounter-0-0-15 prim">37</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br></code></pre><p>And the results?</p><pre class=""><code class="bash code-0-0-14" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16 " data-content="  FAQ Performance"><span class="lineCounter-0-0-15 prim">1</span>  FAQ Performance</div><br><div class="line-0-0-16 " data-content="    √ should render faq (200ms)"><span class="lineCounter-0-0-15">2</span>    √ should render faq <span class="token punctuation">(</span>200ms<span class="token punctuation">)</span></div><br><div class="line-0-0-16 " data-content="    √ should render fast-faq (145ms)"><span class="lineCounter-0-0-15">3</span>    √ should render fast-faq <span class="token punctuation">(</span>145ms<span class="token punctuation">)</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">4</span></div><br><div class="line-0-0-16 " data-content="Test Suites: 1 passed, 1 total"><span class="lineCounter-0-0-15 prim">5</span>Test Suites: <span class="token number">1</span> passed, <span class="token number">1</span> total</div><br><div class="line-0-0-16 " data-content="Tests:       2 passed, 2 total"><span class="lineCounter-0-0-15 prim">6</span>Tests:       <span class="token number">2</span> passed, <span class="token number">2</span> total</div><br></code></pre><p>Not too shabby. Even when the list of questions was "only" 100 questions long (and keeping in mind the fact that longer answers would almost certainly negatively impact re-rendering performance), the difference between re-renders was consistently at least 50ms. UX research has suggested that as <em>little</em> as 50ms in delay can negatively affect users, both in terms of conversion and (for internal portals) assignment completion.</p><p>In short, small delays in rendering/re-loading pages quickly add up; as developers, it shouldn't only be our mandate to make things work, but to make things work <em>well</em>. Knowing about relative performance, particularly when branching out into LWC development -- where the JavaScript you write is going to have to be processed client-side for your users -- is not only important for you as the programmer when you need to return to code, but because most users operate on substandard hardware that chug on huge quantities of JS and CSS.</p><hr><p>One thing that's really pleasant, as a developer, when working with the above code, is how testable the implementation is. You can easily, for example, test that the implementation of <code>getInitialState</code> in FAQ creates state predictably, with a minimum of fuss -- all you need to do is pass in a list of objects with <code>question</code> and <code>answer</code> properties to validate that things are working as anticipated. Furthermore, thanks to the power of Jest + Enzyme (not to mention the whole host of other React testing libraries out there), we can actually examine the internals of the rendered component to validate that, when a particular question is clicked, the <code>HideableSpan</code> component actually rotates the arrow, and the text of the answer is exposed.</p><p>At a high level, this is precisely why React has gained the prominence it now has within the frontend community -- by splitting the traditional <a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller">MVC</a> architecture into discrete, testable presentation pieces, React encourages code re-use and abstraction at a similar level to the foundations of object-oriented programming represented by a language like Apex.</p><h2 id="testing-in-a-lightning-web-component" class="heading-0-0-12"><span class="anchor-0-0-13" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Testing In A Lightning Web Component</h2><p>Let's make the jump and look at this same problem, this time within a LWC.</p><p>There are many, <em>many</em> ways to skin this particular cat, highlighting both the strengths and weaknesses of LWC in a nutshell. In order to ingest the FAQ question/answer pairs, for example, you could use <code>@wire</code> to fetch data from a custom object using an Apex controller. You could use <code>@api</code> and getter/setter methods to control the <code>isExpanded</code> property that we need to track in order to expand/contract the FAQ question to show the answer.</p><p>Here's the <em>most</em> basic implementation for the LWC:</p><pre class="with-bar"><code class="javascript code-0-0-14" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span>lwc/faq/faq.js</span></span><div class="line-0-0-16 " data-content="import { LightningElement, wire } from &quot;lwc&quot;;"><span class="lineCounter-0-0-15 prim">1</span><span class="token keyword">import</span> <span class="token punctuation">{</span> LightningElement<span class="token punctuation">,</span> wire <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"lwc"</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="import getFAQs from &quot;@salesforce/apex/FAQController.getFAQs&quot;;"><span class="lineCounter-0-0-15">2</span><span class="token keyword">import</span> getFAQs <span class="token keyword">from</span> <span class="token string">"@salesforce/apex/FAQController.getFAQs"</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">3</span></div><br><div class="line-0-0-16 " data-content="export default class FAQList extends LightningElement {"><span class="lineCounter-0-0-15">4</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">FAQList</span> <span class="token keyword">extends</span> <span class="token class-name">LightningElement</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  @wire(getFAQs) faqs;"><span class="lineCounter-0-0-15 prim">5</span>  @<span class="token function">wire</span><span class="token punctuation">(</span>getFAQs<span class="token punctuation">)</span> faqs<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  activeSections = [];"><span class="lineCounter-0-0-15">6</span>  activeSections <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="}"><span class="lineCounter-0-0-15 prim">7</span><span class="token punctuation">}</span></div><br></code></pre><p>And the Apex controller:</p><pre class="with-bar"><code class="java code-0-0-14" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span>classes/FAQController.cls</span></span><div class="line-0-0-16 " data-content="public class FAQController {"><span class="lineCounter-0-0-15 prim">1</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FAQController</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  @AuraEnabled(cacheable=true)"><span class="lineCounter-0-0-15">2</span>  <span class="token annotation punctuation">@AuraEnabled</span><span class="token punctuation">(</span>cacheable<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">)</span></div><br><div class="line-0-0-16 " data-content="  public static List<FAQ> getFAQs() {"><span class="lineCounter-0-0-15">3</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span>FAQ<span class="token punctuation">&gt;</span></span> <span class="token function">getFAQs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    List<FAQ> faqs = new List<FAQ>();"><span class="lineCounter-0-0-15">4</span>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span>FAQ<span class="token punctuation">&gt;</span></span> faqs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span>FAQ<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    for(Integer index = 0; index < 100; index++) {"><span class="lineCounter-0-0-15 prim">5</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="        String indexString = String.valueOf(index);"><span class="lineCounter-0-0-15">6</span>        <span class="token class-name">String</span> indexString <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="        faqs.add(new FAQ('Question for ' + indexString, 'Answer for' + indexString, indexString));"><span class="lineCounter-0-0-15">7</span>        faqs<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">FAQ</span><span class="token punctuation">(</span><span class="token string">'Question for '</span> <span class="token operator">+</span> indexString<span class="token punctuation">,</span> <span class="token string">'Answer for'</span> <span class="token operator">+</span> indexString<span class="token punctuation">,</span> indexString<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    }"><span class="lineCounter-0-0-15">8</span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="    return faqs;"><span class="lineCounter-0-0-15">9</span>    <span class="token keyword">return</span> faqs<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  }"><span class="lineCounter-0-0-15 prim">10</span>  <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">11</span></div><br><div class="line-0-0-16 " data-content="  public class FAQ {"><span class="lineCounter-0-0-15">12</span>  <span class="token keyword">public</span> <span class="token keyword">class</span> FAQ <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    public FAQ(String question, String answer, String key) {"><span class="lineCounter-0-0-15">13</span>    <span class="token keyword">public</span> <span class="token function">FAQ</span><span class="token punctuation">(</span><span class="token class-name">String</span> question<span class="token punctuation">,</span> <span class="token class-name">String</span> answer<span class="token punctuation">,</span> <span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="        this.question = question;"><span class="lineCounter-0-0-15">14</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>question <span class="token operator">=</span> question<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="        this.answer = answer;"><span class="lineCounter-0-0-15 prim">15</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>answer <span class="token operator">=</span> answer<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="        this.key = key;"><span class="lineCounter-0-0-15">16</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>key <span class="token operator">=</span> key<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    }"><span class="lineCounter-0-0-15">17</span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="    public String question { get; private set; }"><span class="lineCounter-0-0-15">18</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> question <span class="token punctuation">{</span> get<span class="token punctuation">;</span> <span class="token keyword">private</span> set<span class="token punctuation">;</span> <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="    public String answer { get; private set; }"><span class="lineCounter-0-0-15">19</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> answer <span class="token punctuation">{</span> get<span class="token punctuation">;</span> <span class="token keyword">private</span> set<span class="token punctuation">;</span> <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="    public String key { get; private set; }"><span class="lineCounter-0-0-15 prim">20</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> key <span class="token punctuation">{</span> get<span class="token punctuation">;</span> <span class="token keyword">private</span> set<span class="token punctuation">;</span> <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="  }"><span class="lineCounter-0-0-15">21</span>  <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="}"><span class="lineCounter-0-0-15 prim">22</span><span class="token punctuation">}</span></div><br></code></pre><p>And the LWC markup:</p><pre class="with-bar"><code class="html code-0-0-14" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span>lwc/faq/faq.html</span></span><div class="line-0-0-16 " data-content="<template>"><span class="lineCounter-0-0-15 prim">1</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span></div><br><div class="line-0-0-16 " data-content="  <template if:true=&quot;{faqs.data}&quot;>"><span class="lineCounter-0-0-15">2</span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name"><span class="token namespace">if:</span>true</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{faqs.data}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span></div><br><div class="line-0-0-16 " data-content="    <template for:each=&quot;{faqs.data}&quot; for:item=&quot;faq&quot;>"><span class="lineCounter-0-0-15">3</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name"><span class="token namespace">for:</span>each</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{faqs.data}<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">for:</span>item</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>faq<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span></div><br><div class="line-0-0-16 " data-content="      <lightning-accordion"><span class="lineCounter-0-0-15">4</span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>lightning-accordion</span></span></div><br><div class="line-0-0-16 " data-content="        allow-multiple-sections-open"><span class="lineCounter-0-0-15 prim">5</span>        <span class="token attr-name">allow-multiple-sections-open</span></div><br><div class="line-0-0-16 " data-content="        key=&quot;{faq.key}&quot;"><span class="lineCounter-0-0-15">6</span>        <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{faq.key}<span class="token punctuation">"</span></span></div><br><div class="line-0-0-16 " data-content="        active-section-name=&quot;{activeSections}&quot;"><span class="lineCounter-0-0-15">7</span>        <span class="token attr-name">active-section-name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{activeSections}<span class="token punctuation">"</span></span></div><br><div class="line-0-0-16 " data-content="      >"><span class="lineCounter-0-0-15">8</span>      <span class="token punctuation">&gt;</span></div><br><div class="line-0-0-16 " data-content="        <lightning-accordion-section name=&quot;{faq.key}&quot; label=&quot;{faq.question}&quot;>"><span class="lineCounter-0-0-15">9</span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>lightning-accordion-section</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{faq.key}<span class="token punctuation">"</span></span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{faq.question}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span></div><br><div class="line-0-0-16 " data-content="          <small>{faq.answer}</small>"><span class="lineCounter-0-0-15 prim">10</span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>small</span><span class="token punctuation">&gt;</span></span>{faq.answer}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>small</span><span class="token punctuation">&gt;</span></span></div><br><div class="line-0-0-16 " data-content="        </lightning-accordion-section>"><span class="lineCounter-0-0-15">11</span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>lightning-accordion-section</span><span class="token punctuation">&gt;</span></span></div><br><div class="line-0-0-16 " data-content="      </lightning-accordion>"><span class="lineCounter-0-0-15">12</span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>lightning-accordion</span><span class="token punctuation">&gt;</span></span></div><br><div class="line-0-0-16 " data-content="    </template>"><span class="lineCounter-0-0-15">13</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span></div><br><div class="line-0-0-16 " data-content="  </template>"><span class="lineCounter-0-0-15">14</span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span></div><br><div class="line-0-0-16 " data-content="</template>"><span class="lineCounter-0-0-15 prim">15</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span></div><br></code></pre><p>And the tests:</p><pre class="with-bar"><code class="javascript code-0-0-14" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span>lwc/faq/__tests__/faq.test.js</span></span><div class="line-0-0-16 " data-content="import { createElement } from &quot;lwc&quot;;"><span class="lineCounter-0-0-15 prim">1</span><span class="token keyword">import</span> <span class="token punctuation">{</span> createElement <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"lwc"</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="import { registerApexTestWireAdapter } from &quot;@salesforce/sfdx-lwc-jest&quot;;"><span class="lineCounter-0-0-15">2</span><span class="token keyword">import</span> <span class="token punctuation">{</span> registerApexTestWireAdapter <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@salesforce/sfdx-lwc-jest"</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">3</span></div><br><div class="line-0-0-16 " data-content="import FAQ from &quot;c/faq&quot;;"><span class="lineCounter-0-0-15">4</span><span class="token keyword">import</span> <span class="token constant">FAQ</span> <span class="token keyword">from</span> <span class="token string">"c/faq"</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="import getFAQs from &quot;@salesforce/apex/FAQController.getFAQs&quot;;"><span class="lineCounter-0-0-15 prim">5</span><span class="token keyword">import</span> getFAQs <span class="token keyword">from</span> <span class="token string">"@salesforce/apex/FAQController.getFAQs"</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">6</span></div><br><div class="line-0-0-16 " data-content="const FAQ_AMOUNT = 1000;"><span class="lineCounter-0-0-15">7</span><span class="token keyword">const</span> <span class="token constant">FAQ_AMOUNT</span> <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">8</span></div><br><div class="line-0-0-16 " data-content="const getFakeFAQs = () => {"><span class="lineCounter-0-0-15">9</span><span class="token keyword">const</span> <span class="token function-variable function">getFakeFAQs</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  const faqs = [];"><span class="lineCounter-0-0-15 prim">10</span>  <span class="token keyword">const</span> faqs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  for (let index = 0; index < FAQ_AMOUNT; index++) {"><span class="lineCounter-0-0-15">11</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> <span class="token constant">FAQ_AMOUNT</span><span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    faqs.push({"><span class="lineCounter-0-0-15">12</span>    faqs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="      question: &quot;test question&quot; + index,"><span class="lineCounter-0-0-15">13</span>      question<span class="token operator">:</span> <span class="token string">"test question"</span> <span class="token operator">+</span> index<span class="token punctuation">,</span></div><br><div class="line-0-0-16 " data-content="      answer: &quot;test answer &quot; + index,"><span class="lineCounter-0-0-15">14</span>      answer<span class="token operator">:</span> <span class="token string">"test answer "</span> <span class="token operator">+</span> index<span class="token punctuation">,</span></div><br><div class="line-0-0-16 " data-content="      isExpanded: false,"><span class="lineCounter-0-0-15 prim">15</span>      isExpanded<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span></div><br><div class="line-0-0-16 " data-content="      key: index,"><span class="lineCounter-0-0-15">16</span>      key<span class="token operator">:</span> index<span class="token punctuation">,</span></div><br><div class="line-0-0-16 " data-content="    });"><span class="lineCounter-0-0-15">17</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  }"><span class="lineCounter-0-0-15">18</span>  <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="  return faqs;"><span class="lineCounter-0-0-15">19</span>  <span class="token keyword">return</span> faqs<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="};"><span class="lineCounter-0-0-15 prim">20</span><span class="token punctuation">}</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">21</span></div><br><div class="line-0-0-16 " data-content="const getFAQAdapter = registerApexTestWireAdapter(getFAQs);"><span class="lineCounter-0-0-15">22</span><span class="token keyword">const</span> getFAQAdapter <span class="token operator">=</span> <span class="token function">registerApexTestWireAdapter</span><span class="token punctuation">(</span>getFAQs<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">23</span></div><br><div class="line-0-0-16 " data-content="function assertForTestConditions() {"><span class="lineCounter-0-0-15">24</span><span class="token keyword">function</span> <span class="token function">assertForTestConditions</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  const resolvedPromise = Promise.resolve();"><span class="lineCounter-0-0-15 prim">25</span>  <span class="token keyword">const</span> resolvedPromise <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  return resolvedPromise.then.apply(resolvedPromise, arguments);"><span class="lineCounter-0-0-15">26</span>  <span class="token keyword">return</span> resolvedPromise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>resolvedPromise<span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="}"><span class="lineCounter-0-0-15">27</span><span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">28</span></div><br><div class="line-0-0-16 " data-content="describe(&quot;FAQ&quot;, () => {"><span class="lineCounter-0-0-15">29</span><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">"FAQ"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  afterEach(() => {"><span class="lineCounter-0-0-15 prim">30</span>  <span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    while (document.body.firstChild) {"><span class="lineCounter-0-0-15">31</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>firstChild<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="      document.body.removeChild(document.body.firstChild);"><span class="lineCounter-0-0-15">32</span>      document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>firstChild<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    }"><span class="lineCounter-0-0-15">33</span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="    jest.clearAllMocks();"><span class="lineCounter-0-0-15">34</span>    jest<span class="token punctuation">.</span><span class="token function">clearAllMocks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  });"><span class="lineCounter-0-0-15 prim">35</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">36</span></div><br><div class="line-0-0-16 " data-content="  describe(&quot;FAQ tests&quot;, () => {"><span class="lineCounter-0-0-15">37</span>  <span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">"FAQ tests"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    it(&quot;renders full faq list&quot;, () => {"><span class="lineCounter-0-0-15">38</span>    <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">"renders full faq list"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="      const element = createElement(&quot;faq-list&quot;, {"><span class="lineCounter-0-0-15">39</span>      <span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"faq-list"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="        is: FAQ,"><span class="lineCounter-0-0-15 prim">40</span>        is<span class="token operator">:</span> <span class="token constant">FAQ</span><span class="token punctuation">,</span></div><br><div class="line-0-0-16 " data-content="      });"><span class="lineCounter-0-0-15">41</span>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">42</span></div><br><div class="line-0-0-16 " data-content="      document.body.appendChild(element);"><span class="lineCounter-0-0-15">43</span>      document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="      getFAQAdapter.emit(getFakeFAQs());"><span class="lineCounter-0-0-15">44</span>      getFAQAdapter<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token function">getFakeFAQs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15 prim">45</span></div><br><div class="line-0-0-16 " data-content="      return assertForTestConditions(() => {"><span class="lineCounter-0-0-15">46</span>      <span class="token keyword">return</span> <span class="token function">assertForTestConditions</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="        expect("><span class="lineCounter-0-0-15">47</span>        <span class="token function">expect</span><span class="token punctuation">(</span></div><br><div class="line-0-0-16 " data-content="          element.shadowRoot.querySelectorAll(&quot;lightning-accordion-section&quot;)"><span class="lineCounter-0-0-15">48</span>          element<span class="token punctuation">.</span>shadowRoot<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">"lightning-accordion-section"</span><span class="token punctuation">)</span></div><br><div class="line-0-0-16 " data-content="            .length"><span class="lineCounter-0-0-15">49</span>            <span class="token punctuation">.</span>length</div><br><div class="line-0-0-16 " data-content="        ).toBe(FAQ_AMOUNT);"><span class="lineCounter-0-0-15 prim">50</span>        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token constant">FAQ_AMOUNT</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="      });"><span class="lineCounter-0-0-15">51</span>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    });"><span class="lineCounter-0-0-15">52</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">53</span></div><br><div class="line-0-0-16 " data-content="    it(&quot;expands and contracts on click&quot;, () => {"><span class="lineCounter-0-0-15">54</span>    <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">"expands and contracts on click"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="      const element = createElement(&quot;faq-list&quot;, {"><span class="lineCounter-0-0-15 prim">55</span>      <span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"faq-list"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="        is: FAQ,"><span class="lineCounter-0-0-15">56</span>        is<span class="token operator">:</span> <span class="token constant">FAQ</span><span class="token punctuation">,</span></div><br><div class="line-0-0-16 " data-content="      });"><span class="lineCounter-0-0-15">57</span>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="      document.body.appendChild(element);"><span class="lineCounter-0-0-15">58</span>      document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="      getFAQAdapter.emit(getFakeFAQs());"><span class="lineCounter-0-0-15">59</span>      getFAQAdapter<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token function">getFakeFAQs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15 prim">60</span></div><br><div class="line-0-0-16 " data-content="      //get the first anchor and test clicking it"><span class="lineCounter-0-0-15">61</span>      <span class="token comment">//get the first anchor and test clicking it</span></div><br><div class="line-0-0-16 " data-content="      assertForTestConditions("><span class="lineCounter-0-0-15">62</span>      <span class="token function">assertForTestConditions</span><span class="token punctuation">(</span></div><br><div class="line-0-0-16 " data-content="        () =>"><span class="lineCounter-0-0-15">63</span>        <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span></div><br><div class="line-0-0-16 " data-content="          element.shadowRoot"><span class="lineCounter-0-0-15">64</span>          element<span class="token punctuation">.</span>shadowRoot</div><br><div class="line-0-0-16 " data-content="            .querySelector(&quot;lightning-accordion-section&quot;)"><span class="lineCounter-0-0-15 prim">65</span>            <span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"lightning-accordion-section"</span><span class="token punctuation">)</span></div><br><div class="line-0-0-16 " data-content="            .click(),"><span class="lineCounter-0-0-15">66</span>            <span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></div><br><div class="line-0-0-16 " data-content="        () =>"><span class="lineCounter-0-0-15">67</span>        <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span></div><br><div class="line-0-0-16 " data-content="          expect(element.shadowRoot.querySelectorAll(&quot;small&quot;).length).toBe(1)"><span class="lineCounter-0-0-15">68</span>          <span class="token function">expect</span><span class="token punctuation">(</span>element<span class="token punctuation">.</span>shadowRoot<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">"small"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></div><br><div class="line-0-0-16 " data-content="      );"><span class="lineCounter-0-0-15">69</span>      <span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    });"><span class="lineCounter-0-0-15 prim">70</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  });"><span class="lineCounter-0-0-15">71</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="});"><span class="lineCounter-0-0-15 prim">72</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br></code></pre><p>This leads to the following output:</p><pre class=""><code class="bash code-0-0-14" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16 " data-content="  FAQ"><span class="lineCounter-0-0-15 prim">1</span>  FAQ</div><br><div class="line-0-0-16 " data-content="    FAQ tests"><span class="lineCounter-0-0-15">2</span>    FAQ tests</div><br><div class="line-0-0-16 " data-content="      √ renders full faq list (415ms)"><span class="lineCounter-0-0-15">3</span>      √ renders full faq list <span class="token punctuation">(</span>415ms<span class="token punctuation">)</span></div><br><div class="line-0-0-16 " data-content="      √ expands and contracts on click (430ms)"><span class="lineCounter-0-0-15">4</span>      √ expands and contracts on click <span class="token punctuation">(</span>430ms<span class="token punctuation">)</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15 prim">5</span></div><br><div class="line-0-0-16 " data-content="Test Suites: 1 passed, 1 total"><span class="lineCounter-0-0-15">6</span>Test Suites: <span class="token number">1</span> passed, <span class="token number">1</span> total</div><br><div class="line-0-0-16 " data-content="Tests:       2 passed, 2 total"><span class="lineCounter-0-0-15 prim">7</span>Tests:       <span class="token number">2</span> passed, <span class="token number">2</span> total</div><br></code></pre><p>You'll notice that I didn't include the test for expanding/contracting when reviewing the React version of this component. This is partially because I expect readers to be less familiar with Typescript/React, and because that discussion was more about how simple JavaScript enhancements can lead to big increases in render speed. Here, the conversation is a little different:</p><ul><li>we aren't really "mounting" the LWC component a la Enzyme -- a shame, because it makes end-to-end comparisons between the two frameworks difficult, as far as speed is concerned</li><li>the conditional logic isn't tied to CSS styling, as it is with React -- it's literally baked into the templating framework for LWC, which means that we aren't testing the CSS of the component to ensure it renders correctly, but rather that the element is correctly inserted into the DOM. I don't consider this to be a strength of the framework, as one of the reasons I was glad to move away from things like Handlebars was due to that invisible coupling between logic and HTML.</li><li>optimizations for iterating through large lists of components are partially tied to the framework. I say "partially" because pagination is of course a necessary part of displaying large lists of information to consumers; pagination is a framework-agnostic performance optimization (so there's no "FastFAQ" LWC to be created)</li></ul><p>A few takeaways:</p><ul><li>while it's nice that we achieve separation of concerns by the controller fetching the FAQ's separate from the rest of the component, the framework is still nascent, and it's awkward that you have to both inject the component into the DOM AND use a helper function just in order to load up your test data</li><li>there's a lot of boilerplate going into the tests -- which I only partially reduced through the use of my "thennable" assert function</li><li>there's no way to perform an end-to-end test with the Apex controller and the LWC. This is disappointing: while I'm a huge proponent of unit tests in general, the fact that you <em>can't</em> even return mock data in your Apex controller and see that data flow into your component represents a weak point in the framework: you can have unit tests for both your Apex controller and your LWC, but you can't directly validate that somebody changing the controller doesn't mess up the data your component is supposed to be ingesting</li></ul><p>With those things being said, it's my hope that the <code>@salesforce/sfdx-lwc-jest</code> library will continue to expand, offering developers better options for feeding their LWC data</p><h2 id="revisiting-react-to-test-clicking" class="heading-0-0-12"><span class="anchor-0-0-13" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Revisiting React To Test Clicking</h2><p>Let's re-visit the Typescript/React implementation, swapping out the heavy-lefting <code>mount</code> call to Enzyme with the more-performant <code>shallow</code> renderer (to try to get closer to an apples-to-apples comparison between the two frameworks). I'll add in a test for clicking one of the FAQ questions, with the caveat that normally I would be using a CSS-in-JS library and actually using helper functions to assert that the styles matched after clicking. This is an important distinction between ecosystems, however -- it's easy to use soomething like Emotion or Styled Components with React and then verify that styles have updated correctly using helper functions provided by those self-same libraries.</p><p>This is also exactly what I am hoping will happen within the LWC community -- it would be awesome to see something like hot module reloading (HMR) when developing LWC, for example, and HMR was an open-source contribution within the ecosystem of frameworks that uses Webpack to bundle their code ... so it's certainly possible.</p><p>Anyway:</p><pre class="with-bar"><code class="typescript code-0-0-14" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span>src/components/faq/__tests__/faq.test.js</span></span><div class="line-0-0-16 " data-content="import { shallow } from &quot;enzyme&quot;;"><span class="lineCounter-0-0-15 prim">1</span><span class="token keyword">import</span> <span class="token punctuation">{</span> shallow <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"enzyme"</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="import React from &quot;react&quot;;"><span class="lineCounter-0-0-15">2</span><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">3</span></div><br><div class="line-0-0-16 " data-content="import { FAQ } from &quot;../faq&quot;;"><span class="lineCounter-0-0-15">4</span><span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">FAQ</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"../faq"</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="import { FastFAQ } from &quot;../fast-faq&quot;;"><span class="lineCounter-0-0-15 prim">5</span><span class="token keyword">import</span> <span class="token punctuation">{</span> FastFAQ <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"../fast-faq"</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">6</span></div><br><div class="line-0-0-16 " data-content="const listCount = 1000;"><span class="lineCounter-0-0-15">7</span><span class="token keyword">const</span> listCount <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">8</span></div><br><div class="line-0-0-16 " data-content="const getList = () => {"><span class="lineCounter-0-0-15">9</span><span class="token keyword">const</span> <span class="token function-variable function">getList</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  const list = [];"><span class="lineCounter-0-0-15 prim">10</span>  <span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  for (let index = 0; index < listCount; index++) {"><span class="lineCounter-0-0-15">11</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> listCount<span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    list.push({ question: index, answer: &quot;some answer&quot; });"><span class="lineCounter-0-0-15">12</span>    list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> question<span class="token operator">:</span> index<span class="token punctuation">,</span> answer<span class="token operator">:</span> <span class="token string">"some answer"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  }"><span class="lineCounter-0-0-15">13</span>  <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="  return list;"><span class="lineCounter-0-0-15">14</span>  <span class="token keyword">return</span> list<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="};"><span class="lineCounter-0-0-15 prim">15</span><span class="token punctuation">}</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">16</span></div><br><div class="line-0-0-16 " data-content="const bigOldList = getList();"><span class="lineCounter-0-0-15">17</span><span class="token keyword">const</span> bigOldList <span class="token operator">=</span> <span class="token function">getList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">18</span></div><br><div class="line-0-0-16 " data-content="describe(&quot;FAQ&quot;, () => {"><span class="lineCounter-0-0-15">19</span><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">"FAQ"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  it(&quot;should render faq&quot;, () => {"><span class="lineCounter-0-0-15 prim">20</span>  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">"should render faq"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    const wrapper = shallow(<FAQ faq={bigOldList} />);"><span class="lineCounter-0-0-15">21</span>    <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">shallow</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token constant">FAQ</span> faq<span class="token operator">=</span><span class="token punctuation">{</span>bigOldList<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    expect(wrapper.getElements()[0].props.children[1].length).toBe(listCount);"><span class="lineCounter-0-0-15">22</span>    <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">getElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>listCount<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  });"><span class="lineCounter-0-0-15">23</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  it(&quot;should render fast-faq&quot;, () => {"><span class="lineCounter-0-0-15">24</span>  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">"should render fast-faq"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    const wrapper = shallow(<FastFAQ faq={bigOldList} />);"><span class="lineCounter-0-0-15 prim">25</span>    <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">shallow</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>FastFAQ faq<span class="token operator">=</span><span class="token punctuation">{</span>bigOldList<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    expect(wrapper.getElements()[0].props.children[1].length).toBe(listCount);"><span class="lineCounter-0-0-15">26</span>    <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">getElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>listCount<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  });"><span class="lineCounter-0-0-15">27</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  it(&quot;should toggle isExpanded on click&quot;, () => {"><span class="lineCounter-0-0-15">28</span>  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">"should toggle isExpanded on click"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    const wrapper = shallow(<FastFAQ faq={bigOldList} />);"><span class="lineCounter-0-0-15">29</span>    <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">shallow</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>FastFAQ faq<span class="token operator">=</span><span class="token punctuation">{</span>bigOldList<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    wrapper.getElements()[0].props.children[1][0].props.onClick();"><span class="lineCounter-0-0-15 prim">30</span>    wrapper<span class="token punctuation">.</span><span class="token function">getElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">onClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    expect("><span class="lineCounter-0-0-15">31</span>    <span class="token function">expect</span><span class="token punctuation">(</span></div><br><div class="line-0-0-16 " data-content="      wrapper.getElements()[0].props.children[1][0].props.children[1].props"><span class="lineCounter-0-0-15">32</span>      wrapper<span class="token punctuation">.</span><span class="token function">getElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>props</div><br><div class="line-0-0-16 " data-content="        .isExpanded"><span class="lineCounter-0-0-15">33</span>        <span class="token punctuation">.</span>isExpanded</div><br><div class="line-0-0-16 " data-content="    ).toBeTruthy();"><span class="lineCounter-0-0-15">34</span>    <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeTruthy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  });"><span class="lineCounter-0-0-15 prim">35</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="});"><span class="lineCounter-0-0-15 prim">36</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br></code></pre><p>This leads to the following output:</p><pre class=""><code class="bash code-0-0-14" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16 " data-content="  FAQ"><span class="lineCounter-0-0-15 prim">1</span>  FAQ</div><br><div class="line-0-0-16 " data-content="    √ should render faq (235ms)"><span class="lineCounter-0-0-15">2</span>    √ should render faq <span class="token punctuation">(</span>235ms<span class="token punctuation">)</span></div><br><div class="line-0-0-16 " data-content="    √ should render fast-faq (61ms)"><span class="lineCounter-0-0-15">3</span>    √ should render fast-faq <span class="token punctuation">(</span>61ms<span class="token punctuation">)</span></div><br><div class="line-0-0-16 " data-content="    √ should toggle isExpanded on click (97ms)"><span class="lineCounter-0-0-15">4</span>    √ should toggle isExpanded on click <span class="token punctuation">(</span>97ms<span class="token punctuation">)</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15 prim">5</span></div><br><div class="line-0-0-16 " data-content="Test Suites: 1 passed, 1 total"><span class="lineCounter-0-0-15">6</span>Test Suites: <span class="token number">1</span> passed, <span class="token number">1</span> total</div><br><div class="line-0-0-16 " data-content="Tests:       3 passed, 3 total"><span class="lineCounter-0-0-15 prim">7</span>Tests:       <span class="token number">3</span> passed, <span class="token number">3</span> total</div><br></code></pre><p>When testing components as their own strict unit (which is what <code>shallow</code> does within Enzyme, as opposed to simulating the load of the whole DOM), there's no denying that React can be absurdly fast. I've worked on large React applications, and have seen firsthand how well the framework can scale.</p><h2 id="wrapping-up-react-versus-lightning-web-components" class="heading-0-0-12"><span class="anchor-0-0-13" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Wrapping Up: React Versus Lightning Web Components</h2><p>Some people are sidestepping the whole question of which framework is better by <a href="https://github.com/ccoenraets/lightning-container-component-samples/tree/master/force-app/main/default/aura/lccSampleReact">embedding React applications into their Lightning application pages.</a>. I ... probably wouldn't recommend doing that.</p><p>I feel as though I am still holding out on LWC. On the one hand, I like how composable the framework can be through the use of <code>&lt;slot&gt;</code> components and the <code>&lt;c-component-name&gt;</code> binding. On the other, I still prefer the explicit binding between imported components in React; it's one less step to see where all of your components are being used -- but perhaps at some point there will be "View Usage" functionality for LWC.</p><p>Rendering performance with LWC still leaves something to be desired. While certainly faster than the components that were being built out with Aura (and I don't miss those days at all), LWC still feels relatively sluggish compared to components rendered with Vue or with React. I would be interested in hearing about other performance optimizations that people have found helpful in their LWC usage.</p><p>How do you feel about LWC? Was this comparison with React interesting to you? Let me know in the comments! I've seen some pretty impressive components built out already, and I'm looking forward to building more and seeing the framework achieve mainstream adoption and better tooling support within the SFDC ecosystem. If you'd like to peruse the code from this example, please refer to my <a href="https://github.com/jamessimone/apex-mocks-stress-test/tree/lwc-react-comparison">GitHub's LWC branch</a>.</p><p>Stay tuned for my <a href="/joys-of-apex/apex-object-oriented-basics">Apex Object-Oriented Programming Basics</a> post. Till then, thanks for reading - if you liked this post, check out my post on creating a <a href="/joys-of-apex/lwc-composable-pagination">composable pagination component</a>!</p><div class="contentnav-0-0-7" data-no-search=""><a href="#testing-in-a-reacttypescript-component" class="h2" data-content-highlight="testing-in-a-reacttypescript-component">Testing In A React/Typescript Component</a><a href="#testing-in-a-lightning-web-component" class="h2" data-content-highlight="testing-in-a-lightning-web-component">Testing In A Lightning Web Component</a><a href="#revisiting-react-to-test-clicking" class="h2" data-content-highlight="revisiting-react-to-test-clicking">Revisiting React To Test Clicking</a><a href="#wrapping-up-react-versus-lightning-web-components" class="h2" data-content-highlight="wrapping-up-react-versus-lightning-web-components">Wrapping Up: React Versus Lightning Web Components</a></div></div><div id="-codedoc-toc" class="toc-0-0-4"><div class="content-0-0-5"><p><a href="/joys-of-apex/">Home</a>
<a href="/joys-of-apex/apex-logging-service">Apex Logging Service</a>
<a href="/joys-of-apex/apex-object-oriented-basics">Apex Object-Oriented Basics</a>
<a href="/joys-of-apex/batchable-and-queueable-apex">Batchable And Queueable Apex</a>
<a href="/joys-of-apex/building-a-better-singleton">Building A Better Singleton</a>
<a href="/joys-of-apex/continuous-integration-with-sfdx">Continuous Integration With SFDX</a>
<a href="/joys-of-apex/dependency-injection-factory-pattern">Dependency Injection &amp; Factory Pattern</a>
<a href="/joys-of-apex/enum-apex-class-gotchas">Enum Apex Class Gotchas</a>
<a href="/joys-of-apex/extendable-apis">Extendable Apis</a>
<a href="/joys-of-apex/future-method-callout-callback">Future Methods, Callouts &amp; Callbacks</a>
<a href="/joys-of-apex/idiomatic-salesforce-apex">Idiomatic Salesforce Apex</a>
<a href="/joys-of-apex/intro">Introduction &amp; Testing Philosophy</a>
<a href="/joys-of-apex/lazy-iterators">Lazy Iterators</a>
<a href="/joys-of-apex/lightweight-trigger-handler">Lightweight Trigger Handler</a>
<a href="/joys-of-apex/lwc-composable-pagination">LWC Composable Pagination</a>
<a href="/joys-of-apex/mocking-dml">Mocking DML</a>
<a href="/joys-of-apex/react-versus-lightning-web-components">React Versus Lightning Web Components</a>
<a href="/joys-of-apex/repository-pattern">Repository Pattern</a>
<a href="/joys-of-apex/sorting-and-performance-in-apex">Sorting And Performance In Apex</a>
<a href="/joys-of-apex/test-driven-development-example">Test Driven Development Example</a>
<a href="/joys-of-apex/writing-performant-apex-tests">Writing Performant Apex Tests</a></p><p><br><br></p><p><a href="https://www.jamessimone.net/">Read more tech articles</a></p></div></div><div class="footer-0-0-3"><div class="left"><script id="aGRZhRBEjY">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("aGRZhRBEjY", "BWW0vHR4333HbDOiwZ67JA==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script></div><div class="main"><div class="inside"></div></div><div class="right"><script id="DeXecbacMi">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("DeXecbacMi", "6yEdMfRRlNsUBKSBOTazFg==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script></div></div><script id="FumrnsSSOo">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("FumrnsSSOo", "wh9V9isakhdwzlz9ZUjvyw==", {"namespace":"/joys-of-apex"});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script></body></html>