<!DOCTYPE html><html><head><title>Joys Of Apex | Lightweight Trigger Handler</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><meta name="robots" content="index,follow"><meta name="theme-color" content="#212121"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><link rel="shortcut icon" href="/joys-of-apex/favicon.ico"><link href="https://fonts.googleapis.com/css?family=Hind:400,700&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:300,400&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/icon?family=Material+Icons|Material+Icons+Outlined" rel="stylesheet"><style>
      body, input, button {
        font-family: 'Hind', sans-serif;
      }

      code, .hljs {
        font-family: 'Source Code Pro', 'Courier New', Courier, monospace;
      }

      .icon-font {
        font-family: 'Material Icons';
        font-weight: normal;
        font-style: normal;
        font-size: 24px;  /* Preferred icon size */
        display: inline-block;
        line-height: 1;
        text-transform: none;
        letter-spacing: normal;
        word-wrap: normal;
        white-space: nowrap;
        direction: ltr;
      
        /* Support for all WebKit browsers. */
        -webkit-font-smoothing: antialiased;
        /* Support for Safari and Chrome. */
        text-rendering: optimizeLegibility;
      
        /* Support for Firefox. */
        -moz-osx-font-smoothing: grayscale;
      
        /* Support for IE. */
        font-feature-settings: 'liga';
      }

      .icon-font.outline {
        font-family: 'Material Icons Outlined';
      }
    </style><link href="/joys-of-apex/styles/codedoc-styles.css" rel="stylesheet"><script async="" defer="" src="/joys-of-apex/bundle/codedoc-bundle.js"></script><meta property="og:image" content="./img/joys-of-apex-thumbnail.png"><script>window.githubConfig={"repo":"james-coding-blog","user":"jamessimone"}</script><style>.container{padding-top: 0 !important}</style><style>#-codedoc-toc { backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px) }</style><meta name="twitter:title" content="Joys Of Apex | Lightweight Trigger Handler"><meta property="og:type" content="article"><meta property="og:title" content="Joys Of Apex | Lightweight Trigger Handler"></head><body><header style="margin-left: 1rem">Read more at <a href="https://wwww.jamessimone.net">jamessimone.net</a>, or return to the <a href="/joys-of-apex/">homepage</a></header><div id="-codedoc-container" class="container"><script>window.source = {"base":"posts","path":"lightweight-trigger-handler.md","namespace":"/joys-of-apex","title":{"base":"Joys Of Apex","connector":" | "}}</script><div class="hero-0-0-8" style="margin-bottom: -156px"><img src="/joys-of-apex/img/the-joys-of-apex.png" class="image-0-0-9" data-hero=""><span class="caption-0-0-10"></span></div><marker><br>
<br>
<br>
<br>
<br>

</marker><h1 class="h-0-0-11 "><span style="color: green; 
      text-shadow: none; 
      font-size: 48px"><p>Lightweight Trigger Handler</p></span></h1><script id="fMfIDRGZyj">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("fMfIDRGZyj", "kRzsgnV+B7EQTskbovy+YA==", {"src":"github","date":"2020-02-29T15:12:03.284Z"});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script><div hidden="" data-ignore-text="" data-meta-override-property="og:image"><p>./img/joys-of-apex-thumbnail.png</p></div><p>Tap into the power of the Trigger Handler pattern in Salesforce with this extremely lightweight Trigger Handler framework. I was doing some research for an upcoming post (on how to write performant tests, and why that matters) when I name-dropped probably the single most used pattern on the SFDC platform -- the concept of the single "handler" class per SObject trigger: the Trigger Handler pattern.</p><div class="tabs-0-0-18"><script id="xeLJPtPVjj">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("xeLJPtPVjj", "T764P9zpaV5eSCd1H0okyw==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script><div class="tab first selected" data-tab-title="Trigger Pattern Notes"><p>A number of prominent SFDC personalities -- <a href="https://github.com/kevinohara80/sfdc-trigger-framework">Kevin O'Hara</a>, <a href="https://advancedapex.com/">Dan Appleman</a>, to name two -- have championed this pattern over the years. Despite this, it lacks support from the <a href="https://developer.salesforce.com/docs/atlas.en-us.apexcode.meta/apexcode/apex_triggers.htm">official Salesforce documentation on Triggers</a> ... although I actually think that, in general, the Apex Developer Guide is amongst the most well-maintained knowledge bases for code anywhere. In any case, using one "handler" class per SObject is of crucial importance -- having seen a few orgs that made the use of multiple Triggers for the same SObject, I can only say that tracking updates and following the code becomes substantially harder if you put logic into your triggers themselves or if your triggers call multiple classes.</p></div><div class="tab" data-tab-title="Trigger Pattern Footnote"><p>Especially after a recent experience helping a friend debug his Mongoose.js / Mongo application, I would submit that great documentation can lift up a sub-par API, yet most API docs I read seem doomed to be afterthoughts, sadly outdated and lacking completeness -- dragging down things that might otherwise have been helpful. If there's one thing that Salesforce has done <em>really</em> well over the years, it's been their constant maintenance of the official docs.</p></div></div><p>I don't think there's a lot of room in the "Trigger Handler" space; if anything, I would simply suggest using Kevin O'Hara's pattern and being done with it. With that being said, there are a few reasons that you might want to go with something considerably more light-weight:</p><ul><li>You don't care about recursion in triggers / don't need to detect for it</li><li>You don't care about disabling other SObject triggers / don't want to be pegged to a specific API for doing so</li></ul><p>There was one article I read online that, after reviewing Kevin O'Hara's implementation, decided it was too verbose ... then made an interface for their own implementation, forcing any potential consumer to implement all of the trigger methods in order to subscribe. I went for a run after seeing that particular ... suggestion.</p><h2 id="implementing-the-simplest-possible-trigger-handler" class="heading-0-0-12"><span class="anchor-0-0-13" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Implementing The Simplest Possible Trigger Handler</h2><p>This is the most streamlined Trigger Handler implementation that I could stomach:</p><pre class="with-bar"><code class="java code-0-0-14" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span>classes/TriggerHandler.cls</span></span><div class="line-0-0-16 " data-content="public virtual class TriggerHandler {"><span class="lineCounter-0-0-15 prim">1</span><span class="token keyword">public</span> virtual <span class="token keyword">class</span> <span class="token class-name">TriggerHandler</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">2</span></div><br><div class="line-0-0-16 " data-content="    protected TriggerHandler() {"><span class="lineCounter-0-0-15">3</span>    <span class="token keyword">protected</span> <span class="token class-name">TriggerHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="        if(!Trigger.isExecuting &amp;&amp; !Test.isRunningTest()) {"><span class="lineCounter-0-0-15">4</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">Trigger</span><span class="token punctuation">.</span>isExecuting <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token class-name">Test</span><span class="token punctuation">.</span><span class="token function">isRunningTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="            throw new TriggerHandlerException('TriggerHandler used outside of triggers / testing');"><span class="lineCounter-0-0-15 prim">5</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TriggerHandlerException</span><span class="token punctuation">(</span><span class="token string">'TriggerHandler used outside of triggers / testing'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="        }"><span class="lineCounter-0-0-15">6</span>        <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="    }"><span class="lineCounter-0-0-15">7</span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">8</span></div><br><div class="line-0-0-16 " data-content="    public void execute() {"><span class="lineCounter-0-0-15">9</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="        switch on Trigger.operationType {"><span class="lineCounter-0-0-15 prim">10</span>        <span class="token keyword">switch</span> on <span class="token class-name">Trigger</span><span class="token punctuation">.</span>operationType <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="            when BEFORE_INSERT {"><span class="lineCounter-0-0-15">11</span>            when BEFORE_INSERT <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="                this.beforeInsert(Trigger.new);"><span class="lineCounter-0-0-15">12</span>                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">beforeInsert</span><span class="token punctuation">(</span><span class="token class-name">Trigger</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="            }"><span class="lineCounter-0-0-15">13</span>            <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="            when BEFORE_UPDATE {"><span class="lineCounter-0-0-15">14</span>            when BEFORE_UPDATE <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="                this.beforeUpdate(Trigger.new, Trigger.newMap, Trigger.old, Trigger.oldMap);"><span class="lineCounter-0-0-15 prim">15</span>                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">beforeUpdate</span><span class="token punctuation">(</span><span class="token class-name">Trigger</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">,</span> <span class="token class-name">Trigger</span><span class="token punctuation">.</span>newMap<span class="token punctuation">,</span> <span class="token class-name">Trigger</span><span class="token punctuation">.</span>old<span class="token punctuation">,</span> <span class="token class-name">Trigger</span><span class="token punctuation">.</span>oldMap<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="            }"><span class="lineCounter-0-0-15">16</span>            <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="            when BEFORE_DELETE {"><span class="lineCounter-0-0-15">17</span>            when BEFORE_DELETE <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="                this.beforeDelete(Trigger.old, Trigger.oldMap);"><span class="lineCounter-0-0-15">18</span>                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">beforeDelete</span><span class="token punctuation">(</span><span class="token class-name">Trigger</span><span class="token punctuation">.</span>old<span class="token punctuation">,</span> <span class="token class-name">Trigger</span><span class="token punctuation">.</span>oldMap<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="            }"><span class="lineCounter-0-0-15">19</span>            <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="            when AFTER_INSERT {"><span class="lineCounter-0-0-15 prim">20</span>            when AFTER_INSERT <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="                this.afterInsert(Trigger.new, Trigger.newMap);"><span class="lineCounter-0-0-15">21</span>                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">afterInsert</span><span class="token punctuation">(</span><span class="token class-name">Trigger</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">,</span> <span class="token class-name">Trigger</span><span class="token punctuation">.</span>newMap<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="            }"><span class="lineCounter-0-0-15">22</span>            <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="            when AFTER_UPDATE {"><span class="lineCounter-0-0-15">23</span>            when AFTER_UPDATE <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="                this.afterUpdate(Trigger.new, Trigger.newMap, Trigger.old, Trigger.oldMap);"><span class="lineCounter-0-0-15">24</span>                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">afterUpdate</span><span class="token punctuation">(</span><span class="token class-name">Trigger</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">,</span> <span class="token class-name">Trigger</span><span class="token punctuation">.</span>newMap<span class="token punctuation">,</span> <span class="token class-name">Trigger</span><span class="token punctuation">.</span>old<span class="token punctuation">,</span> <span class="token class-name">Trigger</span><span class="token punctuation">.</span>oldMap<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="            }"><span class="lineCounter-0-0-15 prim">25</span>            <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="            when AFTER_DELETE {"><span class="lineCounter-0-0-15">26</span>            when AFTER_DELETE <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="                this.afterDelete(Trigger.old, Trigger.oldMap);"><span class="lineCounter-0-0-15">27</span>                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">afterDelete</span><span class="token punctuation">(</span><span class="token class-name">Trigger</span><span class="token punctuation">.</span>old<span class="token punctuation">,</span> <span class="token class-name">Trigger</span><span class="token punctuation">.</span>oldMap<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="            }"><span class="lineCounter-0-0-15">28</span>            <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="            when AFTER_UNDELETE {"><span class="lineCounter-0-0-15">29</span>            when AFTER_UNDELETE <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="                this.afterUndelete(Trigger.new, Trigger.newMap);"><span class="lineCounter-0-0-15 prim">30</span>                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">afterUndelete</span><span class="token punctuation">(</span><span class="token class-name">Trigger</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">,</span> <span class="token class-name">Trigger</span><span class="token punctuation">.</span>newMap<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="            }"><span class="lineCounter-0-0-15">31</span>            <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="        }"><span class="lineCounter-0-0-15">32</span>        <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="    }"><span class="lineCounter-0-0-15">33</span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">34</span></div><br><div class="line-0-0-16 " data-content="    protected virtual void beforeInsert(List<SObject> newRecords) {}"><span class="lineCounter-0-0-15 prim">35</span>    <span class="token keyword">protected</span> virtual <span class="token keyword">void</span> <span class="token function">beforeInsert</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> newRecords<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="    protected virtual void beforeUpdate(List<SObject> updatedRecords, Map<Id, SObject> updatedRecordsMap, List<SObject> oldRecords, Map<Id, SObject> oldRecordsMap) {}"><span class="lineCounter-0-0-15">36</span>    <span class="token keyword">protected</span> virtual <span class="token keyword">void</span> <span class="token function">beforeUpdate</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> updatedRecords<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Id</span><span class="token punctuation">,</span> <span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> updatedRecordsMap<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> oldRecords<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Id</span><span class="token punctuation">,</span> <span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> oldRecordsMap<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="    protected virtual void beforeDelete(List<SObject> deletedRecords, Map<Id, SObject> deletedRecordsMap) {}"><span class="lineCounter-0-0-15">37</span>    <span class="token keyword">protected</span> virtual <span class="token keyword">void</span> <span class="token function">beforeDelete</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> deletedRecords<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Id</span><span class="token punctuation">,</span> <span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> deletedRecordsMap<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="    protected virtual void afterInsert(List<SObject> newRecords, Map<Id, SObject> newRecordsMap) {}"><span class="lineCounter-0-0-15">38</span>    <span class="token keyword">protected</span> virtual <span class="token keyword">void</span> <span class="token function">afterInsert</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> newRecords<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Id</span><span class="token punctuation">,</span> <span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> newRecordsMap<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="    protected virtual void afterUpdate(List<SObject> updatedRecords, Map<Id, SObject> updatedRecordsMap, List<SObject> oldRecords, Map<Id, SObject> oldRecordsMap) {}"><span class="lineCounter-0-0-15">39</span>    <span class="token keyword">protected</span> virtual <span class="token keyword">void</span> <span class="token function">afterUpdate</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> updatedRecords<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Id</span><span class="token punctuation">,</span> <span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> updatedRecordsMap<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> oldRecords<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Id</span><span class="token punctuation">,</span> <span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> oldRecordsMap<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="    protected virtual void afterDelete(List<SObject> deletedRecords, Map<Id, SObject> deletedRecordsMap) {}"><span class="lineCounter-0-0-15 prim">40</span>    <span class="token keyword">protected</span> virtual <span class="token keyword">void</span> <span class="token function">afterDelete</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> deletedRecords<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Id</span><span class="token punctuation">,</span> <span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> deletedRecordsMap<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="    protected virtual void afterUndelete(List<SObject> undeletedRecords, Map<Id, SObject> undeletedRecordsMap) {}"><span class="lineCounter-0-0-15">41</span>    <span class="token keyword">protected</span> virtual <span class="token keyword">void</span> <span class="token function">afterUndelete</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> undeletedRecords<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Id</span><span class="token punctuation">,</span> <span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> undeletedRecordsMap<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">42</span></div><br><div class="line-0-0-16 " data-content="    private class TriggerHandlerException extends Exception {}"><span class="lineCounter-0-0-15">43</span>    <span class="token keyword">private</span> <span class="token keyword">class</span> <span class="token class-name">TriggerHandlerException</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="}"><span class="lineCounter-0-0-15 prim">44</span><span class="token punctuation">}</span></div><br></code></pre><p>Every time I use a switch statement now that they're finally out in Apex, I find myself asking the question: "was that brief bit of syntactical sugar really worth the extra lines?" Perhaps not. You could drop a few lines by using our good old if/else paradigm against the <code>Trigger.operationType</code> enum. I shed a single tear of happiness when that enum was released, representative of the years spent looking at Trigger Handler frameworks' boolean comparisons on Trigger.isInsert, Trigger.isDelete, Trigger.isBefore, etc ...</p><p>Here's some similarly slimmed down tests:</p><pre class="with-bar"><code class="java code-0-0-14" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span>classes/TriggerHandler_Tests.cls</span></span><div class="line-0-0-16 " data-content="@isTest"><span class="lineCounter-0-0-15 prim">1</span><span class="token annotation punctuation">@isTest</span></div><br><div class="line-0-0-16 " data-content="private class TriggerHandler_Tests {"><span class="lineCounter-0-0-15">2</span><span class="token keyword">private</span> <span class="token keyword">class</span> <span class="token class-name">TriggerHandler_Tests</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    //I normally put private classes at the bottom, but to prevent you from having to scroll ..."><span class="lineCounter-0-0-15">3</span>    <span class="token comment">//I normally put private classes at the bottom, but to prevent you from having to scroll ...</span></div><br><div class="line-0-0-16 " data-content="    private class TestTriggerHandler extends TriggerHandler {"><span class="lineCounter-0-0-15">4</span>    <span class="token keyword">private</span> <span class="token keyword">class</span> <span class="token class-name">TestTriggerHandler</span> <span class="token keyword">extends</span> <span class="token class-name">TriggerHandler</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="        public TriggerOperation Method { get; private set;}"><span class="lineCounter-0-0-15 prim">5</span>        <span class="token keyword">public</span> <span class="token class-name">TriggerOperation</span> <span class="token class-name">Method</span> <span class="token punctuation">{</span> get<span class="token punctuation">;</span> <span class="token keyword">private</span> set<span class="token punctuation">;</span><span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">6</span></div><br><div class="line-0-0-16 " data-content="        @testVisible protected override void beforeInsert(List<SObject> newRecords) { this.Method = TriggerOperation.BEFORE_INSERT; }"><span class="lineCounter-0-0-15">7</span>        <span class="token annotation punctuation">@testVisible</span> <span class="token keyword">protected</span> override <span class="token keyword">void</span> <span class="token function">beforeInsert</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> newRecords<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token class-name">Method</span> <span class="token operator">=</span> <span class="token class-name">TriggerOperation</span><span class="token punctuation">.</span>BEFORE_INSERT<span class="token punctuation">;</span> <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="        @testVisible protected override void beforeUpdate(List<SObject> updatedRecords, Map<Id, SObject> updatedRecordsMap, List<SObject> oldRecords, Map<Id, SObject> oldRecordsMap) {"><span class="lineCounter-0-0-15">8</span>        <span class="token annotation punctuation">@testVisible</span> <span class="token keyword">protected</span> override <span class="token keyword">void</span> <span class="token function">beforeUpdate</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> updatedRecords<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Id</span><span class="token punctuation">,</span> <span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> updatedRecordsMap<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> oldRecords<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Id</span><span class="token punctuation">,</span> <span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> oldRecordsMap<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="            this.Method = TriggerOperation.BEFORE_UPDATE;"><span class="lineCounter-0-0-15">9</span>            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token class-name">Method</span> <span class="token operator">=</span> <span class="token class-name">TriggerOperation</span><span class="token punctuation">.</span>BEFORE_UPDATE<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="        }"><span class="lineCounter-0-0-15 prim">10</span>        <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="        @testVisible protected override void beforeDelete(List<SObject> deletedRecords, Map<Id, SObject> deletedRecordsMap) {"><span class="lineCounter-0-0-15">11</span>        <span class="token annotation punctuation">@testVisible</span> <span class="token keyword">protected</span> override <span class="token keyword">void</span> <span class="token function">beforeDelete</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> deletedRecords<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Id</span><span class="token punctuation">,</span> <span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> deletedRecordsMap<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="            this.Method = TriggerOperation.BEFORE_DELETE;"><span class="lineCounter-0-0-15">12</span>            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token class-name">Method</span> <span class="token operator">=</span> <span class="token class-name">TriggerOperation</span><span class="token punctuation">.</span>BEFORE_DELETE<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="        }"><span class="lineCounter-0-0-15">13</span>        <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="        @testVisible protected override void afterInsert(List<SObject> newRecords, Map<Id, SObject> newRecordsMap) {"><span class="lineCounter-0-0-15">14</span>        <span class="token annotation punctuation">@testVisible</span> <span class="token keyword">protected</span> override <span class="token keyword">void</span> <span class="token function">afterInsert</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> newRecords<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Id</span><span class="token punctuation">,</span> <span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> newRecordsMap<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="            this.Method = TriggerOperation.AFTER_INSERT;"><span class="lineCounter-0-0-15 prim">15</span>            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token class-name">Method</span> <span class="token operator">=</span> <span class="token class-name">TriggerOperation</span><span class="token punctuation">.</span>AFTER_INSERT<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="        }"><span class="lineCounter-0-0-15">16</span>        <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="        @testVisible protected override void afterUpdate(List<SObject> updatedRecords, Map<Id, SObject> updatedRecordsMap, List<SObject> oldRecords, Map<Id, SObject> oldRecordsMap) {"><span class="lineCounter-0-0-15">17</span>        <span class="token annotation punctuation">@testVisible</span> <span class="token keyword">protected</span> override <span class="token keyword">void</span> <span class="token function">afterUpdate</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> updatedRecords<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Id</span><span class="token punctuation">,</span> <span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> updatedRecordsMap<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> oldRecords<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Id</span><span class="token punctuation">,</span> <span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> oldRecordsMap<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="            this.Method = TriggerOperation.AFTER_UPDATE;"><span class="lineCounter-0-0-15">18</span>            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token class-name">Method</span> <span class="token operator">=</span> <span class="token class-name">TriggerOperation</span><span class="token punctuation">.</span>AFTER_UPDATE<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="        }"><span class="lineCounter-0-0-15">19</span>        <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="        @testVisible protected override void afterDelete(List<SObject> deletedRecords, Map<Id, SObject> deletedRecordsMap) {"><span class="lineCounter-0-0-15 prim">20</span>        <span class="token annotation punctuation">@testVisible</span> <span class="token keyword">protected</span> override <span class="token keyword">void</span> <span class="token function">afterDelete</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> deletedRecords<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Id</span><span class="token punctuation">,</span> <span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> deletedRecordsMap<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="            this.Method = TriggerOperation.AFTER_DELETE;"><span class="lineCounter-0-0-15">21</span>            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token class-name">Method</span> <span class="token operator">=</span> <span class="token class-name">TriggerOperation</span><span class="token punctuation">.</span>AFTER_DELETE<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="        }"><span class="lineCounter-0-0-15">22</span>        <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="        @testVisible protected override void afterUndelete(List<SObject> undeletedRecords, Map<Id, SObject> undeletedRecordsMap) {"><span class="lineCounter-0-0-15">23</span>        <span class="token annotation punctuation">@testVisible</span> <span class="token keyword">protected</span> override <span class="token keyword">void</span> <span class="token function">afterUndelete</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> undeletedRecords<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Id</span><span class="token punctuation">,</span> <span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> undeletedRecordsMap<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="            this.Method = TriggerOperation.AFTER_UNDELETE;"><span class="lineCounter-0-0-15">24</span>            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token class-name">Method</span> <span class="token operator">=</span> <span class="token class-name">TriggerOperation</span><span class="token punctuation">.</span>AFTER_UNDELETE<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="        }"><span class="lineCounter-0-0-15 prim">25</span>        <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="    }"><span class="lineCounter-0-0-15">26</span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">27</span></div><br><div class="line-0-0-16 " data-content="    @isTest"><span class="lineCounter-0-0-15">28</span>    <span class="token annotation punctuation">@isTest</span></div><br><div class="line-0-0-16 " data-content="    static void it_should_perform_before_insert() {"><span class="lineCounter-0-0-15">29</span>    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">it_should_perform_before_insert</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="        TestTriggerHandler testHandler = new TestTriggerHandler();"><span class="lineCounter-0-0-15 prim">30</span>        <span class="token class-name">TestTriggerHandler</span> testHandler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TestTriggerHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="        TriggerHandler withExposedMethods = (TriggerHandler)testHandler;"><span class="lineCounter-0-0-15">31</span>        <span class="token class-name">TriggerHandler</span> withExposedMethods <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">TriggerHandler</span><span class="token punctuation">)</span>testHandler<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">32</span></div><br><div class="line-0-0-16 " data-content="        withExposedMethods.beforeInsert(null);"><span class="lineCounter-0-0-15">33</span>        withExposedMethods<span class="token punctuation">.</span><span class="token function">beforeInsert</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">34</span></div><br><div class="line-0-0-16 " data-content="        System.assertEquals(TriggerOperation.BEFORE_INSERT, testHandler.Method);"><span class="lineCounter-0-0-15 prim">35</span>        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token class-name">TriggerOperation</span><span class="token punctuation">.</span>BEFORE_INSERT<span class="token punctuation">,</span> testHandler<span class="token punctuation">.</span><span class="token class-name">Method</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    }"><span class="lineCounter-0-0-15">36</span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">37</span></div><br><div class="line-0-0-16 " data-content="    @isTest"><span class="lineCounter-0-0-15">38</span>    <span class="token annotation punctuation">@isTest</span></div><br><div class="line-0-0-16 " data-content="    static void it_should_perform_before_update() {"><span class="lineCounter-0-0-15">39</span>    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">it_should_perform_before_update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="        TestTriggerHandler testHandler = new TestTriggerHandler();"><span class="lineCounter-0-0-15 prim">40</span>        <span class="token class-name">TestTriggerHandler</span> testHandler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TestTriggerHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="        TriggerHandler withExposedMethods = (TriggerHandler)testHandler;"><span class="lineCounter-0-0-15">41</span>        <span class="token class-name">TriggerHandler</span> withExposedMethods <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">TriggerHandler</span><span class="token punctuation">)</span>testHandler<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">42</span></div><br><div class="line-0-0-16 " data-content="        withExposedMethods.beforeUpdate(null, null, null, null);"><span class="lineCounter-0-0-15">43</span>        withExposedMethods<span class="token punctuation">.</span><span class="token function">beforeUpdate</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">44</span></div><br><div class="line-0-0-16 " data-content="        System.assertEquals(TriggerOperation.BEFORE_UPDATE, testHandler.Method);"><span class="lineCounter-0-0-15 prim">45</span>        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token class-name">TriggerOperation</span><span class="token punctuation">.</span>BEFORE_UPDATE<span class="token punctuation">,</span> testHandler<span class="token punctuation">.</span><span class="token class-name">Method</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    }"><span class="lineCounter-0-0-15">46</span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">47</span></div><br><div class="line-0-0-16 " data-content="    @isTest"><span class="lineCounter-0-0-15">48</span>    <span class="token annotation punctuation">@isTest</span></div><br><div class="line-0-0-16 " data-content="    static void it_should_perform_before_delete() {"><span class="lineCounter-0-0-15">49</span>    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">it_should_perform_before_delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="        TestTriggerHandler testHandler = new TestTriggerHandler();"><span class="lineCounter-0-0-15 prim">50</span>        <span class="token class-name">TestTriggerHandler</span> testHandler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TestTriggerHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="        TriggerHandler withExposedMethods = (TriggerHandler)testHandler;"><span class="lineCounter-0-0-15">51</span>        <span class="token class-name">TriggerHandler</span> withExposedMethods <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">TriggerHandler</span><span class="token punctuation">)</span>testHandler<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">52</span></div><br><div class="line-0-0-16 " data-content="        withExposedMethods.beforeDelete(null, null);"><span class="lineCounter-0-0-15">53</span>        withExposedMethods<span class="token punctuation">.</span><span class="token function">beforeDelete</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">54</span></div><br><div class="line-0-0-16 " data-content="        System.assertEquals(TriggerOperation.BEFORE_DELETE, testHandler.Method);"><span class="lineCounter-0-0-15 prim">55</span>        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token class-name">TriggerOperation</span><span class="token punctuation">.</span>BEFORE_DELETE<span class="token punctuation">,</span> testHandler<span class="token punctuation">.</span><span class="token class-name">Method</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    }"><span class="lineCounter-0-0-15">56</span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">57</span></div><br><div class="line-0-0-16 " data-content="    @isTest"><span class="lineCounter-0-0-15">58</span>    <span class="token annotation punctuation">@isTest</span></div><br><div class="line-0-0-16 " data-content="    static void it_should_perform_after_insert() {"><span class="lineCounter-0-0-15">59</span>    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">it_should_perform_after_insert</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="        TestTriggerHandler testHandler = new TestTriggerHandler();"><span class="lineCounter-0-0-15 prim">60</span>        <span class="token class-name">TestTriggerHandler</span> testHandler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TestTriggerHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="        TriggerHandler withExposedMethods = (TriggerHandler)testHandler;"><span class="lineCounter-0-0-15">61</span>        <span class="token class-name">TriggerHandler</span> withExposedMethods <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">TriggerHandler</span><span class="token punctuation">)</span>testHandler<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">62</span></div><br><div class="line-0-0-16 " data-content="        withExposedMethods.afterInsert(null, null);"><span class="lineCounter-0-0-15">63</span>        withExposedMethods<span class="token punctuation">.</span><span class="token function">afterInsert</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">64</span></div><br><div class="line-0-0-16 " data-content="        System.assertEquals(TriggerOperation.AFTER_INSERT, testHandler.Method);"><span class="lineCounter-0-0-15 prim">65</span>        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token class-name">TriggerOperation</span><span class="token punctuation">.</span>AFTER_INSERT<span class="token punctuation">,</span> testHandler<span class="token punctuation">.</span><span class="token class-name">Method</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    }"><span class="lineCounter-0-0-15">66</span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">67</span></div><br><div class="line-0-0-16 " data-content="    @isTest"><span class="lineCounter-0-0-15">68</span>    <span class="token annotation punctuation">@isTest</span></div><br><div class="line-0-0-16 " data-content="    static void it_should_perform_after_update() {"><span class="lineCounter-0-0-15">69</span>    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">it_should_perform_after_update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="        TestTriggerHandler testHandler = new TestTriggerHandler();"><span class="lineCounter-0-0-15 prim">70</span>        <span class="token class-name">TestTriggerHandler</span> testHandler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TestTriggerHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="        TriggerHandler withExposedMethods = (TriggerHandler)testHandler;"><span class="lineCounter-0-0-15">71</span>        <span class="token class-name">TriggerHandler</span> withExposedMethods <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">TriggerHandler</span><span class="token punctuation">)</span>testHandler<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">72</span></div><br><div class="line-0-0-16 " data-content="        withExposedMethods.afterUpdate(null, null, null, null);"><span class="lineCounter-0-0-15">73</span>        withExposedMethods<span class="token punctuation">.</span><span class="token function">afterUpdate</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">74</span></div><br><div class="line-0-0-16 " data-content="        System.assertEquals(TriggerOperation.AFTER_UPDATE, testHandler.Method);"><span class="lineCounter-0-0-15 prim">75</span>        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token class-name">TriggerOperation</span><span class="token punctuation">.</span>AFTER_UPDATE<span class="token punctuation">,</span> testHandler<span class="token punctuation">.</span><span class="token class-name">Method</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    }"><span class="lineCounter-0-0-15">76</span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">77</span></div><br><div class="line-0-0-16 " data-content="    @isTest"><span class="lineCounter-0-0-15">78</span>    <span class="token annotation punctuation">@isTest</span></div><br><div class="line-0-0-16 " data-content="    static void it_should_perform_after_delete() {"><span class="lineCounter-0-0-15">79</span>    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">it_should_perform_after_delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="        TestTriggerHandler testHandler = new TestTriggerHandler();"><span class="lineCounter-0-0-15 prim">80</span>        <span class="token class-name">TestTriggerHandler</span> testHandler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TestTriggerHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="        TriggerHandler withExposedMethods = (TriggerHandler)testHandler;"><span class="lineCounter-0-0-15">81</span>        <span class="token class-name">TriggerHandler</span> withExposedMethods <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">TriggerHandler</span><span class="token punctuation">)</span>testHandler<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">82</span></div><br><div class="line-0-0-16 " data-content="        withExposedMethods.afterDelete(null, null);"><span class="lineCounter-0-0-15">83</span>        withExposedMethods<span class="token punctuation">.</span><span class="token function">afterDelete</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">84</span></div><br><div class="line-0-0-16 " data-content="        System.assertEquals(TriggerOperation.AFTER_DELETE, testHandler.Method);"><span class="lineCounter-0-0-15 prim">85</span>        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token class-name">TriggerOperation</span><span class="token punctuation">.</span>AFTER_DELETE<span class="token punctuation">,</span> testHandler<span class="token punctuation">.</span><span class="token class-name">Method</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    }"><span class="lineCounter-0-0-15">86</span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">87</span></div><br><div class="line-0-0-16 " data-content="    @isTest"><span class="lineCounter-0-0-15">88</span>    <span class="token annotation punctuation">@isTest</span></div><br><div class="line-0-0-16 " data-content="    static void it_should_perform_after_undelete() {"><span class="lineCounter-0-0-15">89</span>    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">it_should_perform_after_undelete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="        TestTriggerHandler testHandler = new TestTriggerHandler();"><span class="lineCounter-0-0-15 prim">90</span>        <span class="token class-name">TestTriggerHandler</span> testHandler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TestTriggerHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="        TriggerHandler withExposedMethods = (TriggerHandler)testHandler;"><span class="lineCounter-0-0-15">91</span>        <span class="token class-name">TriggerHandler</span> withExposedMethods <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">TriggerHandler</span><span class="token punctuation">)</span>testHandler<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">92</span></div><br><div class="line-0-0-16 " data-content="        withExposedMethods.afterUndelete(null, null);"><span class="lineCounter-0-0-15">93</span>        withExposedMethods<span class="token punctuation">.</span><span class="token function">afterUndelete</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">94</span></div><br><div class="line-0-0-16 " data-content="        System.assertEquals(TriggerOperation.AFTER_UNDELETE, testHandler.Method);"><span class="lineCounter-0-0-15 prim">95</span>        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token class-name">TriggerOperation</span><span class="token punctuation">.</span>AFTER_UNDELETE<span class="token punctuation">,</span> testHandler<span class="token punctuation">.</span><span class="token class-name">Method</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    }"><span class="lineCounter-0-0-15">96</span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="}"><span class="lineCounter-0-0-15 prim">97</span><span class="token punctuation">}</span></div><br></code></pre><h2 id="syntax-sugar" class="heading-0-0-12"><span class="anchor-0-0-13" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Syntax Sugar</h2><p>Lastly, I'll just say that I've only ever found one set of helper methods necessary in the TriggerHandler pattern -- it's fairly common to need to get records with changed fields when performing logic within the Handler classes that end up extending the TriggerHandler. You could add the following one/two methods (one if you only wanted to use the bulk <code>List&lt;SObjectField&gt;</code> option) to do yourself a favor:</p><pre class=""><code class="java code-0-0-14" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16 " data-content="//in TriggerHandler.cls"><span class="lineCounter-0-0-15 prim">1</span><span class="token comment">//in TriggerHandler.cls</span></div><br><div class="line-0-0-16 " data-content="protected List<SObject> getUpdatedRecordsWithChangedField(SObjectField field) {"><span class="lineCounter-0-0-15">2</span><span class="token keyword">protected</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> <span class="token function">getUpdatedRecordsWithChangedField</span><span class="token punctuation">(</span><span class="token class-name">SObjectField</span> field<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    return this.getUpdatedRecordsWithChangedFields(new List<SObjectField>{ field });"><span class="lineCounter-0-0-15">3</span>    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getUpdatedRecordsWithChangedFields</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SObjectField</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span> field <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="}"><span class="lineCounter-0-0-15">4</span><span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15 prim">5</span></div><br><div class="line-0-0-16 " data-content="protected List<SObject> getUpdatedRecordsWithChangedFields(List<SObjectField> fields) {"><span class="lineCounter-0-0-15">6</span><span class="token keyword">protected</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> <span class="token function">getUpdatedRecordsWithChangedFields</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SObjectField</span><span class="token punctuation">&gt;</span></span> fields<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    List<SObject> updatedRecords = new List<SObject>();"><span class="lineCounter-0-0-15">7</span>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> updatedRecords <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">8</span></div><br><div class="line-0-0-16 " data-content="    for(SObject record : Trigger.new) {"><span class="lineCounter-0-0-15">9</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">SObject</span> <span class="token keyword">record</span> <span class="token operator">:</span> <span class="token class-name">Trigger</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="        SObject oldRecord = Trigger.oldMap.get(record.Id);"><span class="lineCounter-0-0-15 prim">10</span>        <span class="token class-name">SObject</span> oldRecord <span class="token operator">=</span> <span class="token class-name">Trigger</span><span class="token punctuation">.</span>oldMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">record</span><span class="token punctuation">.</span><span class="token class-name">Id</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="        for(SObjectField field : fields) {"><span class="lineCounter-0-0-15">11</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">SObjectField</span> field <span class="token operator">:</span> fields<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="            if(record.get(field) != oldRecord.get(field)) {"><span class="lineCounter-0-0-15">12</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">record</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>field<span class="token punctuation">)</span> <span class="token operator">!=</span> oldRecord<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>field<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="                updatedRecords.add(record);"><span class="lineCounter-0-0-15">13</span>                updatedRecords<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">record</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="            }"><span class="lineCounter-0-0-15">14</span>            <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="        }"><span class="lineCounter-0-0-15 prim">15</span>        <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="    }"><span class="lineCounter-0-0-15">16</span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="    return updatedRecords;"><span class="lineCounter-0-0-15">17</span>    <span class="token keyword">return</span> updatedRecords<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="}"><span class="lineCounter-0-0-15 prim">18</span><span class="token punctuation">}</span></div><br></code></pre><h2 id="wrapping-up" class="heading-0-0-12"><span class="anchor-0-0-13" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Wrapping Up</h2><p>That's it! It's a short one, but I hope you enjoyed this post. The aforementioned <a href="/joys-of-apex/writing-performant-apex-tests">Writing Performant Apex Tests</a> article has also now been published.</p><p>As well, on the subject of filtering records that have changed based on <code>SObjectField</code> criteria, as shown in the above helper methods, I have since also written a post on <a href="/joys-of-apex/lazy-iterators">the power of Lazy Iteration</a> which should prove eye-opening when considering how to keep your <code>TriggerHandler</code> classes performant in the context of having to assemble many sub-lists of changed SObjects based on different <code>SObjectField</code> criteria. The <code>getUpdatedRecordsWithChangedFields</code> method shown above is a typically-eager implementation, and all of the records being passed to the Trigger get iterated through each time the method is called; if you need to accomplish separate processing for records with different changed fields, you'll quickly waste processing cycles doing so. Lazily implemented iteration prevents this performance slowdown - I'd highly recommend reading the article for more information about this very powerful pattern!</p><div class="contentnav-0-0-7" data-no-search=""><a href="#implementing-the-simplest-possible-trigger-handler" class="h2" data-content-highlight="implementing-the-simplest-possible-trigger-handler">Implementing The Simplest Possible Trigger Handler</a><a href="#syntax-sugar" class="h2" data-content-highlight="syntax-sugar">Syntax Sugar</a><a href="#wrapping-up" class="h2" data-content-highlight="wrapping-up">Wrapping Up</a></div></div><div id="-codedoc-toc" class="toc-0-0-4"><div class="content-0-0-5"><p><a href="/joys-of-apex/">Home</a>
<a href="/joys-of-apex/apex-logging-service">Apex Logging Service</a>
<a href="/joys-of-apex/apex-object-oriented-basics">Apex Object-Oriented Basics</a>
<a href="/joys-of-apex/batchable-and-queueable-apex">Batchable And Queueable Apex</a>
<a href="/joys-of-apex/building-a-better-singleton">Building A Better Singleton</a>
<a href="/joys-of-apex/continuous-integration-with-sfdx">Continuous Integration With SFDX</a>
<a href="/joys-of-apex/dependency-injection-factory-pattern">Dependency Injection &amp; Factory Pattern</a>
<a href="/joys-of-apex/enum-apex-class-gotchas">Enum Apex Class Gotchas</a>
<a href="/joys-of-apex/extendable-apis">Extendable Apis</a>
<a href="/joys-of-apex/future-method-callout-callback">Future Methods, Callouts &amp; Callbacks</a>
<a href="/joys-of-apex/idiomatic-salesforce-apex">Idiomatic Salesforce Apex</a>
<a href="/joys-of-apex/intro">Introduction &amp; Testing Philosophy</a>
<a href="/joys-of-apex/lazy-iterators">Lazy Iterators</a>
<a href="/joys-of-apex/lightweight-trigger-handler">Lightweight Trigger Handler</a>
<a href="/joys-of-apex/lwc-composable-modal">LWC Composable Modal</a>
<a href="/joys-of-apex/lwc-composable-pagination">LWC Composable Pagination</a>
<a href="/joys-of-apex/mocking-dml">Mocking DML</a>
<a href="/joys-of-apex/react-versus-lightning-web-components">React Versus Lightning Web Components</a>
<a href="/joys-of-apex/repository-pattern">Repository Pattern</a>
<a href="/joys-of-apex/sorting-and-performance-in-apex">Sorting And Performance In Apex</a>
<a href="/joys-of-apex/test-driven-development-example">Test Driven Development Example</a>
<a href="/joys-of-apex/writing-performant-apex-tests">Writing Performant Apex Tests</a></p><p><br><br></p><p><a href="https://www.jamessimone.net/">Read more tech articles</a></p></div></div><div class="footer-0-0-3"><div class="left"><script id="hdTkgQjYwc">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("hdTkgQjYwc", "BWW0vHR4333HbDOiwZ67JA==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script></div><div class="main"><div class="inside"></div></div><div class="right"><script id="eeDcWuM_uP">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("eeDcWuM_uP", "6yEdMfRRlNsUBKSBOTazFg==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script></div></div><script id="iRRxXhwnGr">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("iRRxXhwnGr", "wh9V9isakhdwzlz9ZUjvyw==", {"namespace":"/joys-of-apex"});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script></body></html>