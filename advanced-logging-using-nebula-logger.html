<!DOCTYPE html><html><head><title>Joys Of Apex | Advanced Logging Using Nebula Logger</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><meta name="robots" content="index,follow"><meta name="theme-color" content="#212121"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><link rel="shortcut icon" href="/joys-of-apex/favicon.ico"><link href="https://fonts.googleapis.com/css?family=Hind:400,700&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:300,400&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/icon?family=Material+Icons%7CMaterial+Icons+Outlined&amp;display=swap" rel="stylesheet"><style>
      body, input, button {
        font-family: 'Hind', sans-serif;
      }

      code, .hljs {
        font-family: 'Source Code Pro', 'Courier New', Courier, monospace;
      }

      .icon-font {
        font-family: 'Material Icons';
        font-weight: normal;
        font-style: normal;
        font-size: 24px;  /* Preferred icon size */
        display: inline-block;
        line-height: 1;
        text-transform: none;
        letter-spacing: normal;
        word-wrap: normal;
        white-space: nowrap;
        direction: ltr;
      
        /* Support for all WebKit browsers. */
        -webkit-font-smoothing: antialiased;
        /* Support for Safari and Chrome. */
        text-rendering: optimizeLegibility;
      
        /* Support for Firefox. */
        -moz-osx-font-smoothing: grayscale;
      
        /* Support for IE. */
        font-feature-settings: 'liga';
      }

      .icon-font.outline {
        font-family: 'Material Icons Outlined';
      }
    </style><link href="/joys-of-apex/styles/codedoc-styles.css" rel="stylesheet"><script async="" defer="" src="/joys-of-apex/bundle/codedoc-bundle.js"></script><meta property="og:image" content="./img/joys-of-apex-thumbnail.png"><script>window.githubConfig={"repo":"james-coding-blog","user":"jamessimone"}</script><style>.container{padding-top: 0 !important}</style><style>#-codedoc-toc { backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px) }</style><meta name="twitter:title" content="Joys Of Apex | Advanced Logging Using Nebula Logger"><meta property="og:type" content="article"><meta property="og:title" content="Joys Of Apex | Advanced Logging Using Nebula Logger"><meta name="keywords" content=""><meta property="blog-tags" content=""></head><body><header style="margin-left: 1rem">Read more at <a href="https://wwww.jamessimone.net">jamessimone.net</a>, or return to the <a href="/joys-of-apex/">homepage</a></header><div id="-codedoc-container" class="container"><script>window.source = {"base":"posts","path":"advanced-logging-using-nebula-logger.md","namespace":"/joys-of-apex","title":{"base":"Joys Of Apex","connector":" | "}}</script><div class="hero-0-0-8" style="margin-bottom: -156px"><img src="/joys-of-apex/img/the-joys-of-apex.png" class="image-0-0-9" data-hero=""><span class="caption-0-0-10"></span></div><marker><br>
<br>
<br>
<br>
<br>

</marker><h1 class="h-0-0-11 "><span style="color: green; 
      text-shadow: none; 
      font-size: 48px"><p>Advanced Logging Using Nebula Logger</p></span></h1><script id="JoLTRxIwFn">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("JoLTRxIwFn", "kRzsgnV+B7EQTskbovy+YA==", {"src":"github","date":"2021-03-08T15:12:03.284Z"});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script><div hidden="" data-ignore-text="" data-meta-override-property="og:image"><p>./img/joys-of-apex-thumbnail.png</p></div><p><em>Today's post is a guest post by <a href="https://www.linkedin.com/in/jongpie/">Jonathan Gillespie</a> -- a good friend of mine, and our first guest author! I'm really excited to have him here to talk about <a href="https://github.com/jongpie/NebulaLogger">Nebula Logger</a>. While it's a project that I've contributed to, it's Jonathan's brain child, and there's nobody more qualified when it comes to the subject of logging within the Salesforce platform. I'll include a little more on our shared story <a href="#postscript">in the postscript</a> -- enjoy!</em></p><p><strong>Jonathan</strong>: I've enjoyed working with the Salesforce platform for nearly a decade - over this time Salesforce has implemented countless new features that have really improved the platform both for Salesforce implementation experts (admins, developers, architects and more) as well as for Salesforce users. But we all know that no system is without issue - every system has bugs, every project has missed requirements &amp; scenarios, and we need to be able to easily answer some questions about our Salesforce orgs:</p><ul><li>What's happening in my Salesforce orgs?</li><li>Are we experiencing any errors?</li><li>In what environment did the error happen?</li><li>Who was the logged-in user?</li><li>What record was being created/updated when it happened?</li><li>Are we being proactive about fixing the issue?</li><li>Did our scheduled batch job finish?</li></ul><p>Despite Salesforce's releases over the years, I still find myself struggling to answer some of these questions using only features provided out of the box. The inspiration for what would become Nebula Logger was born. But first...</p><h2 id="what-logging-does-salesforce-provide" class="heading-0-0-12"><span class="anchor-0-0-13" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>What Logging Does Salesforce Provide</h2><p>Salesforce does <a href="https://trailhead.salesforce.com/en/content/learn/modules/developer_console/developer_console_logs">provide some basic logging functionality</a> out-of-the-box for both Apex and Flow. However, it has some major limitations</p><ul><li>You must enable logs for each user ðŸ¡ª limit of 24 hours max</li><li>Debug logs can be truncated</li><li>Salesforce auto-purges old logs</li><li>Each debug log must be 20 MB or smaller</li><li>System debug logs are retained for 24 hours. Debug logs are retained for 7days.</li><li>In Flow, admins/devs cannot add any equivalent to a 'debug statement' to help with their troubleshooting</li><li>Reporting &amp; monitoring of logs is very limited. Paid add-ons (like Salesforce Shield) or 3rd party tools are typically needed for more details reporting &amp; monitoring.</li></ul><p>These limits can make it difficult to rely on Salesforce's logging to troubleshoot issues, especially if it's an inconsistent issue, or the user does not know how to recreate the issue.</p><h2 id="introducing-nebula-logger" class="heading-0-0-12"><span class="anchor-0-0-13" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Introducing Nebula Logger</h2><p>Several years ago, I found myself struggling with some of these major limitations of the logging &amp; debug tools provided by Salesforce. I explored other options on AppExchange and elsewhere, but ultimately decided to just start working on my own project - Nebula Logger. It's an open source project that I've tinkered with for years (along with the help of none other than James Simone himself) to try to solve several logging challenges when working with the Salesforce platform.</p><p>Nebula Logger is an ever-evolving attempt at building a logging tool that helps to answer these questions (and more) for Salesforce implementations. The current version of Nebula Logger, v4.0.0, has 10 core features designed to work natively on the Salesforce platform (available as a managed package and unpackage code)</p><p><img src="./img/nebula-logger-architecture.png" alt="Nebula Logger Overview"></p><h2 id="feature-1-use-salesforce-features-to-manage-logs" class="heading-0-0-12"><span class="anchor-0-0-13" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Feature #1: Use Salesforce Features to Manage Logs</h2><p>When I first started working on Nebula Logger, I had already been implementing Salesforce for a few years - and I was frustrated not only that Salesforce's logging was limited, but also by the fact that Salesforce provides so much functionality for other projects, but I couldn't use it (natively) to manage logs. I set out to create a logging tool that would let me leverage Salesforce itself to manage logs, and quickly realized that "simply" storing data in custom objects would open up the possibilities of using several features, including</p><ul><li>Create Salesforce reports &amp; dashboards for monitoring logs</li><li>Leverage list views and App Builder for navigating &amp; viewing logs</li><li>Assign important logs to users &amp; queues</li><li>Use Chatter for collaborating on logs</li></ul><p>This gave me the first custom object &amp; project goal: use a <code>LogEntry__c</code> custom object to store log data.</p><p><img src="./img/data-model-logentry.png" alt="LogEntry__c custom object"></p><h2 id="feature-2-log-and-throw-exceptions" class="heading-0-0-12"><span class="anchor-0-0-13" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Feature #2: Log AND Throw Exceptions</h2><p>One of the most basic (if not the most critical) reasons that you might want to log something in any system: an error occurred, and we want to know about it. Seems pretty basic, but for years, you could not (easily) accomplish this within Salesforce.</p><ul><li><p><strong>Prior to the Summer '17 release</strong>: there was a major architectural limitation that made a true custom logging system nearly impossible - any error in Salesforce (declarative errors, throwing Apex exceptions, etc.) would cause all DML statements in the current transaction to roll back. This meant that you couldn't log an error AND throw an exception. There were a few ways to work around this limitation, but none of them were ideal and did not work in all situations.</p><pre class=""><code class="java -codedoc-code-snippet code-0-0-14" tabindex="0"><span class="wmbar-0-0-19"><span></span><span></span><span></span><span></span></span><div class="line-0-0-18  -codedoc-code-line" data-content=" try {" id="code1-l1"><span class="lineCounter-0-0-15 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span> <span class="token keyword">try</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="     update someRecord;" id="code1-l2"><span class="lineCounter-0-0-15 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>     update someRecord<span class="token punctuation">;</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content=" } catch(Exception apexException) {" id="code1-l3"><span class="lineCounter-0-0-15 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span> <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> apexException<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="     // Simple example of catching an error &amp; trying to log it" id="code1-l4"><span class="lineCounter-0-0-15 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>     <span class="token comment">// Simple example of catching an error &amp; trying to log it</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="     // before Platform Events (using a custom object)" id="code1-l5"><span class="lineCounter-0-0-15 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>     <span class="token comment">// before Platform Events (using a custom object)</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="     insert new LogEntry__c(" id="code1-l6"><span class="lineCounter-0-0-15 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>     insert <span class="token keyword">new</span> <span class="token class-name">LogEntry__c</span><span class="token punctuation">(</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="         ErrorMessage__c = apexException.getMessage()" id="code1-l7"><span class="lineCounter-0-0-15 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>         <span class="token class-name">ErrorMessage__c</span> <span class="token operator">=</span> apexException<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="     );" id="code1-l8"><span class="lineCounter-0-0-15 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>     <span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="" id="code1-l9"><span class="lineCounter-0-0-15 -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="     // After inserting  a log entry (or any SObject record)..." id="code1-l10"><span class="lineCounter-0-0-15 prim -codedoc-line-counter">10<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>     <span class="token comment">// After inserting  a log entry (or any SObject record)...</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="     //... throwing this exception would still automatically rollback the insert operation" id="code1-l11"><span class="lineCounter-0-0-15 -codedoc-line-counter">11<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>     <span class="token comment">//... throwing this exception would still automatically rollback the insert operation</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="     throw apexException;" id="code1-l12"><span class="lineCounter-0-0-15 -codedoc-line-counter">12<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>     <span class="token keyword">throw</span> apexException<span class="token punctuation">;</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content=" }" id="code1-l13"><span class="lineCounter-0-0-15 prim -codedoc-line-counter">13<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span> <span class="token punctuation">}</span></div><br></code></pre></li><li><p><strong>Spring '17 - Platform Events</strong> - But in Spring '17, Salesforce <a href="https://help.salesforce.com/articleView?id=release-notes.rn_api_messaging.htm&amp;type=5&amp;release=208">released Platform Events</a>, a new type of object that uses event-driven architecture to publish &amp; subscribe to certain 'events' within the system. In my opinion, this is when a true logging system finally became feasible; using Platform Events, we can now create event records that are always generated, even if an exception occurs.</p><pre class=""><code class="java -codedoc-code-snippet code-0-0-14" tabindex="0"><span class="wmbar-0-0-19"><span></span><span></span><span></span><span></span></span><div class="line-0-0-18  -codedoc-code-line" data-content=" try {" id="code2-l1"><span class="lineCounter-0-0-15 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span> <span class="token keyword">try</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="     update someRecord;" id="code2-l2"><span class="lineCounter-0-0-15 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>     update someRecord<span class="token punctuation">;</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content=" } catch(Exception apexException) {" id="code2-l3"><span class="lineCounter-0-0-15 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span> <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> apexException<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="     // Using Platform Events &amp; the EventBus class, we can publish events even if an exception is thrown" id="code2-l4"><span class="lineCounter-0-0-15 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>     <span class="token comment">// Using Platform Events &amp; the EventBus class, we can publish events even if an exception is thrown</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="     EventBus.publish(new LogEntryEvent__e(" id="code2-l5"><span class="lineCounter-0-0-15 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>     <span class="token class-name">EventBus</span><span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LogEntryEvent__e</span><span class="token punctuation">(</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="         ErrorMessage__c = apexException.getMessage()" id="code2-l6"><span class="lineCounter-0-0-15 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>         <span class="token class-name">ErrorMessage__c</span> <span class="token operator">=</span> apexException<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="     ));" id="code2-l7"><span class="lineCounter-0-0-15 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>     <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="" id="code2-l8"><span class="lineCounter-0-0-15 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="     // Publishing a log entry event (or any Platform Event that uses the 'Publish Immediately' behavior)" id="code2-l9"><span class="lineCounter-0-0-15 -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>     <span class="token comment">// Publishing a log entry event (or any Platform Event that uses the 'Publish Immediately' behavior)</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="     //... will still occur, even if an exception is thrown after the EventBus is called" id="code2-l10"><span class="lineCounter-0-0-15 prim -codedoc-line-counter">10<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>     <span class="token comment">//... will still occur, even if an exception is thrown after the EventBus is called</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="     throw apexException;" id="code2-l11"><span class="lineCounter-0-0-15 -codedoc-line-counter">11<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>     <span class="token keyword">throw</span> apexException<span class="token punctuation">;</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content=" }" id="code2-l12"><span class="lineCounter-0-0-15 prim -codedoc-line-counter">12<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span> <span class="token punctuation">}</span></div><br></code></pre></li></ul><p>Platform Events are now the go-to option for handling logging in Salesforce - Nebula Logger uses a platform event object called <code>LogEntryEvent__e</code> to ensure that log entries are published, even if an error occurs.</p><p><img src="./img/data-model-logentryevent-and-logentry.png" alt="LogEntryEvent__e and LogEntry__c"></p><p><strong>Note from James</strong> -- because for so many years it was impossible to achieve true logging within Salesforce since exceptions couldn't be logged to a custom object, and because many companies use a variety of applications in addition to Salesforce, it's still not unheard of to export Salesforce error logs to a centralized database for logging exceptions (be it some localized Kibana stack, or a 3rd party solution like Rollbar). You can find more info about these approaches in the <a href="/joys-of-apex/apex-logging-service">Apex Logging Service</a> article. Perhaps I'll have to twist Jonathan's arm into supporting also sending the contents of logs to an external system as part of Nebula ðŸ˜‡!</p><h2 id="feature-3-unified-log-with-a-unique-transaction-id" class="heading-0-0-12"><span class="anchor-0-0-13" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Feature #3: Unified Log with a Unique Transaction ID</h2><p>Not only do we want to log data, but we want to see all related log entries together - any entries created during the same transaction should be related together. To accomplish this, we need a unique ID for the transaction so we can relate multiple 'log entries' to a single 'log' record for a unified logging record. This sounds like another feature that <em>should</em> be easy, but until recently, it was another major gap in the platform.</p><ul><li><strong>Prior to Winter '21</strong>: no king of transaction ID was provided. Presumably, Salesforce had a way to internally see a transaction ID, but there was no way for us to see or leverage it in Apex or Flow. Prior to Winter '21, my best solution was not an easy solution - I (tried to) port <a href="https://en.wikipedia.org/wiki/Universally_unique_identifier">the UUID v4</a> standard <a href="https://github.com/jongpie/ApexUuid/">to Apex</a> just so I could easily create a unique ID during an Apex transaction (Apex still lacks the native ability to create a UUID/GUID).</li><li><strong>Winter '21 - Quiddity</strong>: In the <a href="https://help.salesforce.com/articleView?id=release-notes.rn_apex_Runtime_Detection.htm&amp;type=5&amp;release=228">Winter '21 release</a>, Salesforce finally added a way in Apex to see a unique transaction ID, as well as other details about the current transaction, such as the request type (available through <a href="https://developer.salesforce.com/docs/atlas.en-us.apexcode.meta/apexcode/apex_class_System_Request.htm">the Request class</a>). Nebula Logger now uses Salesforce's provided Request ID as the <code>Log__c</code> records unique ID (implemented by James Simone!). More details about detecting the Apex runtime are <a href="https://help.salesforce.com/articleView?id=release-notes.rn_apex_Runtime_Detection.htm&amp;type=5&amp;release=228">available in Salesforce Help</a>.</li></ul><p>Retrieving the unique transaction ID can now be accomplished with 1 line of code.</p><pre class=""><code class="java -codedoc-code-snippet code-0-0-14" tabindex="0"><span class="wmbar-0-0-19"><span></span><span></span><span></span><span></span></span><div class="line-0-0-18  -codedoc-code-line" data-content="String uniqueTransactionId = System.Request.getCurrent().getRequestId();" id="code3-l1"><span class="lineCounter-0-0-15 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token class-name">String</span> uniqueTransactionId <span class="token operator">=</span> <span class="token class-name">System<span class="token punctuation">.</span>Request</span><span class="token punctuation">.</span><span class="token function">getCurrent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getRequestId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br></code></pre><p>With a unique ID (and external ID fields), we can expand the data model so related log entries are tied to a single log record.</p><p><img src="./img/data-model-logentryevent-log-and-logentry.png" alt="LogEntryEvent__e, Log__c and LogEntry__c"></p><h2 id="feature-4-support-all-of-salesforces-logging-levels" class="heading-0-0-12"><span class="anchor-0-0-13" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Feature #4: Support All of Salesforce's Logging Levels</h2><p>Ideally, we want to always track and know everything about our system. Realistically, logging adds overhead, and some log entries are more important than others</p><ul><li>More logging == more data storage is used</li><li>More logging == more CPU time, DML statements (and other platform limits) is used</li></ul><p>Although the specific levels aren't consistent between each language, most modern programming languages and logging tools support different logging levels. In Apex (and Nebula Logger), there are 7 supported logging levels.</p><pre class=""><code class="java -codedoc-code-snippet code-0-0-14" tabindex="0"><span class="wmbar-0-0-19"><span></span><span></span><span></span><span></span></span><div class="line-0-0-18  -codedoc-code-line" data-content="System.debug(LoggingLevel.ERROR, 'example ERROR message');" id="code4-l1"><span class="lineCounter-0-0-15 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token class-name">LoggingLevel</span><span class="token punctuation">.</span>ERROR<span class="token punctuation">,</span> <span class="token string">'example ERROR message'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="System.debug(LoggingLevel.WARN, 'example WARN message');" id="code4-l2"><span class="lineCounter-0-0-15 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token class-name">LoggingLevel</span><span class="token punctuation">.</span>WARN<span class="token punctuation">,</span> <span class="token string">'example WARN message'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="System.debug(LoggingLevel.INFO, 'example INFO message');" id="code4-l3"><span class="lineCounter-0-0-15 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token class-name">LoggingLevel</span><span class="token punctuation">.</span>INFO<span class="token punctuation">,</span> <span class="token string">'example INFO message'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="System.debug(LoggingLevel.DEBUG, 'example DEBUG message');" id="code4-l4"><span class="lineCounter-0-0-15 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token class-name">LoggingLevel</span><span class="token punctuation">.</span>DEBUG<span class="token punctuation">,</span> <span class="token string">'example DEBUG message'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="System.debug(LoggingLevel.FINE, 'example FINE message');" id="code4-l5"><span class="lineCounter-0-0-15 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token class-name">LoggingLevel</span><span class="token punctuation">.</span>FINE<span class="token punctuation">,</span> <span class="token string">'example FINE message'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="System.debug(LoggingLevel.FINER, 'example FINER message');" id="code4-l6"><span class="lineCounter-0-0-15 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token class-name">LoggingLevel</span><span class="token punctuation">.</span>FINER<span class="token punctuation">,</span> <span class="token string">'example FINER message'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="System.debug(LoggingLevel.FINEST, 'example FINEST message');" id="code4-l7"><span class="lineCounter-0-0-15 prim -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token class-name">LoggingLevel</span><span class="token punctuation">.</span>FINEST<span class="token punctuation">,</span> <span class="token string">'example FINEST message'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br></code></pre><p>I've tried various method signatures over the years for providing a way to control a log entry's level, and ultimately, level-specific methods (with several overloads) has been the most popular approach. This provides a simple way to assign importance to each log entry, based on the selected logging level method.</p><pre class=""><code class="java -codedoc-code-snippet code-0-0-14" tabindex="0"><span class="wmbar-0-0-19"><span></span><span></span><span></span><span></span></span><div class="line-0-0-18  -codedoc-code-line" data-content="Logger.error('Add log entry using Nebula Logger with logging level == ERROR');" id="code5-l1"><span class="lineCounter-0-0-15 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token class-name">Logger</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Add log entry using Nebula Logger with logging level == ERROR'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="Logger.warn('Add log entry using Nebula Logger with logging level == WARN');" id="code5-l2"><span class="lineCounter-0-0-15 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token class-name">Logger</span><span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">'Add log entry using Nebula Logger with logging level == WARN'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="Logger.info('Add log entry using Nebula Logger with logging level == INFO');" id="code5-l3"><span class="lineCounter-0-0-15 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token class-name">Logger</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">'Add log entry using Nebula Logger with logging level == INFO'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="Logger.debug('Add log entry using Nebula Logger with logging level == DEBUG');" id="code5-l4"><span class="lineCounter-0-0-15 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token class-name">Logger</span><span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">'Add log entry using Nebula Logger with logging level == DEBUG'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="Logger.fine('Add log entry using Nebula Logger with logging level == FINE');" id="code5-l5"><span class="lineCounter-0-0-15 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token class-name">Logger</span><span class="token punctuation">.</span><span class="token function">fine</span><span class="token punctuation">(</span><span class="token string">'Add log entry using Nebula Logger with logging level == FINE'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="Logger.finer('Add log entry using Nebula Logger with logging level == FINER');" id="code5-l6"><span class="lineCounter-0-0-15 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token class-name">Logger</span><span class="token punctuation">.</span><span class="token function">finer</span><span class="token punctuation">(</span><span class="token string">'Add log entry using Nebula Logger with logging level == FINER'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="Logger.finest('Add log entry using Nebula Logger with logging level == FINEST');" id="code5-l7"><span class="lineCounter-0-0-15 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token class-name">Logger</span><span class="token punctuation">.</span><span class="token function">finest</span><span class="token punctuation">(</span><span class="token string">'Add log entry using Nebula Logger with logging level == FINEST'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="Logger.saveLog();" id="code5-l8"><span class="lineCounter-0-0-15 prim -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token class-name">Logger</span><span class="token punctuation">.</span><span class="token function">saveLog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br></code></pre><p>Every project is different, so every Salesforce team will need to decide on what logging levels to use for their org's implementation. But my general guideline is:</p><ul><li>Not everything you log should <em>always</em> be logged - use levels <code>ERROR</code>, <code>WARN</code> or <code>INFO</code> for the truly important info.</li><li>For less critical entries (but entries that may still provide useful info in certain situations), I use <code>DEBUG</code>, <code>FINE</code>, <code>FINER</code> or <code>FINEST</code> logging levels.</li></ul><p>Using the custom hierarchy setting <code>LoggerSettings__c</code>, you can then control which log entries are generated &amp; saved at 3 levels: the org (i.e., the default behavior for the environment), a profile, or user. This is useful for easily scaling your logging needs. For example, if you're deploying a new feature in your org for a particular team/department, you can update the logging levels for the team (either using profile or user-level settings) to enable more granular logging. This is a great way to help monitor production orgs; once you feel confident that everything is working as expected, you can then reduce the logging level to only include more important logging levels.</p><p><img src="./img/logger-settings.png" alt="Logger Settings"></p><h2 id="feature-5-be-able-to-log-code-and-declarative-automations" class="heading-0-0-12"><span class="anchor-0-0-13" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Feature #5: Be Able to Log Code and Declarative Automations</h2><p>Although some older automations, like Workflow rules, are still in use, Salesforce is focused on Flow for declarative automations and Apex for backend coding - Nebula Logger supports adding log entries for both Apex and Flows (as well as Process Builder, since it shares some of Flow's capabilities).</p><ul><li><strong>Apex developers</strong>: log everything using the <code>Logger</code> class</li><li><strong>Flow builders (and process builder)</strong>: add log entries &amp; record-specific log entries using one of the invocable methods in <code>FlowLogEntry</code> and <code>FlowRecordLogEntry</code> classes</li></ul><p>My plan (insert safe harbor statement here) is to eventually add logging for Lightning Web &amp; Aura components.</p><h2 id="feature-6-relate-log-entries-to-any-record" class="heading-0-0-12"><span class="anchor-0-0-13" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Feature #6: Relate Log Entries to Any Record</h2><p>When logging data, you may (frequently) want to log what particular <code>SObject</code> record is being created/updated/processed - this could be any standard or custom object, so a Salesforce logging tool should be able to handle any <code>SObject</code> type.</p><p>Salesforce <em>does</em> have a feature for this type of functionality - polymorphic lookup fields, available on objects like <code>Task</code> and objects with an <code>OwnerId</code> field</p><ul><li><code>Task.WhoId</code> can be either a Lead ID or a Contact ID.</li><li><code>Task.WhatId</code> can be one of several standard objects, or any custom object with activities enabled.</li><li>Most <code>OwnerId</code> fields - like <code>Lead.OwnerId</code>, <code>Case.OwnerId</code>, <code>MyExampleObject__c.OwnerId</code> - are polymorphic fields - if you enable queues for the object, then the <code>OwnerId</code> field can be a user ID or a queue (group) ID.</li></ul><p>Just one problem: we can't create custom polymorphic fields. This has been <a href="https://trailblazer.salesforce.com/ideaView?id=08730000000BqzBAAS">an idea on Salesforce's Idea site since 2012</a>, and the status is still "Not Planned", so it doesn't seem like this will be add natively any time soon. But using external IDs, formula fields and Apex code, Nebula Logger can simulate polymorphic fields in a scalable way that works with any SObject. It also provides several overloaded methods where you can pass an <code>Id recordId</code> or <code>SObject record</code> as parameters.</p><pre class=""><code class="java -codedoc-code-snippet code-0-0-14" tabindex="0"><span class="wmbar-0-0-19"><span></span><span></span><span></span><span></span></span><div class="line-0-0-18  -codedoc-code-line" data-content="Account account = [SELECT Id, Name, AccountNumber, RecordTypeId, RecordType.Name FROM Account LIMIT 1];" id="code6-l1"><span class="lineCounter-0-0-15 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token class-name">Account</span> account <span class="token operator">=</span> <span class="token punctuation">[</span>SELECT <span class="token class-name">Id</span><span class="token punctuation">,</span> <span class="token class-name">Name</span><span class="token punctuation">,</span> <span class="token class-name">AccountNumber</span><span class="token punctuation">,</span> <span class="token class-name">RecordTypeId</span><span class="token punctuation">,</span> <span class="token class-name">RecordType<span class="token punctuation">.</span>Name</span> FROM <span class="token class-name">Account</span> LIMIT <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="Logger.info('Example of logging an SObject record', account);" id="code6-l2"><span class="lineCounter-0-0-15 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token class-name">Logger</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">'Example of logging an SObject record'</span><span class="token punctuation">,</span> account<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="Logger.fine('Example of logging a record ID', account.Id);" id="code6-l3"><span class="lineCounter-0-0-15 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token class-name">Logger</span><span class="token punctuation">.</span><span class="token function">fine</span><span class="token punctuation">(</span><span class="token string">'Example of logging a record ID'</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token namespace">account<span class="token punctuation">.</span></span>Id</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="Logger.saveLog();" id="code6-l4"><span class="lineCounter-0-0-15 prim -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token class-name">Logger</span><span class="token punctuation">.</span><span class="token function">saveLog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br></code></pre><p>Even if you log multiple SObject types, Nebula Logger will automatically track the SObject Type, record name and more.</p><p><img src="./img/log-entry-related-records.png" alt="Log Entries with Related Record"></p><h2 id="feature-7-advanced-transaction-controls-for-apex-developers" class="heading-0-0-12"><span class="anchor-0-0-13" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Feature #7: Advanced Transaction Controls for Apex Developers</h2><p>On many of my projects, I typically add logging into my project's trigger framework. This usually involves adding log entries that log details about the current trigger's SObject, and auto-saving at the end of each trigger. This helps tremendously with logging day-to-day operations when a user is simply updating a single record through the UI. But for more complex operations (such as batch jobs, data imports, etc.), the operations can be negatively impacted by the logging tool.</p><p>To help in these situations, Apex developers can use additional <code>Logger</code> methods to dynamically control how logs are saved during the current transaction.</p><ul><li><code>Logger.suspendSaving()</code> â€“ causes Logger to ignore any calls to <code>saveLog()</code> in the current transaction until <code>resumeSaving()</code> is called. Useful for reducing DML statements used by Logger</li><li><code>Logger.resumeSaving()</code> â€“ re-enables saving after <code>suspendSaving()</code> is used</li><li><code>Logger.flushBuffer()</code> â€“ discards any unsaved log entries</li><li><code>Logger.setSaveMethod(SaveMethod saveMethod)</code> - this method lets developers controls <strong>how</strong> log entries are saved.<ul><li><code>Logger.SaveMethod.EVENT_BUS</code> - The default save method, this uses the <code>EventBus</code> class to publish <code>LogEntryEvent__e</code> records.</li><li><code>Logger.SaveMethod.QUEUEABLE</code> - This save method will trigger <code>Logger</code> to save any pending records asynchronously using a queueable job. This is useful when you need to defer some CPU usage and other limits consumed by <code>Logger</code>.</li><li><code>Logger.SaveMethod.REST</code> - This save method will use the current user's session ID to make a synchronous callout to the org's REST API. This is useful when you have other callouts being made and you need to avoid mixed DML operations.</li></ul></li></ul><h2 id="feature-8-automatically-log-details-about-the-org-user-and-record" class="heading-0-0-12"><span class="anchor-0-0-13" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Feature #8: Automatically Log Details About the Org, User and Record</h2><p>Ideally, a logging tool should be easy to use, but provide a wealth of information. Nebula Logger automatically sets additional fields for all Apex and Flow logs</p><ul><li><p><code>Log__c</code> - Automatically stores details about the org, user, session and experience site (when applicable)</p><p><img src="./img/log-record-fields.png" alt="Log Record Fields"></p></li><li><p><code>LogEntry__c</code> - Automatically stores details about the related record (including the record's JSON), as well as details about all platform limits at the time that the log entry was generated.</p><p><img src="./img/log-entry-record-fields.png" alt="Log Entry Record Fields"></p></li></ul><h2 id="feature-9-track-related-logs-for-async-processes-like-apex-batchable-and-queueable-jobs" class="heading-0-0-12"><span class="anchor-0-0-13" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Feature #9: Track Related Logs for Async Processes (like Apex batchable and queueable jobs)</h2><p>In Salesforce, asynchronous jobs like batchable and queuable run in separate transactions - each with their own unique transaction ID. To relate these jobs back to the original log, Apex developers can use the method <code>Logger.setParentLogTransactionId(String)</code>. Nebula Logger uses this value to relate child <code>Log__c</code> records, using the field <code>Log__c.ParentLog__c</code></p><p>This sample batchable class shows how you can leverage this feature to relate all of your batch job's logs together.</p><pre class=""><code class="java -codedoc-code-snippet code-0-0-14" tabindex="0"><span class="wmbar-0-0-19"><span></span><span></span><span></span><span></span></span><div class="line-0-0-18  -codedoc-code-line" data-content="public with sharing class MyExampleBatchJob implements Database.Batchable<SObject>, Database.Stateful {" id="code7-l1"><span class="lineCounter-0-0-15 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token keyword">public</span> <span class="token keyword">with</span> <span class="token namespace">sharing</span> <span class="token keyword">class</span> <span class="token class-name">MyExampleBatchJob</span> <span class="token keyword">implements</span> <span class="token class-name">Database<span class="token punctuation">.</span>Batchable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span> <span class="token class-name">Database<span class="token punctuation">.</span>Stateful</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="    private String originalTransactionId;" id="code7-l2"><span class="lineCounter-0-0-15 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token keyword">private</span> <span class="token class-name">String</span> originalTransactionId<span class="token punctuation">;</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="" id="code7-l3"><span class="lineCounter-0-0-15 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="    public Database.QueryLocator start(Database.BatchableContext batchableContext) {" id="code7-l4"><span class="lineCounter-0-0-15 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token keyword">public</span> <span class="token class-name">Database<span class="token punctuation">.</span>QueryLocator</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token class-name">Database<span class="token punctuation">.</span>BatchableContext</span> batchableContext<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="        // Each batchable method runs in a separate transaction" id="code7-l5"><span class="lineCounter-0-0-15 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token comment">// Each batchable method runs in a separate transaction</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="        // ...so store the first transaction ID to later relate the other transactions" id="code7-l6"><span class="lineCounter-0-0-15 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token comment">// ...so store the first transaction ID to later relate the other transactions</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="        this.originalTransactionId = Logger.getTransactionId();" id="code7-l7"><span class="lineCounter-0-0-15 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token keyword">this</span><span class="token punctuation">.</span>originalTransactionId <span class="token operator">=</span> <span class="token class-name">Logger</span><span class="token punctuation">.</span><span class="token function">getTransactionId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="" id="code7-l8"><span class="lineCounter-0-0-15 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="        Logger.info('Starting MyExampleBatchJob');" id="code7-l9"><span class="lineCounter-0-0-15 -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token class-name">Logger</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">'Starting MyExampleBatchJob'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="        Logger.saveLog();" id="code7-l10"><span class="lineCounter-0-0-15 prim -codedoc-line-counter">10<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token class-name">Logger</span><span class="token punctuation">.</span><span class="token function">saveLog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="" id="code7-l11"><span class="lineCounter-0-0-15 -codedoc-line-counter">11<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="        // Just as an example, query all accounts" id="code7-l12"><span class="lineCounter-0-0-15 -codedoc-line-counter">12<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token comment">// Just as an example, query all accounts</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="        return Database.getQueryLocator([SELECT Id, Name, RecordTypeId FROM Account]);" id="code7-l13"><span class="lineCounter-0-0-15 -codedoc-line-counter">13<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token keyword">return</span> <span class="token class-name">Database</span><span class="token punctuation">.</span><span class="token function">getQueryLocator</span><span class="token punctuation">(</span><span class="token punctuation">[</span>SELECT <span class="token class-name">Id</span><span class="token punctuation">,</span> <span class="token class-name">Name</span><span class="token punctuation">,</span> <span class="token class-name">RecordTypeId</span> FROM <span class="token class-name">Account</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="    }" id="code7-l14"><span class="lineCounter-0-0-15 -codedoc-line-counter">14<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="" id="code7-l15"><span class="lineCounter-0-0-15 prim -codedoc-line-counter">15<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="    public void execute(Database.BatchableContext batchableContext, List<Account> scope) {" id="code7-l16"><span class="lineCounter-0-0-15 -codedoc-line-counter">16<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token class-name">Database<span class="token punctuation">.</span>BatchableContext</span> batchableContext<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Account</span><span class="token punctuation">&gt;</span></span> scope<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="        // One-time call (per transaction) to set the parent log" id="code7-l17"><span class="lineCounter-0-0-15 -codedoc-line-counter">17<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token comment">// One-time call (per transaction) to set the parent log</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="        Logger.setParentLogTransactionId(this.originalTransactionId);" id="code7-l18"><span class="lineCounter-0-0-15 -codedoc-line-counter">18<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token class-name">Logger</span><span class="token punctuation">.</span><span class="token function">setParentLogTransactionId</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>originalTransactionId<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="" id="code7-l19"><span class="lineCounter-0-0-15 -codedoc-line-counter">19<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="        for (Account account : scope) {" id="code7-l20"><span class="lineCounter-0-0-15 prim -codedoc-line-counter">20<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Account</span> account <span class="token operator">:</span> scope<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="            // TODO add your batch job's logic" id="code7-l21"><span class="lineCounter-0-0-15 -codedoc-line-counter">21<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span class="token comment">// TODO add your batch job's logic</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="" id="code7-l22"><span class="lineCounter-0-0-15 -codedoc-line-counter">22<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="            // Then log the result" id="code7-l23"><span class="lineCounter-0-0-15 -codedoc-line-counter">23<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span class="token comment">// Then log the result</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="            Logger.info('Processed an account record', account);" id="code7-l24"><span class="lineCounter-0-0-15 -codedoc-line-counter">24<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span class="token class-name">Logger</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">'Processed an account record'</span><span class="token punctuation">,</span> account<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="        }" id="code7-l25"><span class="lineCounter-0-0-15 prim -codedoc-line-counter">25<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token punctuation">}</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="" id="code7-l26"><span class="lineCounter-0-0-15 -codedoc-line-counter">26<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="        Logger.saveLog();" id="code7-l27"><span class="lineCounter-0-0-15 -codedoc-line-counter">27<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token class-name">Logger</span><span class="token punctuation">.</span><span class="token function">saveLog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="    }" id="code7-l28"><span class="lineCounter-0-0-15 -codedoc-line-counter">28<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="" id="code7-l29"><span class="lineCounter-0-0-15 -codedoc-line-counter">29<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="    public void finish(Database.BatchableContext batchableContext) {" id="code7-l30"><span class="lineCounter-0-0-15 prim -codedoc-line-counter">30<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">finish</span><span class="token punctuation">(</span><span class="token class-name">Database<span class="token punctuation">.</span>BatchableContext</span> batchableContext<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="        // The finish method runs in yet-another transaction, so set the parent log again" id="code7-l31"><span class="lineCounter-0-0-15 -codedoc-line-counter">31<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token comment">// The finish method runs in yet-another transaction, so set the parent log again</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="        Logger.setParentLogTransactionId(this.originalTransactionId);" id="code7-l32"><span class="lineCounter-0-0-15 -codedoc-line-counter">32<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token class-name">Logger</span><span class="token punctuation">.</span><span class="token function">setParentLogTransactionId</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>originalTransactionId<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="" id="code7-l33"><span class="lineCounter-0-0-15 -codedoc-line-counter">33<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="        Logger.info('Finishing running MyExampleBatchJob');" id="code7-l34"><span class="lineCounter-0-0-15 -codedoc-line-counter">34<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token class-name">Logger</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">'Finishing running MyExampleBatchJob'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="        Logger.saveLog();" id="code7-l35"><span class="lineCounter-0-0-15 prim -codedoc-line-counter">35<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token class-name">Logger</span><span class="token punctuation">.</span><span class="token function">saveLog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="    }" id="code7-l36"><span class="lineCounter-0-0-15 -codedoc-line-counter">36<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="}" id="code7-l37"><span class="lineCounter-0-0-15 -codedoc-line-counter">37<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token punctuation">}</span></div><br><div class="line-0-0-18  -codedoc-code-line" data-content="" id="code7-l38"><span class="lineCounter-0-0-15 prim -codedoc-line-counter">38<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br></code></pre><h2 id="feature-10-automatically-cleanup-old-logs" class="heading-0-0-12"><span class="anchor-0-0-13" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Feature #10: Automatically Cleanup Old Logs</h2><p>Since our custom objects <code>Log__c</code> and <code>LogEntry__c</code> use our org's data storage, we need to be able to easily delete old logs that are no longer relevant.</p><p>Nebula Logger provides two Apex classes out-of-the-box to handle automatically deleting old logs</p><ol><li><code>LogBatchPurger</code> - this batch Apex class will delete any <code>Log__c</code> records with <code>Log__c.LogRetentionDate__c &lt;= System.today()</code>.</li><li><code>LogBatchPurgeScheduler</code> - this schedulable Apex class can be schedule to run <code>LogBatchPurger</code> on a daily or weekly basis</li></ol><h2 id="nebula-logger-wrap-up" class="heading-0-0-12"><span class="anchor-0-0-13" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Nebula Logger Wrap-Up</h2><p>After years of working on it, Nebula Logger is finally in a stable state - you can use the unpackaged code or managed package, both are completely free and <a href="https://github.com/jongpie/NebulaLogger">available on Github</a>. There are still several enhancements planned (and I'm sure there are still some bugs lurking), but I hope that admins, developers &amp; architects find it to be a useful addition to their Salesforce implementations.</p><p>If you have any requested enhancements or bugfixes, feel free to open an issue in Github! Many thanks to everyone that has provided feedback over the last few years, and thanks to <a href="/joys-of-apex/">James Simone</a> for the opportunity to publish on the <a href="/joys-of-apex/">Joys of Apex</a>.</p><p>The original version of <a href="https://www.jamessimone.net/blog/joys-of-apex/advanced-logging-using-nebula-logger/">Advanced Logging Using Nebula Logger can be read on my blog</a> - it is mirrored here for your enjoyment!</p><hr><marker><div id="postscript">

</div></marker><h2 id="postscript" class="heading-0-0-12"><span class="anchor-0-0-13" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Postscript</h2><p><strong>James</strong>: a big thanks, again, to Jonathan for agreeing to appear here on the Joys Of Apex. It will be fun to welcome more guest authors to host their content here in the future, but there was no better person to kick off our guest post series than him. Here's why:</p><p>2014 was a wild year, and the course of my life changed irrevocably -- and it all started with one meeting. Jonathan and I met pretty much exactly 7 years ago to this day. He was the latest in a slew of tech hires that most people met and then never saw again; our company had an unfortunate gap between the members of the technical team and the rest of the business, and there were already several developers working for this relatively small company whom I had only seen while meeting them. I was working in finance back then (itself a team of two; myself and the CTO), and I had an upcoming presentation not just for the president of my division, but also with the CEO of the entire company.</p><p>I had my doubts about walking yet another new hire who didn't care about the meat of the business through my responsibilities (distracted as I was with my upcoming presentation), but the hour-long meeting I had with Jonathan ran over time as he asked question after question. When I saw him again, nearly a month later, he presented me with a document -- pages and pages about my job, how it related to the overall business, and how our upcoming move to Salesforce could benefit me personally. To say that I was impressed would be an understatement.</p><p>Little did I know that within the next few months, the career in finance that I thought I wanted would be derailed permanently; that I would soon be installed as the product owner on the new tech team that Jonathan was a part of; that a few months after that he'd be giving me workbooks on Apex and SOQL. The thought process at that time was that because I was already proficient in SQL, I could pitch in on some smaller development asks to support Jonathan in his own role. He began teaching me how to write code, and stuck with me even though I was a slow learner.</p><p>The rest of the story -- and it's a fairly wild one by almost any standard -- is less about programming as it is about the exigencies of life and how the friends we meet along the way make the journey worth it. It's the story of how disasters can occur on even the best projects, and how we recover from those things. Is there space for such a tale here? Let me know -- for now, thanks for reading and I hope that you will consider <a href="https://github.com/jongpie/NebulaLogger">Nebula Logger</a> for your on-platform logging needs!</p><div class="contentnav-0-0-7" data-no-search=""><a href="#what-logging-does-salesforce-provide" class="h2" data-content-highlight="what-logging-does-salesforce-provide">What Logging Does Salesforce Provide</a><a href="#introducing-nebula-logger" class="h2" data-content-highlight="introducing-nebula-logger">Introducing Nebula Logger</a><a href="#feature-1-use-salesforce-features-to-manage-logs" class="h2" data-content-highlight="feature-1-use-salesforce-features-to-manage-logs">Feature #1: Use Salesforce Features to Manage Logs</a><a href="#feature-2-log-and-throw-exceptions" class="h2" data-content-highlight="feature-2-log-and-throw-exceptions">Feature #2: Log AND Throw Exceptions</a><a href="#feature-3-unified-log-with-a-unique-transaction-id" class="h2" data-content-highlight="feature-3-unified-log-with-a-unique-transaction-id">Feature #3: Unified Log with a Unique Transaction ID</a><a href="#feature-4-support-all-of-salesforces-logging-levels" class="h2" data-content-highlight="feature-4-support-all-of-salesforces-logging-levels">Feature #4: Support All of Salesforce's Logging Levels</a><a href="#feature-5-be-able-to-log-code-and-declarative-automations" class="h2" data-content-highlight="feature-5-be-able-to-log-code-and-declarative-automations">Feature #5: Be Able to Log Code and Declarative Automations</a><a href="#feature-6-relate-log-entries-to-any-record" class="h2" data-content-highlight="feature-6-relate-log-entries-to-any-record">Feature #6: Relate Log Entries to Any Record</a><a href="#feature-7-advanced-transaction-controls-for-apex-developers" class="h2" data-content-highlight="feature-7-advanced-transaction-controls-for-apex-developers">Feature #7: Advanced Transaction Controls for Apex Developers</a><a href="#feature-8-automatically-log-details-about-the-org-user-and-record" class="h2" data-content-highlight="feature-8-automatically-log-details-about-the-org-user-and-record">Feature #8: Automatically Log Details About the Org, User and Record</a><a href="#feature-9-track-related-logs-for-async-processes-like-apex-batchable-and-queueable-jobs" class="h2" data-content-highlight="feature-9-track-related-logs-for-async-processes-like-apex-batchable-and-queueable-jobs">Feature #9: Track Related Logs for Async Processes (like Apex batchable and queueable jobs)</a><a href="#feature-10-automatically-cleanup-old-logs" class="h2" data-content-highlight="feature-10-automatically-cleanup-old-logs">Feature #10: Automatically Cleanup Old Logs</a><a href="#nebula-logger-wrap-up" class="h2" data-content-highlight="nebula-logger-wrap-up">Nebula Logger Wrap-Up</a><a href="#postscript" class="h2" data-content-highlight="postscript">Postscript</a></div></div><div id="-codedoc-toc" class="toc-0-0-4"><div class="content-0-0-5"><p><a href="/joys-of-apex/">Home</a>
<a href="/joys-of-apex/advanced-logging-using-nebula-logger">Advanced Logging Using Nebula Logger</a>
<a href="/joys-of-apex/apex-logging-service">Apex Logging Service</a>
<a href="/joys-of-apex/apex-object-oriented-basics">Apex Object-Oriented Basics</a>
<a href="/joys-of-apex/batchable-and-queueable-apex">Batchable And Queueable Apex</a>
<a href="/joys-of-apex/building-a-better-singleton">Building A Better Singleton</a>
<a href="/joys-of-apex/continuous-integration-with-sfdx">Continuous Integration With SFDX</a>
<a href="/joys-of-apex/dependency-injection-factory-pattern">Dependency Injection &amp; Factory Pattern</a>
<a href="/joys-of-apex/enum-apex-class-gotchas">Enum Apex Class Gotchas</a>
<a href="/joys-of-apex/extendable-apis">Extendable Apis</a>
<a href="/joys-of-apex/formula-date-issues">Formula Date Issues</a>
<a href="/joys-of-apex/future-method-callout-callback">Future Methods, Callouts &amp; Callbacks</a>
<a href="/joys-of-apex/idiomatic-salesforce-apex">Idiomatic Salesforce Apex</a>
<a href="/joys-of-apex/intro">Introduction &amp; Testing Philosophy</a>
<a href="/joys-of-apex/lazy-iterators">Lazy Iterators</a>
<a href="/joys-of-apex/lightweight-trigger-handler">Lightweight Trigger Handler</a>
<a href="/joys-of-apex/lwc-composable-modal">LWC Composable Modal</a>
<a href="/joys-of-apex/lwc-composable-pagination">LWC Composable Pagination</a>
<a href="/joys-of-apex/lwc-custom-path">LWC Custom Lead Path</a>
<a href="/joys-of-apex/mocking-dml">Mocking DML</a>
<a href="/joys-of-apex/react-versus-lightning-web-components">React Versus Lightning Web Components</a>
<a href="/joys-of-apex/refactoring-tips-and-tricks">Refactoring Tips &amp; Tricks</a>
<a href="/joys-of-apex/replacing-dlrs-with-custom-rollup">Replacing DLRS With Custom Rollup</a>
<a href="/joys-of-apex/repository-pattern">Repository Pattern</a>
<a href="/joys-of-apex/set-timeout-and-implementing-delays">setTimeout &amp; Implementing Delays</a>
<a href="/joys-of-apex/sorting-and-performance-in-apex">Sorting And Performance In Apex</a>
<a href="/joys-of-apex/test-driven-development-example">Test Driven Development Example</a>
<a href="/joys-of-apex/testing-custom-permissions">Testing Custom Permissions</a>
<a href="/joys-of-apex/the-tao-of-apex">The Tao Of Apex</a>
<a href="/joys-of-apex/writing-performant-apex-tests">Writing Performant Apex Tests</a></p><p><br><br></p><p><a href="https://www.jamessimone.net/">Read more tech articles</a></p></div></div><div class="footer-0-0-3"><div class="left"><script id="YXSCDfalRh">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("YXSCDfalRh", "BWW0vHR4333HbDOiwZ67JA==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script></div><div class="main"><div class="inside"></div></div><div class="right"><script id="ODjRaiOZrN">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("ODjRaiOZrN", "6yEdMfRRlNsUBKSBOTazFg==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script></div></div><script id="eifJVleqmp">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("eifJVleqmp", "wh9V9isakhdwzlz9ZUjvyw==", {"namespace":"/joys-of-apex"});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script></body></html>