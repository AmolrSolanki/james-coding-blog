<!DOCTYPE html><html><head><title>Joys Of Apex | Sorting And Performance In Apex</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><meta name="robots" content="index,follow"><meta name="theme-color" content="#212121"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><link rel="shortcut icon" href="/joys-of-apex/favicon.ico"><link href="https://fonts.googleapis.com/css?family=Hind:400,700&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:300,400&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/icon?family=Material+Icons|Material+Icons+Outlined" rel="stylesheet"><style>
      body, input, button {
        font-family: 'Hind', sans-serif;
      }

      code, .hljs {
        font-family: 'Source Code Pro', 'Courier New', Courier, monospace;
      }

      .icon-font {
        font-family: 'Material Icons';
        font-weight: normal;
        font-style: normal;
        font-size: 24px;  /* Preferred icon size */
        display: inline-block;
        line-height: 1;
        text-transform: none;
        letter-spacing: normal;
        word-wrap: normal;
        white-space: nowrap;
        direction: ltr;
      
        /* Support for all WebKit browsers. */
        -webkit-font-smoothing: antialiased;
        /* Support for Safari and Chrome. */
        text-rendering: optimizeLegibility;
      
        /* Support for Firefox. */
        -moz-osx-font-smoothing: grayscale;
      
        /* Support for IE. */
        font-feature-settings: 'liga';
      }

      .icon-font.outline {
        font-family: 'Material Icons Outlined';
      }
    </style><link href="/joys-of-apex/styles/codedoc-styles.css" rel="stylesheet"><script async="" defer="" src="/joys-of-apex/bundle/codedoc-bundle.js"></script><meta property="og:image" content="./img/joys-of-apex-thumbnail.png"><script>window.githubConfig={"repo":"james-coding-blog","user":"jamessimone"}</script><style>.container{padding-top: 0 !important}</style><style>#-codedoc-toc { backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px) }</style><meta name="twitter:title" content="Joys Of Apex | Sorting And Performance In Apex"><meta property="og:type" content="article"><meta property="og:title" content="Joys Of Apex | Sorting And Performance In Apex"></head><body><header style="margin-left: 1rem">Read more at <a href="https://wwww.jamessimone.net">jamessimone.net</a>, or return to the <a href="/joys-of-apex/">homepage</a></header><div id="-codedoc-container" class="container"><script>window.source = {"base":"posts","path":"sorting-and-performance-in-apex.md","namespace":"/joys-of-apex","title":{"base":"Joys Of Apex","connector":" | "}}</script><div class="hero-0-0-8" style="margin-bottom: -156px"><img src="/joys-of-apex/img/the-joys-of-apex.png" class="image-0-0-9" data-hero=""><span class="caption-0-0-10"></span></div><marker><br>
<br>
<br>
<br>
<br>

</marker><h1 class="h-0-0-11 "><span style="color: green; 
      text-shadow: none; 
      font-size: 48px"><p>Sorting And Performance In Apex</p></span></h1><script id="omLPjzRJVK">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("omLPjzRJVK", "kRzsgnV+B7EQTskbovy+YA==", {"src":"github","date":"2020-03-22T15:12:03.284Z"});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script><div hidden="" data-ignore-text="" data-meta-override-property="og:image"><p>./img/joys-of-apex-thumbnail.png</p></div><p>Recently, a reader came to me, wanting to discuss the potential performance implications of using the <a href="/joys-of-apex/mocking-dml">DML mocking framework</a> I have been espousing here:</p><blockquote><p>Please stop claiming performance on something that isn't doing the same thing as FFLib. Additionally, in test (sic) you're not sorting, so using your Crud implementation to actually insert is going to be slower than directly inserting, anywhere from n log n to n^2 slower.</p></blockquote><p>I always find it endearing when the formulas come out. As a small business owner, I want to ensure that my clients are getting the best in the way of performance; to some extent, that's what I'm selling, but beyond that, I also consider it a moral obligation to separate feelings from code. My point is not to recommend things to people because I <em>feel</em> they are right. Rather, the whole point of this series has been to show using TDD and <em>numbers</em> that if you want big improvements in your test time, you can follow the methodology I'm describing (more so than any actual piece of code) to reduce the length of time it takes for your unit tests to run.</p><p>When I talk about the use of the <a href="/joys-of-apex/dependency-injection-factory-pattern">Factory pattern</a> as a way to use dependency injection to give your classes access to DML methods that can then be easily mocked, my intent is to show one possible way to utilize this <em>methodology</em>. As a good friend of mine likes to say:</p><blockquote><p>The best line of code is the one never written.</p></blockquote><p>So ... don't make sweeping changes if you don't have to. Empower yourself through an education in what's possible to decide how to best make positive changes in your/your team's development. Reducing testing time (thus speeding iteration) is one possible means to that end.</p><h2 id="stress-testing-the-crud-implementation" class="heading-0-0-12"><span class="anchor-0-0-13" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Stress Testing The Crud Implementation</h2><p>With that being said, I thought that beyond the language this reader in question chose to employ, their underlying assertion was an interesting one, and something that should be tested. To refresh your memory, I'll post just the relevant snippets:</p><pre class="with-bar"><code class="java code-0-0-14" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span>classes/Crud.cls</span></span><div class="line-0-0-16 " data-content="//these days, on a greenfield project,"><span class="lineCounter-0-0-15 prim">1</span><span class="token comment">//these days, on a greenfield project,</span></div><br><div class="line-0-0-16 " data-content="//I'd really call this class DML"><span class="lineCounter-0-0-15">2</span><span class="token comment">//I'd really call this class DML</span></div><br><div class="line-0-0-16 " data-content="public virtual class Crud implements ICrud {"><span class="lineCounter-0-0-15">3</span><span class="token keyword">public</span> virtual <span class="token keyword">class</span> <span class="token class-name">Crud</span> <span class="token keyword">implements</span> <span class="token class-name">ICrud</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  @testVisible private static Integer MAX_DML_CHUNKING = 10;"><span class="lineCounter-0-0-15">4</span>  <span class="token annotation punctuation">@testVisible</span> <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Integer</span> MAX_DML_CHUNKING <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  //...."><span class="lineCounter-0-0-15 prim">5</span>  <span class="token comment">//....</span></div><br><div class="line-0-0-16 " data-content="  public virtual List<SObject> doInsert(List<SObject> records) {"><span class="lineCounter-0-0-15">6</span>  <span class="token keyword">public</span> virtual <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> <span class="token function">doInsert</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> records<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    this.sortToPreventChunkingErrors(records);"><span class="lineCounter-0-0-15">7</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">sortToPreventChunkingErrors</span><span class="token punctuation">(</span>records<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    Database.insert(records);"><span class="lineCounter-0-0-15">8</span>    <span class="token class-name">Database</span><span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>records<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    return records;"><span class="lineCounter-0-0-15">9</span>    <span class="token keyword">return</span> records<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  }"><span class="lineCounter-0-0-15 prim">10</span>  <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="  //etc, sortToPreventChunkingErrors is called"><span class="lineCounter-0-0-15">11</span>  <span class="token comment">//etc, sortToPreventChunkingErrors is called</span></div><br><div class="line-0-0-16 " data-content="  //in update/upsert as well"><span class="lineCounter-0-0-15">12</span>  <span class="token comment">//in update/upsert as well</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">13</span></div><br><div class="line-0-0-16 " data-content="  private void sortToPreventChunkingErrors(List<SObject> records) {"><span class="lineCounter-0-0-15">14</span>  <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">sortToPreventChunkingErrors</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> records<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    //prevents a chunking error that can occur if"><span class="lineCounter-0-0-15 prim">15</span>    <span class="token comment">//prevents a chunking error that can occur if</span></div><br><div class="line-0-0-16 " data-content="    //SObject types are in the list out of order."><span class="lineCounter-0-0-15">16</span>    <span class="token comment">//SObject types are in the list out of order.</span></div><br><div class="line-0-0-16 " data-content="    //no need to sort if the list size is below the limit"><span class="lineCounter-0-0-15">17</span>    <span class="token comment">//no need to sort if the list size is below the limit</span></div><br><div class="line-0-0-16 " data-content="    if(records.size() >= MAX_DML_CHUNKING) {"><span class="lineCounter-0-0-15">18</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>records<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> MAX_DML_CHUNKING<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="        records.sort();"><span class="lineCounter-0-0-15">19</span>        records<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    }"><span class="lineCounter-0-0-15 prim">20</span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="  }"><span class="lineCounter-0-0-15">21</span>  <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="}"><span class="lineCounter-0-0-15 prim">22</span><span class="token punctuation">}</span></div><br></code></pre><p>But is the production usage of <code>Crud</code> <em>actually</em> causing <code>O(n log n)</code> (linearithmic) to <code>O(2^n)</code> (quadratic) slowness? This seems like something that we can test fairly easily. Of course, to test "in production" (mais c'est en fait "in situ", non?), we have access to the wonderful world of Anonymous Apex. Let's build something that allows us to test the reader's assertion, getting a baseline performance indication from what happens when calling <code>Database.insert</code> in order to compare against the <code>Crud</code> implementation.</p><p>Our pseudo test-runner needs the following qualities:</p><ul><li>ability to compute start/end time of each transaction</li><li>prevention of actual commits to the database (this is production, after all!)</li><li>means for each test to hook into the above while implementing its own database insertion</li></ul><p>It's also not enough to test one of the <code>Crud</code> methods against only the baseline <code>Database.insert</code> method; I also need to update the implementation to make sorting optional so that I can measure whether or not adding sorting significantly affects processing time:</p><pre class="with-bar"><code class="java code-0-0-14" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span>classes/Crud.cls</span></span><div class="line-0-0-16 " data-content="public virtual class Crud implements ICrud {"><span class="lineCounter-0-0-15 prim">1</span><span class="token keyword">public</span> virtual <span class="token keyword">class</span> <span class="token class-name">Crud</span> <span class="token keyword">implements</span> <span class="token class-name">ICrud</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  public static Boolean SORT_CHUNKS = false;"><span class="lineCounter-0-0-15">2</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Boolean</span> SORT_CHUNKS <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  //...."><span class="lineCounter-0-0-15">3</span>  <span class="token comment">//....</span></div><br><div class="line-0-0-16 " data-content="  private void sortToPreventChunkingErrors(List<SObject> records) {"><span class="lineCounter-0-0-15">4</span>  <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">sortToPreventChunkingErrors</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SObject</span><span class="token punctuation">&gt;</span></span> records<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    //prevents a chunking error that can occur"><span class="lineCounter-0-0-15 prim">5</span>    <span class="token comment">//prevents a chunking error that can occur</span></div><br><div class="line-0-0-16 " data-content="    //if SObject types are in the list out of order."><span class="lineCounter-0-0-15">6</span>    <span class="token comment">//if SObject types are in the list out of order.</span></div><br><div class="line-0-0-16 " data-content="    //no need to sort if the list size is below the limit\"><span class="lineCounter-0-0-15">7</span>    <span class="token comment">//no need to sort if the list size is below the limit\</span></div><br><div class="line-0-0-16 " data-content="    if(SORT_CHUNKS &amp;&amp; records.size() >= MAX_DML_CHUNKING) {"><span class="lineCounter-0-0-15">8</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>SORT_CHUNKS <span class="token operator">&amp;&amp;</span> records<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> MAX_DML_CHUNKING<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="        records.sort();"><span class="lineCounter-0-0-15">9</span>        records<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    }"><span class="lineCounter-0-0-15 prim">10</span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="  }"><span class="lineCounter-0-0-15">11</span>  <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="}"><span class="lineCounter-0-0-15 prim">12</span><span class="token punctuation">}</span></div><br></code></pre><p>Alright, let's look at the Anonymous Apex:</p><pre class=""><code class="java code-0-0-14" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16 " data-content="public abstract class Function {"><span class="lineCounter-0-0-15 prim">1</span><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Function</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  private Datetime now = System.now();"><span class="lineCounter-0-0-15">2</span>  <span class="token keyword">private</span> <span class="token class-name">Datetime</span> now <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">3</span></div><br><div class="line-0-0-16 " data-content="  protected abstract void call();"><span class="lineCounter-0-0-15">4</span>  <span class="token keyword">protected</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  protected abstract String getTypeName();"><span class="lineCounter-0-0-15 prim">5</span>  <span class="token keyword">protected</span> <span class="token keyword">abstract</span> <span class="token class-name">String</span> <span class="token function">getTypeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">6</span></div><br><div class="line-0-0-16 " data-content="  public Function() {"><span class="lineCounter-0-0-15">7</span>  <span class="token keyword">public</span> <span class="token class-name">Function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    Savepoint sp = Database.setSavePoint();"><span class="lineCounter-0-0-15">8</span>    <span class="token class-name">Savepoint</span> sp <span class="token operator">=</span> <span class="token class-name">Database</span><span class="token punctuation">.</span><span class="token function">setSavePoint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    this.recordTime('Starting for ' + getTypeName());"><span class="lineCounter-0-0-15">9</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">recordTime</span><span class="token punctuation">(</span><span class="token string">'Starting for '</span> <span class="token operator">+</span> <span class="token function">getTypeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    this.call();"><span class="lineCounter-0-0-15 prim">10</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    this.recordTime('Ending for ' + getTypeName());"><span class="lineCounter-0-0-15">11</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">recordTime</span><span class="token punctuation">(</span><span class="token string">'Ending for '</span> <span class="token operator">+</span> <span class="token function">getTypeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    Database.rollBack(sp);"><span class="lineCounter-0-0-15">12</span>    <span class="token class-name">Database</span><span class="token punctuation">.</span><span class="token function">rollBack</span><span class="token punctuation">(</span>sp<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  }"><span class="lineCounter-0-0-15">13</span>  <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">14</span></div><br><div class="line-0-0-16 " data-content="  protected List<Account> getAccounts() {"><span class="lineCounter-0-0-15 prim">15</span>  <span class="token keyword">protected</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Account</span><span class="token punctuation">&gt;</span></span> <span class="token function">getAccounts</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    List<Account> accounts = new List<Account>();"><span class="lineCounter-0-0-15">16</span>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Account</span><span class="token punctuation">&gt;</span></span> accounts <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Account</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    //despite each Database.rollback"><span class="lineCounter-0-0-15">17</span>    <span class="token comment">//despite each Database.rollback</span></div><br><div class="line-0-0-16 " data-content="    //the DML rows still count towards the max"><span class="lineCounter-0-0-15">18</span>    <span class="token comment">//the DML rows still count towards the max</span></div><br><div class="line-0-0-16 " data-content="    //of 10,000 DML rows per sync transaction"><span class="lineCounter-0-0-15">19</span>    <span class="token comment">//of 10,000 DML rows per sync transaction</span></div><br><div class="line-0-0-16 " data-content="    //and we need to give breathing room"><span class="lineCounter-0-0-15 prim">20</span>    <span class="token comment">//and we need to give breathing room</span></div><br><div class="line-0-0-16 " data-content="    //for the max of 10 seconds"><span class="lineCounter-0-0-15">21</span>    <span class="token comment">//for the max of 10 seconds</span></div><br><div class="line-0-0-16 " data-content="    //per Anonymous Apex transaction"><span class="lineCounter-0-0-15">22</span>    <span class="token comment">//per Anonymous Apex transaction</span></div><br><div class="line-0-0-16 " data-content="    for(Integer index = 0; index < 2000; index++) {"><span class="lineCounter-0-0-15">23</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> <span class="token number">2000</span><span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="      accounts.add("><span class="lineCounter-0-0-15">24</span>      accounts<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span></div><br><div class="line-0-0-16 " data-content="        new Account("><span class="lineCounter-0-0-15 prim">25</span>        <span class="token keyword">new</span> <span class="token class-name">Account</span><span class="token punctuation">(</span></div><br><div class="line-0-0-16 " data-content="            Name = 'Test' + Math.random(),"><span class="lineCounter-0-0-15">26</span>            <span class="token class-name">Name</span> <span class="token operator">=</span> <span class="token string">'Test'</span> <span class="token operator">+</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></div><br><div class="line-0-0-16 " data-content="            NumberOfEmployees = index,"><span class="lineCounter-0-0-15">27</span>            <span class="token class-name">NumberOfEmployees</span> <span class="token operator">=</span> index<span class="token punctuation">,</span></div><br><div class="line-0-0-16 " data-content="            Phone = String.valueOf(index),"><span class="lineCounter-0-0-15">28</span>            <span class="token class-name">Phone</span> <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">,</span></div><br><div class="line-0-0-16 " data-content="            Sic = '57340',"><span class="lineCounter-0-0-15">29</span>            <span class="token class-name">Sic</span> <span class="token operator">=</span> <span class="token string">'57340'</span><span class="token punctuation">,</span></div><br><div class="line-0-0-16 " data-content="            YearStarted = String.valueOf((Math.random() * 4).intValue())"><span class="lineCounter-0-0-15 prim">30</span>            <span class="token class-name">YearStarted</span> <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></div><br><div class="line-0-0-16 " data-content="          )"><span class="lineCounter-0-0-15">31</span>          <span class="token punctuation">)</span></div><br><div class="line-0-0-16 " data-content="      );"><span class="lineCounter-0-0-15">32</span>      <span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    }"><span class="lineCounter-0-0-15">33</span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="    return accounts;"><span class="lineCounter-0-0-15">34</span>    <span class="token keyword">return</span> accounts<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  }"><span class="lineCounter-0-0-15 prim">35</span>  <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">36</span></div><br><div class="line-0-0-16 " data-content="  protected void recordTime(String startString) {"><span class="lineCounter-0-0-15">37</span>  <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">recordTime</span><span class="token punctuation">(</span><span class="token class-name">String</span> startString<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    System.debug(startString + ': ' + getSecondsPassed() + ' seconds elapsed');"><span class="lineCounter-0-0-15">38</span>    <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span>startString <span class="token operator">+</span> <span class="token string">': '</span> <span class="token operator">+</span> <span class="token function">getSecondsPassed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' seconds elapsed'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    now = System.now();"><span class="lineCounter-0-0-15">39</span>    now <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  }"><span class="lineCounter-0-0-15 prim">40</span>  <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">41</span></div><br><div class="line-0-0-16 " data-content="  private Integer getSecondsPassed() {"><span class="lineCounter-0-0-15">42</span>  <span class="token keyword">private</span> <span class="token class-name">Integer</span> <span class="token function">getSecondsPassed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    return Datetime.newInstance(System.now().getTime() - now.getTime()).second();"><span class="lineCounter-0-0-15">43</span>    <span class="token keyword">return</span> <span class="token class-name">Datetime</span><span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> now<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">second</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  }"><span class="lineCounter-0-0-15">44</span>  <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="}"><span class="lineCounter-0-0-15 prim">45</span><span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">46</span></div><br><div class="line-0-0-16 " data-content="public class DatabaseInsert extends Function {"><span class="lineCounter-0-0-15">47</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DatabaseInsert</span> <span class="token keyword">extends</span> <span class="token class-name">Function</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  protected override String getTypeName() { return 'Database.insert'; }"><span class="lineCounter-0-0-15">48</span>  <span class="token keyword">protected</span> override <span class="token class-name">String</span> <span class="token function">getTypeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token string">'Database.insert'</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">49</span></div><br><div class="line-0-0-16 " data-content="  protected override void call() {"><span class="lineCounter-0-0-15 prim">50</span>  <span class="token keyword">protected</span> override <span class="token keyword">void</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    Database.insert(this.getAccounts());"><span class="lineCounter-0-0-15">51</span>    <span class="token class-name">Database</span><span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAccounts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  }"><span class="lineCounter-0-0-15">52</span>  <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="}"><span class="lineCounter-0-0-15">53</span><span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">54</span></div><br><div class="line-0-0-16 " data-content="public class DMLFunctionWithSorting extends Function {"><span class="lineCounter-0-0-15 prim">55</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DMLFunctionWithSorting</span> <span class="token keyword">extends</span> <span class="token class-name">Function</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  protected override String getTypeName() { return 'Crud (with sorting)'; }"><span class="lineCounter-0-0-15">56</span>  <span class="token keyword">protected</span> override <span class="token class-name">String</span> <span class="token function">getTypeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token string">'Crud (with sorting)'</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">57</span></div><br><div class="line-0-0-16 " data-content="  protected override void call() {"><span class="lineCounter-0-0-15">58</span>  <span class="token keyword">protected</span> override <span class="token keyword">void</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    Crud.SORT_CHUNKS = true;"><span class="lineCounter-0-0-15">59</span>    <span class="token class-name">Crud</span><span class="token punctuation">.</span>SORT_CHUNKS <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    new Crud().doInsert(this.getAccounts());"><span class="lineCounter-0-0-15 prim">60</span>    <span class="token keyword">new</span> <span class="token class-name">Crud</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">doInsert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAccounts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  }"><span class="lineCounter-0-0-15">61</span>  <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="}"><span class="lineCounter-0-0-15">62</span><span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">63</span></div><br><div class="line-0-0-16 " data-content="public class DMLFunctionNoSorting extends Function {"><span class="lineCounter-0-0-15">64</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DMLFunctionNoSorting</span> <span class="token keyword">extends</span> <span class="token class-name">Function</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  protected override String getTypeName() { return 'Crud (no sorting)'; }"><span class="lineCounter-0-0-15 prim">65</span>  <span class="token keyword">protected</span> override <span class="token class-name">String</span> <span class="token function">getTypeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token string">'Crud (no sorting)'</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">66</span></div><br><div class="line-0-0-16 " data-content="  protected override void call() {"><span class="lineCounter-0-0-15">67</span>  <span class="token keyword">protected</span> override <span class="token keyword">void</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    Crud.SORT_CHUNKS = false;"><span class="lineCounter-0-0-15">68</span>    <span class="token class-name">Crud</span><span class="token punctuation">.</span>SORT_CHUNKS <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    new Crud().doInsert(this.getAccounts());"><span class="lineCounter-0-0-15">69</span>    <span class="token keyword">new</span> <span class="token class-name">Crud</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">doInsert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAccounts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  }"><span class="lineCounter-0-0-15 prim">70</span>  <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="}"><span class="lineCounter-0-0-15">71</span><span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">72</span></div><br><div class="line-0-0-16 " data-content="new DatabaseInsert();"><span class="lineCounter-0-0-15">73</span><span class="token keyword">new</span> <span class="token class-name">DatabaseInsert</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="new DMLFunctionWithSorting();"><span class="lineCounter-0-0-15">74</span><span class="token keyword">new</span> <span class="token class-name">DMLFunctionWithSorting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="new DMLFunctionNoSorting();"><span class="lineCounter-0-0-15 prim">75</span><span class="token keyword">new</span> <span class="token class-name">DMLFunctionNoSorting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br></code></pre><div class="tabs-0-0-18"><script id="ehoaMJoUC_">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("ehoaMJoUC_", "T764P9zpaV5eSCd1H0okyw==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script><div class="tab first selected" data-tab-title="Function Class"><p>A few notes on the <code>Function</code> paradigm for the footnotes, and running that whole block in Anonymous Apex yields:</p></div><div class="tab" data-tab-title="Function Footnote"><p>The <code>Function</code> paradigm was inspired by an article I read recently on <a href="https://nebulaconsulting.co.uk/insights/list-processing-in-apex/">fluent iterators</a>, which is well worth the read. I've been digging through their source code and having fun with it. There's so much good food for thought in their codebase, which is linked in the article! I've also since published a post about <a href="/joys-of-apex/lazy-iterators">Lazy Iterators</a> which you may also find interesting.</p></div></div><pre class=""><code class="bash code-0-0-14" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16 " data-content="  USER_DEBUG [24]|DEBUG|Starting for Database.insert: 0 seconds elapsed"><span class="lineCounter-0-0-15 prim">1</span>  USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Starting <span class="token keyword">for</span> Database.insert: <span class="token number">0</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="  USER_DEBUG [24]|DEBUG|Ending for Database.insert: 9 seconds elapsed"><span class="lineCounter-0-0-15">2</span>  USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Ending <span class="token keyword">for</span> Database.insert: <span class="token number">9</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="  USER_DEBUG [24]|DEBUG|Starting for Crud (with sorting): 0 seconds elapsed"><span class="lineCounter-0-0-15">3</span>  USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Starting <span class="token keyword">for</span> Crud <span class="token punctuation">(</span>with sorting<span class="token punctuation">)</span>: <span class="token number">0</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="  USER_DEBUG [24]|DEBUG|Ending for Crud (with sorting): 8 seconds elapsed"><span class="lineCounter-0-0-15">4</span>  USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Ending <span class="token keyword">for</span> Crud <span class="token punctuation">(</span>with sorting<span class="token punctuation">)</span>: <span class="token number">8</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="  USER_DEBUG [24]|DEBUG|Starting for Crud (no sorting): 0 seconds elapsed"><span class="lineCounter-0-0-15 prim">5</span>  USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Starting <span class="token keyword">for</span> Crud <span class="token punctuation">(</span>no sorting<span class="token punctuation">)</span>: <span class="token number">0</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="  USER_DEBUG [24]|DEBUG|Ending for Crud (no sorting): 8 seconds elapsed"><span class="lineCounter-0-0-15 prim">6</span>  USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Ending <span class="token keyword">for</span> Crud <span class="token punctuation">(</span>no sorting<span class="token punctuation">)</span>: <span class="token number">8</span> seconds elapsed</div><br></code></pre><p><em>Très intéressant</em>, as they say. I ran this snippet a few times just to make sure that my eyes weren't deceiving me -- with the same results.</p><p>To get better granularity (and to prevent rounding errors) on the seconds elapsed, let's swap out those <code>getSecondsPassed</code> Integers for Decimals:</p><pre class="with-bar"><code class="java code-0-0-14" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span>AnonymousApex Function.cls</span></span><div class="line-0-0-16 " data-content="protected void recordTime(String startString) {"><span class="lineCounter-0-0-15 prim">1</span><span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">recordTime</span><span class="token punctuation">(</span><span class="token class-name">String</span> startString<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  System.debug(startString + ': ' + getSecondsPassed().format() + ' seconds elapsed');"><span class="lineCounter-0-0-15">2</span>  <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span>startString <span class="token operator">+</span> <span class="token string">': '</span> <span class="token operator">+</span> <span class="token function">getSecondsPassed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' seconds elapsed'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  now = System.now();"><span class="lineCounter-0-0-15">3</span>  now <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="}"><span class="lineCounter-0-0-15">4</span><span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15 prim">5</span></div><br><div class="line-0-0-16 " data-content="private Decimal getSecondsPassed() {"><span class="lineCounter-0-0-15">6</span><span class="token keyword">private</span> <span class="token class-name">Decimal</span> <span class="token function">getSecondsPassed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  Integer millisecondsPassed = Datetime.newInstance("><span class="lineCounter-0-0-15">7</span>  <span class="token class-name">Integer</span> millisecondsPassed <span class="token operator">=</span> <span class="token class-name">Datetime</span><span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span></div><br><div class="line-0-0-16 " data-content="    System.now().getTime() - now.getTime()"><span class="lineCounter-0-0-15">8</span>    <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> now<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span></div><br><div class="line-0-0-16 " data-content="  ).millisecond();"><span class="lineCounter-0-0-15">9</span>  <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">millisecond</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  return Decimal.valueOf(millisecondsPassed) / 60;"><span class="lineCounter-0-0-15 prim">10</span>  <span class="token keyword">return</span> <span class="token class-name">Decimal</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>millisecondsPassed<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">60</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="}"><span class="lineCounter-0-0-15 prim">11</span><span class="token punctuation">}</span></div><br></code></pre><div class="tabs-0-0-18"><script id="YLwelPyjYB">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("YLwelPyjYB", "T764P9zpaV5eSCd1H0okyw==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script><div class="tab first selected" data-tab-title="A Small Caveat"><p>A few notes on the <code>Function</code> paradigm for the footnotes, and running that whole block in Anonymous Apex yields:</p></div><div class="tab" data-tab-title="Notes On Testing In Apex"><p>This is true for many languages, but you have to run things many times in order to get something approximating consistent results. I ran just the <em>decimal formatted</em> test more than 30 times, and the test results varied <em>wildly</em> between runs. I consistently found that the native insert method lagged behind the Crud method, with or without sorting, but at times the seconds difference between each invocation varied so much as to render the results unstudyable; at times, the <em>sorting</em> method was fastest. This is the infuriating nature of data science - trying to achieve consistency across things that are by nature inconsistent.</p></div></div><pre class=""><code class="bash code-0-0-14" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16 " data-content="#test run 32 ..."><span class="lineCounter-0-0-15 prim">1</span><span class="token comment">#test run 32 ...</span></div><br><div class="line-0-0-16 " data-content="USER_DEBUG [32]|DEBUG|Starting for Database.insert: 0.017 seconds elapsed"><span class="lineCounter-0-0-15">2</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Starting <span class="token keyword">for</span> Database.insert: <span class="token number">0.017</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [32]|DEBUG|Ending for Database.insert: 11.783 seconds elapsed"><span class="lineCounter-0-0-15">3</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Ending <span class="token keyword">for</span> Database.insert: <span class="token number">11.783</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [32]|DEBUG|Starting for Crud (with sorting): 0.017 seconds elapsed"><span class="lineCounter-0-0-15">4</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Starting <span class="token keyword">for</span> Crud <span class="token punctuation">(</span>with sorting<span class="token punctuation">)</span>: <span class="token number">0.017</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [32]|DEBUG|Ending for Crud (with sorting): 6.833 seconds elapsed"><span class="lineCounter-0-0-15 prim">5</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Ending <span class="token keyword">for</span> Crud <span class="token punctuation">(</span>with sorting<span class="token punctuation">)</span>: <span class="token number">6.833</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Starting for Crud (no sorting): 0.017 seconds elapsed"><span class="lineCounter-0-0-15">6</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Starting <span class="token keyword">for</span> Crud <span class="token punctuation">(</span>no sorting<span class="token punctuation">)</span>: <span class="token number">0.017</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [32]|DEBUG|Ending for Crud (no sorting): 6.45 seconds elapsed"><span class="lineCounter-0-0-15">7</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Ending <span class="token keyword">for</span> Crud <span class="token punctuation">(</span>no sorting<span class="token punctuation">)</span>: <span class="token number">6.45</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="#test run 31 ..."><span class="lineCounter-0-0-15">8</span><span class="token comment">#test run 31 ...</span></div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Starting for Database.insert: 0.017 seconds elapsed"><span class="lineCounter-0-0-15">9</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Starting <span class="token keyword">for</span> Database.insert: <span class="token number">0.017</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [32]|DEBUG|Ending for Database.insert: 5.15 seconds elapsed"><span class="lineCounter-0-0-15 prim">10</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Ending <span class="token keyword">for</span> Database.insert: <span class="token number">5.15</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Starting for Crud (with sorting): 0.017 seconds elapsed"><span class="lineCounter-0-0-15">11</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Starting <span class="token keyword">for</span> Crud <span class="token punctuation">(</span>with sorting<span class="token punctuation">)</span>: <span class="token number">0.017</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [32]|DEBUG|Ending for Crud (with sorting): 8.317 seconds elapsed"><span class="lineCounter-0-0-15">12</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Ending <span class="token keyword">for</span> Crud <span class="token punctuation">(</span>with sorting<span class="token punctuation">)</span>: <span class="token number">8.317</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Starting for Crud (no sorting): 0 seconds elapsed"><span class="lineCounter-0-0-15">13</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Starting <span class="token keyword">for</span> Crud <span class="token punctuation">(</span>no sorting<span class="token punctuation">)</span>: <span class="token number">0</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [32]|DEBUG|Ending for Crud (no sorting): 4.867 seconds elapsed"><span class="lineCounter-0-0-15">14</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Ending <span class="token keyword">for</span> Crud <span class="token punctuation">(</span>no sorting<span class="token punctuation">)</span>: <span class="token number">4.867</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="#test run 30 ..."><span class="lineCounter-0-0-15 prim">15</span><span class="token comment">#test run 30 ...</span></div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Starting for Database.insert: 0.017 seconds elapsed"><span class="lineCounter-0-0-15">16</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Starting <span class="token keyword">for</span> Database.insert: <span class="token number">0.017</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [32]|DEBUG|Ending for Database.insert: 11.817 seconds elapsed"><span class="lineCounter-0-0-15">17</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Ending <span class="token keyword">for</span> Database.insert: <span class="token number">11.817</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Starting for Crud (with sorting): 0 seconds elapsed"><span class="lineCounter-0-0-15">18</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Starting <span class="token keyword">for</span> Crud <span class="token punctuation">(</span>with sorting<span class="token punctuation">)</span>: <span class="token number">0</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [32]|DEBUG|Ending for Crud (with sorting): 1.933 seconds elapsed"><span class="lineCounter-0-0-15">19</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Ending <span class="token keyword">for</span> Crud <span class="token punctuation">(</span>with sorting<span class="token punctuation">)</span>: <span class="token number">1.933</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Starting for Crud (no sorting): 0 seconds elapsed"><span class="lineCounter-0-0-15 prim">20</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Starting <span class="token keyword">for</span> Crud <span class="token punctuation">(</span>no sorting<span class="token punctuation">)</span>: <span class="token number">0</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [32]|DEBUG|Ending for Crud (no sorting): 3.783 seconds elapsed"><span class="lineCounter-0-0-15">21</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Ending <span class="token keyword">for</span> Crud <span class="token punctuation">(</span>no sorting<span class="token punctuation">)</span>: <span class="token number">3.783</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="#test run 29 ..."><span class="lineCounter-0-0-15">22</span><span class="token comment">#test run 29 ...</span></div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Starting for Database.insert: 0.017 seconds elapsed"><span class="lineCounter-0-0-15">23</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Starting <span class="token keyword">for</span> Database.insert: <span class="token number">0.017</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [32]|DEBUG|Ending for Database.insert: 2.15 seconds elapsed"><span class="lineCounter-0-0-15">24</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Ending <span class="token keyword">for</span> Database.insert: <span class="token number">2.15</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [32]|DEBUG|Starting for Crud (with sorting): 0.017 seconds elapsed"><span class="lineCounter-0-0-15 prim">25</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Starting <span class="token keyword">for</span> Crud <span class="token punctuation">(</span>with sorting<span class="token punctuation">)</span>: <span class="token number">0.017</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [32]|DEBUG|Ending for Crud (with sorting): 11.867 seconds elapsed"><span class="lineCounter-0-0-15">26</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Ending <span class="token keyword">for</span> Crud <span class="token punctuation">(</span>with sorting<span class="token punctuation">)</span>: <span class="token number">11.867</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Starting for Crud (no sorting): 0.017 seconds elapsed"><span class="lineCounter-0-0-15">27</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Starting <span class="token keyword">for</span> Crud <span class="token punctuation">(</span>no sorting<span class="token punctuation">)</span>: <span class="token number">0.017</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [32]|DEBUG|Ending for Crud (no sorting): 4.783 seconds elapsed"><span class="lineCounter-0-0-15">28</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Ending <span class="token keyword">for</span> Crud <span class="token punctuation">(</span>no sorting<span class="token punctuation">)</span>: <span class="token number">4.783</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="#test run 28 ..."><span class="lineCounter-0-0-15">29</span><span class="token comment">#test run 28 ...</span></div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Starting for Database.insert: 0.017 seconds elapsed"><span class="lineCounter-0-0-15 prim">30</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Starting <span class="token keyword">for</span> Database.insert: <span class="token number">0.017</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [32]|DEBUG|Ending for Database.insert: 14.067 seconds elapsed"><span class="lineCounter-0-0-15">31</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Ending <span class="token keyword">for</span> Database.insert: <span class="token number">14.067</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Starting for Crud (with sorting): 0 seconds elapsed"><span class="lineCounter-0-0-15">32</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Starting <span class="token keyword">for</span> Crud <span class="token punctuation">(</span>with sorting<span class="token punctuation">)</span>: <span class="token number">0</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [32]|DEBUG|Ending for Crud (with sorting): 4.533 seconds elapsed"><span class="lineCounter-0-0-15">33</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Ending <span class="token keyword">for</span> Crud <span class="token punctuation">(</span>with sorting<span class="token punctuation">)</span>: <span class="token number">4.533</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Starting for Crud (no sorting): 0 seconds elapsed"><span class="lineCounter-0-0-15">34</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Starting <span class="token keyword">for</span> Crud <span class="token punctuation">(</span>no sorting<span class="token punctuation">)</span>: <span class="token number">0</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [32]|DEBUG|Ending for Crud (no sorting): 13.833 seconds elapsed"><span class="lineCounter-0-0-15 prim">35</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Ending <span class="token keyword">for</span> Crud <span class="token punctuation">(</span>no sorting<span class="token punctuation">)</span>: <span class="token number">13.833</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="#test run 27"><span class="lineCounter-0-0-15">36</span><span class="token comment">#test run 27</span></div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Starting for Database.insert: 0.017 seconds elapsed"><span class="lineCounter-0-0-15">37</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Starting <span class="token keyword">for</span> Database.insert: <span class="token number">0.017</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [32]|DEBUG|Ending for Database.insert: 3.15 seconds elapsed"><span class="lineCounter-0-0-15">38</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Ending <span class="token keyword">for</span> Database.insert: <span class="token number">3.15</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Starting for Crud (with sorting): 0 seconds elapsed"><span class="lineCounter-0-0-15">39</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Starting <span class="token keyword">for</span> Crud <span class="token punctuation">(</span>with sorting<span class="token punctuation">)</span>: <span class="token number">0</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [32]|DEBUG|Ending for Crud (with sorting): 0.4 seconds elapsed"><span class="lineCounter-0-0-15 prim">40</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Ending <span class="token keyword">for</span> Crud <span class="token punctuation">(</span>with sorting<span class="token punctuation">)</span>: <span class="token number">0.4</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Starting for Crud (no sorting): 0.017 seconds elapsed"><span class="lineCounter-0-0-15">41</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Starting <span class="token keyword">for</span> Crud <span class="token punctuation">(</span>no sorting<span class="token punctuation">)</span>: <span class="token number">0.017</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [32]|DEBUG|Ending for Crud (no sorting): 1.417 seconds elapsed"><span class="lineCounter-0-0-15">42</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Ending <span class="token keyword">for</span> Crud <span class="token punctuation">(</span>no sorting<span class="token punctuation">)</span>: <span class="token number">1.417</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="#.... etc"><span class="lineCounter-0-0-15 prim">43</span><span class="token comment">#.... etc</span></div><br></code></pre><p>I could keep going. Anybody can run these test at home though, so I hardly think it necessary. Out of my 30+ sample size test runs, let's take the 6 results above and do some tabulation &amp; classic statistical modeling:</p><table><thead><th>Method</th><th>Tabulation</th><th>Value</th></thead><tbody><tr><td>Database.insert</td><td>Average</td><td>8.0195</td></tr><tr><td>Database.insert</td><td>Standard Deviation</td><td>5.12941099</td></tr><tr><td>Crud (sorting)</td><td>Average</td><td>5.647166667</td></tr><tr><td>Crud (sorting)</td><td>Standard Deviation</td><td>4.237680895</td></tr><tr><td>Crud (no sorting)</td><td>Average</td><td>5.8555</td></tr><tr><td>Crud (no sorting)</td><td>Standard Deviation</td><td>4.245394293</td></tr></tbody></table><p>The 95% confidence interval (2.3723 ± 6.05222962) comparing <code>Database.insert</code> to the sorting method results in a range from 0 - 8.42456362 with a standard error of 2.72. The <code>sort</code> method isn't even close to operating in quadratic / linearithmic time. Given that the sorting average is within the first standard deviation for not sorting, most statisticians would probably just throw their hands up and give up the comparison entirely.</p><p>In other words, there's no significant performance degradation with the use of the baseline <code>Crud</code> library. Indeed, in the vast majority of instances, it compares favorably with the baseline implementation, even if sorting is used. Statistically speaking, any performance degradation (if it did occur) isn't even close to significance, but <em>generally</em> speaking, it's likely that your production performance bottleneck isn't going to be determined by how you insert/update/upsert things; it's going to be determined by how efficient the handler(s) you have that are called by said actions.</p><div class="tabs-0-0-18"><script id="WKFyHVvkOH">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("WKFyHVvkOH", "T764P9zpaV5eSCd1H0okyw==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script><div class="tab first selected" data-tab-title="Notes On FFLib"><p>To be clear -- you can do a lot more with the FFLib library. My point in writing this whole series has not been to villify FFLib -- it's been to contend that if the vast majority of testing time is sunk into DML, you might not <em>need</em> to mock every other dependency that you have, and that if the use of those mocks doesn't actually measurably speed up your testing time, you'd be better off not using the library at all. Merely mocking queries/DML will save you huge increments of time with a much smaller mocking footprint. Focusing on small changes that produce big wins is a <em>proven</em> success strategy, and I hope that you'll be encouraged by these results to think about how you can optimize your/your team's development accordingly.</p></div><div class="tab" data-tab-title="FFLib Footnote"><p>Using an example relying on a string field, as per the original answer on the Salesforce Stack Exchange, is brilliant, by the way. Most other fields you'd want to sort on, assuming that your custom sorting depended on only one field at all, don't have access to a built-in method to provide the 1, -1, or 0. There's no "compareTo" for Dates, or Datetimes, for example.</p></div></div><h2 id="implementing-custom-sorting-in-apex" class="heading-0-0-12"><span class="anchor-0-0-13" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Implementing Custom Sorting In Apex</h2><p>One of the big takeaways from the above is that the default sorting implementation in Apex, at least for SObjects, is absurdly performant. That's really good news. But what happens if you need to sort your SObjects very specifically?</p><p>Moving on to another interesting subject -- custom sorting. Some of you may recall that in the footnotes for the Joys Of Apex post on <a href="/joys-of-apex/enum-apex-class-gotchas">Enums</a>, I spoke about the <code>Comparable</code> interface in Apex, part of the standard library for Apex. To review, classes looking to implement <code>Comparable</code> have to conform to the following contract:</p><pre class=""><code class="java code-0-0-14" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16 " data-content="//where the Integer returned"><span class="lineCounter-0-0-15 prim">1</span><span class="token comment">//where the Integer returned</span></div><br><div class="line-0-0-16 " data-content="//should be either:"><span class="lineCounter-0-0-15">2</span><span class="token comment">//should be either:</span></div><br><div class="line-0-0-16 " data-content="//-1 for less than, 1 for greater than"><span class="lineCounter-0-0-15">3</span><span class="token comment">//-1 for less than, 1 for greater than</span></div><br><div class="line-0-0-16 " data-content="//or 0 for functionally equivalent"><span class="lineCounter-0-0-15">4</span><span class="token comment">//or 0 for functionally equivalent</span></div><br><div class="line-0-0-16 " data-content="global Integer compareTo(Object compareTo);"><span class="lineCounter-0-0-15 prim">5</span>global <span class="token class-name">Integer</span> <span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token class-name">Object</span> compareTo<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br></code></pre><h3 id="an-example-comparable-implementation-online" class="heading-0-0-12"><span class="anchor-0-0-13" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>An Example Comparable Implementation Online</h3><p>There's a fairly well-viewed Salesforce stack exchange post on <a href="https://salesforce.stackexchange.com/questions/95671/apex-equivalent-of-java-comparator">creating a Comparator class</a>, the accepted answer for which features an .... object-oriented-lite ... version of a way to easily implement custom sorting within Apex. I'm going to show you the code that is suggested there, and then massage it to be more idiomatic. On the subject of performance, however, both implementations feature placeholder-lists, which is presumably the source for much of the performance overhead when it comes to using a custom sorter.</p><p>The original answer:</p><pre class="with-bar"><code class="java code-0-0-14" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span>classes/Comparator.cls</span></span><div class="line-0-0-16 " data-content="//I've posted the entirety of the response, unedited:"><span class="lineCounter-0-0-15 prim">1</span><span class="token comment">//I've posted the entirety of the response, unedited:</span></div><br><div class="line-0-0-16 " data-content="public abstract class Comparator {"><span class="lineCounter-0-0-15">2</span><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Comparator</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    public abstract Integer compare(Object o1, Object o2);"><span class="lineCounter-0-0-15">3</span>    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token class-name">Integer</span> <span class="token function">compare</span><span class="token punctuation">(</span><span class="token class-name">Object</span> o1<span class="token punctuation">,</span> <span class="token class-name">Object</span> o2<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    public static void sort(Object[] values, Comparator comp) {"><span class="lineCounter-0-0-15">4</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">sort</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> values<span class="token punctuation">,</span> <span class="token class-name">Comparator</span> comp<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="        //  Obtain the list type of values"><span class="lineCounter-0-0-15 prim">5</span>        <span class="token comment">//  Obtain the list type of values</span></div><br><div class="line-0-0-16 " data-content="        Object[] temp = values.clone();"><span class="lineCounter-0-0-15">6</span>        <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> temp <span class="token operator">=</span> values<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="        temp.clear();"><span class="lineCounter-0-0-15">7</span>        temp<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="        //  Helper class for sorting using Comparable"><span class="lineCounter-0-0-15">8</span>        <span class="token comment">//  Helper class for sorting using Comparable</span></div><br><div class="line-0-0-16 " data-content="        Helper[] tempValues = new Helper[0];"><span class="lineCounter-0-0-15">9</span>        <span class="token class-name">Helper</span><span class="token punctuation">[</span><span class="token punctuation">]</span> tempValues <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Helper</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="        for(Object value: values) {"><span class="lineCounter-0-0-15 prim">10</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Object</span> value<span class="token operator">:</span> values<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="            tempValues.add(new Helper(comp, value));"><span class="lineCounter-0-0-15">11</span>            tempValues<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Helper</span><span class="token punctuation">(</span>comp<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="        }"><span class="lineCounter-0-0-15">12</span>        <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="        //  Perform sort"><span class="lineCounter-0-0-15">13</span>        <span class="token comment">//  Perform sort</span></div><br><div class="line-0-0-16 " data-content="        tempValues.sort();"><span class="lineCounter-0-0-15">14</span>        tempValues<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="        //  Extract values back into temp list"><span class="lineCounter-0-0-15 prim">15</span>        <span class="token comment">//  Extract values back into temp list</span></div><br><div class="line-0-0-16 " data-content="        for(Helper helper: tempValues) {"><span class="lineCounter-0-0-15">16</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Helper</span> helper<span class="token operator">:</span> tempValues<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="            temp.add(helper.value);"><span class="lineCounter-0-0-15">17</span>            temp<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>helper<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="        }"><span class="lineCounter-0-0-15">18</span>        <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="        //  And set the list to the new, sorted order"><span class="lineCounter-0-0-15">19</span>        <span class="token comment">//  And set the list to the new, sorted order</span></div><br><div class="line-0-0-16 " data-content="        values.clear();"><span class="lineCounter-0-0-15 prim">20</span>        values<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="        values.addAll(temp);"><span class="lineCounter-0-0-15">21</span>        values<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    }"><span class="lineCounter-0-0-15">22</span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="    //  Simply calls Comparator when asked."><span class="lineCounter-0-0-15">23</span>    <span class="token comment">//  Simply calls Comparator when asked.</span></div><br><div class="line-0-0-16 " data-content="    class Helper implements Comparable {"><span class="lineCounter-0-0-15">24</span>    <span class="token keyword">class</span> <span class="token class-name">Helper</span> <span class="token keyword">implements</span> <span class="token class-name">Comparable</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="        Comparator method;"><span class="lineCounter-0-0-15 prim">25</span>        <span class="token class-name">Comparator</span> method<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="        Object value;"><span class="lineCounter-0-0-15">26</span>        <span class="token class-name">Object</span> value<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="        Helper(Comparator comp, Object val) {"><span class="lineCounter-0-0-15">27</span>        <span class="token class-name">Helper</span><span class="token punctuation">(</span><span class="token class-name">Comparator</span> comp<span class="token punctuation">,</span> <span class="token class-name">Object</span> val<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="            method = comp;"><span class="lineCounter-0-0-15">28</span>            method <span class="token operator">=</span> comp<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="            value = val;"><span class="lineCounter-0-0-15">29</span>            value <span class="token operator">=</span> val<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="        }"><span class="lineCounter-0-0-15 prim">30</span>        <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="        public Integer compareTo(Object o) {"><span class="lineCounter-0-0-15">31</span>        <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token class-name">Object</span> o<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="            return method.compare(value, ((Helper)o).value);"><span class="lineCounter-0-0-15">32</span>            <span class="token keyword">return</span> method<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Helper</span><span class="token punctuation">)</span>o<span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="        }"><span class="lineCounter-0-0-15">33</span>        <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="    }"><span class="lineCounter-0-0-15">34</span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="}"><span class="lineCounter-0-0-15 prim">35</span><span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">36</span></div><br><div class="line-0-0-16 " data-content="//From here, you can create your own solutions:"><span class="lineCounter-0-0-15">37</span><span class="token comment">//From here, you can create your own solutions:</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">38</span></div><br><div class="line-0-0-16 " data-content="public class AccountNameComparator extends Comparator {"><span class="lineCounter-0-0-15">39</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AccountNameComparator</span> <span class="token keyword">extends</span> <span class="token class-name">Comparator</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    public override Integer compare(Object a, Object b) {"><span class="lineCounter-0-0-15 prim">40</span>    <span class="token keyword">public</span> override <span class="token class-name">Integer</span> <span class="token function">compare</span><span class="token punctuation">(</span><span class="token class-name">Object</span> a<span class="token punctuation">,</span> <span class="token class-name">Object</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="        return ((Account)a).name.compareTo(((Account)b).name);"><span class="lineCounter-0-0-15">41</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Account</span><span class="token punctuation">)</span>a<span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Account</span><span class="token punctuation">)</span>b<span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    }"><span class="lineCounter-0-0-15">42</span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="}"><span class="lineCounter-0-0-15">43</span><span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">44</span></div><br><div class="line-0-0-16 " data-content="//Which would let you sort as you like:"><span class="lineCounter-0-0-15 prim">45</span><span class="token comment">//Which would let you sort as you like:</span></div><br><div class="line-0-0-16 " data-content="Account[] accounts = [SELECT Name FROM Account ORDER BY CreatedDate LIMIT 5];"><span class="lineCounter-0-0-15">46</span><span class="token class-name">Account</span><span class="token punctuation">[</span><span class="token punctuation">]</span> accounts <span class="token operator">=</span> <span class="token punctuation">[</span>SELECT <span class="token class-name">Name</span> FROM <span class="token class-name">Account</span> ORDER BY <span class="token class-name">CreatedDate</span> LIMIT <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="Comparator.sort(accounts, new AccountNameComparator());"><span class="lineCounter-0-0-15 prim">47</span><span class="token class-name">Comparator</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>accounts<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">AccountNameComparator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br></code></pre><h3 id="joys-of-apex-suggested-comparable-implementation" class="heading-0-0-12"><span class="anchor-0-0-13" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Joys Of Apex Suggested Comparable Implementation</h3><p>One of the things that I try to stress here is the importance of naming. Using names like <code>Helper</code> doesn't tell anybody what you're up to. Likewise, the use of a static method on <code>Comparator</code> is kind of a bummer. Let's <em>encapsulate</em> the sorting behavior, rename things, and expose a better interface using the same example of sorting by Account name [^5]:</p><pre class="with-bar"><code class="java code-0-0-14" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span>classes/Comparator.cls</span></span><div class="line-0-0-16 " data-content="public abstract class Comparator {"><span class="lineCounter-0-0-15 prim">1</span><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Comparator</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  public abstract Integer compare(Object o1, Object o2);"><span class="lineCounter-0-0-15">2</span>  <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token class-name">Integer</span> <span class="token function">compare</span><span class="token punctuation">(</span><span class="token class-name">Object</span> o1<span class="token punctuation">,</span> <span class="token class-name">Object</span> o2<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">3</span></div><br><div class="line-0-0-16 " data-content="    public void sort(Object[] values) {"><span class="lineCounter-0-0-15">4</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sort</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> values<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="      Object[] temp = new List<Object>();"><span class="lineCounter-0-0-15 prim">5</span>      <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> temp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="      ItemWrapper[] wrappedItems = new List<ItemWrapper>();"><span class="lineCounter-0-0-15">6</span>      <span class="token class-name">ItemWrapper</span><span class="token punctuation">[</span><span class="token punctuation">]</span> wrappedItems <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ItemWrapper</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">7</span></div><br><div class="line-0-0-16 " data-content="      for(Object value: values) {"><span class="lineCounter-0-0-15">8</span>      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Object</span> value<span class="token operator">:</span> values<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="        wrappedItems.add(new ItemWrapper(this, value));"><span class="lineCounter-0-0-15">9</span>        wrappedItems<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ItemWrapper</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="      }"><span class="lineCounter-0-0-15 prim">10</span>      <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">11</span></div><br><div class="line-0-0-16 " data-content="      wrappedItems.sort();"><span class="lineCounter-0-0-15">12</span>      wrappedItems<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">13</span></div><br><div class="line-0-0-16 " data-content="      for(ItemWrapper item: wrappedItems) {"><span class="lineCounter-0-0-15">14</span>      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">ItemWrapper</span> item<span class="token operator">:</span> wrappedItems<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="        temp.add(item.value);"><span class="lineCounter-0-0-15 prim">15</span>        temp<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="      }"><span class="lineCounter-0-0-15">16</span>      <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">17</span></div><br><div class="line-0-0-16 " data-content="      values.clear();"><span class="lineCounter-0-0-15">18</span>      values<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="      values.addAll(temp);"><span class="lineCounter-0-0-15">19</span>      values<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    }"><span class="lineCounter-0-0-15 prim">20</span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">21</span></div><br><div class="line-0-0-16 " data-content="  private class ItemWrapper implements Comparable {"><span class="lineCounter-0-0-15">22</span>  <span class="token keyword">private</span> <span class="token keyword">class</span> <span class="token class-name">ItemWrapper</span> <span class="token keyword">implements</span> <span class="token class-name">Comparable</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    private final Comparator comparer;"><span class="lineCounter-0-0-15">23</span>    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Comparator</span> comparer<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    private final Object value;"><span class="lineCounter-0-0-15">24</span>    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Object</span> value<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15 prim">25</span></div><br><div class="line-0-0-16 " data-content="    public ItemWrapper(Comparator comparer, Object value) {"><span class="lineCounter-0-0-15">26</span>    <span class="token keyword">public</span> <span class="token class-name">ItemWrapper</span><span class="token punctuation">(</span><span class="token class-name">Comparator</span> comparer<span class="token punctuation">,</span> <span class="token class-name">Object</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="      this.comparer = comparer;"><span class="lineCounter-0-0-15">27</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>comparer <span class="token operator">=</span> comparer<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="      this.value = value;"><span class="lineCounter-0-0-15">28</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    }"><span class="lineCounter-0-0-15">29</span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15 prim">30</span></div><br><div class="line-0-0-16 " data-content="    public Integer compareTo(Object o) {"><span class="lineCounter-0-0-15">31</span>    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token class-name">Object</span> o<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="        return comparer.compare(value, ((ItemWrapper)o).value);"><span class="lineCounter-0-0-15">32</span>        <span class="token keyword">return</span> comparer<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">ItemWrapper</span><span class="token punctuation">)</span>o<span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    }"><span class="lineCounter-0-0-15">33</span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="  }"><span class="lineCounter-0-0-15">34</span>  <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="}"><span class="lineCounter-0-0-15 prim">35</span><span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">36</span></div><br><div class="line-0-0-16 " data-content="//same as before"><span class="lineCounter-0-0-15">37</span><span class="token comment">//same as before</span></div><br><div class="line-0-0-16 " data-content="public class AccountNameComparator extends Comparator {"><span class="lineCounter-0-0-15">38</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AccountNameComparator</span> <span class="token keyword">extends</span> <span class="token class-name">Comparator</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    public override Integer compare(Object a, Object b) {"><span class="lineCounter-0-0-15">39</span>    <span class="token keyword">public</span> override <span class="token class-name">Integer</span> <span class="token function">compare</span><span class="token punctuation">(</span><span class="token class-name">Object</span> a<span class="token punctuation">,</span> <span class="token class-name">Object</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="        return ((Account)a).Name.compareTo(((Account)b).Name);"><span class="lineCounter-0-0-15 prim">40</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Account</span><span class="token punctuation">)</span>a<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token class-name">Name</span><span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Account</span><span class="token punctuation">)</span>b<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token class-name">Name</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    }"><span class="lineCounter-0-0-15">41</span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="}"><span class="lineCounter-0-0-15">42</span><span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">43</span></div><br><div class="line-0-0-16 " data-content="//much cleaner"><span class="lineCounter-0-0-15">44</span><span class="token comment">//much cleaner</span></div><br><div class="line-0-0-16 " data-content="Account[] accounts = [SELECT Name FROM Account ORDER BY CreatedDate LIMIT 5];"><span class="lineCounter-0-0-15 prim">45</span><span class="token class-name">Account</span><span class="token punctuation">[</span><span class="token punctuation">]</span> accounts <span class="token operator">=</span> <span class="token punctuation">[</span>SELECT <span class="token class-name">Name</span> FROM <span class="token class-name">Account</span> ORDER BY <span class="token class-name">CreatedDate</span> LIMIT <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="new AccountNameComparator().sort(accounts);"><span class="lineCounter-0-0-15 prim">46</span><span class="token keyword">new</span> <span class="token class-name">AccountNameComparator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>accounts<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br></code></pre><p>By passing the <code>Comparator</code> instance using the <code>this</code> keyword, we completely eliminate the static method and instead allow consumers of custom sorting to simply define their sorting algorithm in a class extending <code>Comparator</code> prior to calling the <code>sort</code> method with their list. That's properly object-oriented.</p><p>Let's revisit our <code>Function</code> class to observe whether or not custom sorting is really going to bite us in production:</p><pre class="with-bar"><code class="java code-0-0-14" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span>Anonymous Apex Function.cls</span></span><div class="line-0-0-16 " data-content="//with getAccounts() set to return 10,000 rows"><span class="lineCounter-0-0-15 prim">1</span><span class="token comment">//with getAccounts() set to return 10,000 rows</span></div><br><div class="line-0-0-16 " data-content="public class BaselineSorting extends Function {"><span class="lineCounter-0-0-15">2</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BaselineSorting</span> <span class="token keyword">extends</span> <span class="token class-name">Function</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  protected override String getTypeName() { return 'Baseline sorting'; }"><span class="lineCounter-0-0-15">3</span>  <span class="token keyword">protected</span> override <span class="token class-name">String</span> <span class="token function">getTypeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token string">'Baseline sorting'</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">4</span></div><br><div class="line-0-0-16 " data-content="    protected override void call() {"><span class="lineCounter-0-0-15 prim">5</span>    <span class="token keyword">protected</span> override <span class="token keyword">void</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    List<Account> accounts = this.getAccounts();"><span class="lineCounter-0-0-15">6</span>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Account</span><span class="token punctuation">&gt;</span></span> accounts <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAccounts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    accounts.sort();"><span class="lineCounter-0-0-15">7</span>    accounts<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  }"><span class="lineCounter-0-0-15">8</span>  <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="}"><span class="lineCounter-0-0-15">9</span><span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15 prim">10</span></div><br><div class="line-0-0-16 " data-content="public class CustomSorting extends Function {"><span class="lineCounter-0-0-15">11</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomSorting</span> <span class="token keyword">extends</span> <span class="token class-name">Function</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="  protected override String getTypeName() { return 'Custom sorting'; }"><span class="lineCounter-0-0-15">12</span>  <span class="token keyword">protected</span> override <span class="token class-name">String</span> <span class="token function">getTypeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token string">'Custom sorting'</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">13</span></div><br><div class="line-0-0-16 " data-content="    protected override void call() {"><span class="lineCounter-0-0-15">14</span>    <span class="token keyword">protected</span> override <span class="token keyword">void</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16 " data-content="    List<Account> accounts = this.getAccounts();"><span class="lineCounter-0-0-15 prim">15</span>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Account</span><span class="token punctuation">&gt;</span></span> accounts <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAccounts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="    new AccountNameComparator().sort(accounts);"><span class="lineCounter-0-0-15">16</span>    <span class="token keyword">new</span> <span class="token class-name">AccountNameComparator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>accounts<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="  }"><span class="lineCounter-0-0-15">17</span>  <span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content="}"><span class="lineCounter-0-0-15">18</span><span class="token punctuation">}</span></div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">19</span></div><br><div class="line-0-0-16 " data-content="new BaselineSorting();"><span class="lineCounter-0-0-15 prim">20</span><span class="token keyword">new</span> <span class="token class-name">BaselineSorting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-16 " data-content="new CustomSorting();"><span class="lineCounter-0-0-15 prim">21</span><span class="token keyword">new</span> <span class="token class-name">CustomSorting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br></code></pre><p>Answer -- it depends, but probably yes. Again, there's quite a bit of variance in run times:</p><pre class=""><code class="bash code-0-0-14" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16 " data-content="#Run 5"><span class="lineCounter-0-0-15 prim">1</span><span class="token comment">#Run 5</span></div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Starting for Baseline sorting: 0.017 seconds elapsed"><span class="lineCounter-0-0-15">2</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Starting <span class="token keyword">for</span> Baseline sorting: <span class="token number">0.017</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Ending for Baseline sorting: 5.067 seconds elapsed"><span class="lineCounter-0-0-15">3</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Ending <span class="token keyword">for</span> Baseline sorting: <span class="token number">5.067</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Starting for Custom sorting: 0 seconds elapsed"><span class="lineCounter-0-0-15">4</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Starting <span class="token keyword">for</span> Custom sorting: <span class="token number">0</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Ending for Custom sorting: 15.25 seconds elapsed"><span class="lineCounter-0-0-15 prim">5</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Ending <span class="token keyword">for</span> Custom sorting: <span class="token number">15.25</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">6</span></div><br><div class="line-0-0-16 " data-content="#Run 4"><span class="lineCounter-0-0-15">7</span><span class="token comment">#Run 4</span></div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Starting for Baseline sorting: 0.017 seconds elapsed"><span class="lineCounter-0-0-15">8</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Starting <span class="token keyword">for</span> Baseline sorting: <span class="token number">0.017</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Ending for Baseline sorting: 4.617 seconds elapsed"><span class="lineCounter-0-0-15">9</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Ending <span class="token keyword">for</span> Baseline sorting: <span class="token number">4.617</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Starting for Custom sorting: 0.017 seconds elapsed"><span class="lineCounter-0-0-15 prim">10</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Starting <span class="token keyword">for</span> Custom sorting: <span class="token number">0.017</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Ending for Custom sorting: 16.017 seconds elapsed"><span class="lineCounter-0-0-15">11</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Ending <span class="token keyword">for</span> Custom sorting: <span class="token number">16.017</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">12</span></div><br><div class="line-0-0-16 " data-content="#Run 3 (what happened here?!)"><span class="lineCounter-0-0-15">13</span><span class="token comment">#Run 3 (what happened here?!)</span></div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Starting for Baseline sorting: 0.017 seconds elapsed"><span class="lineCounter-0-0-15">14</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Starting <span class="token keyword">for</span> Baseline sorting: <span class="token number">0.017</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Ending for Baseline sorting: 5.433 seconds elapsed"><span class="lineCounter-0-0-15 prim">15</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Ending <span class="token keyword">for</span> Baseline sorting: <span class="token number">5.433</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Starting for Custom sorting: 0.017 seconds elapsed"><span class="lineCounter-0-0-15">16</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Starting <span class="token keyword">for</span> Custom sorting: <span class="token number">0.017</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Ending for Custom sorting: 1.317 seconds elapsed"><span class="lineCounter-0-0-15">17</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Ending <span class="token keyword">for</span> Custom sorting: <span class="token number">1.317</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">18</span></div><br><div class="line-0-0-16 " data-content="#Run 2"><span class="lineCounter-0-0-15">19</span><span class="token comment">#Run 2</span></div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Starting for Baseline sorting: 0 seconds elapsed"><span class="lineCounter-0-0-15 prim">20</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Starting <span class="token keyword">for</span> Baseline sorting: <span class="token number">0</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Ending for Baseline sorting: 4.8 seconds elapsed"><span class="lineCounter-0-0-15">21</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Ending <span class="token keyword">for</span> Baseline sorting: <span class="token number">4.8</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Starting for Custom sorting: 0.017 seconds elapsed"><span class="lineCounter-0-0-15">22</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Starting <span class="token keyword">for</span> Custom sorting: <span class="token number">0.017</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Ending for Custom sorting: 14.467 seconds elapsed"><span class="lineCounter-0-0-15">23</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Ending <span class="token keyword">for</span> Custom sorting: <span class="token number">14.467</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content=""><span class="lineCounter-0-0-15">24</span></div><br><div class="line-0-0-16 " data-content="#Run 1"><span class="lineCounter-0-0-15 prim">25</span><span class="token comment">#Run 1</span></div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Starting for Baseline sorting: 0 seconds elapsed"><span class="lineCounter-0-0-15">26</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Starting <span class="token keyword">for</span> Baseline sorting: <span class="token number">0</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Ending for Baseline sorting: 6.533 seconds elapsed"><span class="lineCounter-0-0-15">27</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Ending <span class="token keyword">for</span> Baseline sorting: <span class="token number">6.533</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Starting for Custom sorting: 0 seconds elapsed"><span class="lineCounter-0-0-15">28</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Starting <span class="token keyword">for</span> Custom sorting: <span class="token number">0</span> seconds elapsed</div><br><div class="line-0-0-16 " data-content="USER_DEBUG [24]|DEBUG|Ending for Custom sorting: 15.767 seconds elapsed"><span class="lineCounter-0-0-15 prim">29</span>USER_DEBUG <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">|</span>DEBUG<span class="token operator">|</span>Ending <span class="token keyword">for</span> Custom sorting: <span class="token number">15.767</span> seconds elapsed</div><br></code></pre><p>That being said, who is actually sorting 10k Accounts at a given time? When I'm using custom sorting, it's typically on a couple hundred records at a given time. The performance cost may well be negligible for numbers like that -- if the above example takes .283 seconds to sort 200 Accounts, you might not even notice the difference. Again, in FinTech, thousandths of a second matter. In most other arenas ... they don't. Plan accordingly.</p><h2 id="conclusion-on-sorting-performance-in-apex" class="heading-0-0-12"><span class="anchor-0-0-13" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Conclusion On Sorting Performance In Apex</h2><p>The TL;DR would probably look something like this:</p><ul><li>The assertion that sorting records in <code>Crud</code> is going to noticeable slow down your production instance's DML statements is demonstrably false</li><li>The built-in SObject sorting method is crazy-performant in Apex</li><li>Custom sorting can indeed slow down your application, so if latency matters, you may want to push operations that require custom sorting to asynchronous threads in order to maximize responsiveness</li></ul><p>Thanks for reading the latest in the the <a href="">Joys Of Apex</a>. I hope you enjoyed -- till next time!</p><p><strong>Edit</strong>:</p><p>The same reader pointed out that the list I was using in the original <code>Function</code> example was essentially pre-sorted, and that because SObject comparisons compare all fields supplied on the object (as well as its <code>SObjectType</code> label), I was potentially misrepresenting the results displayed by virtue of only having each account initialized based off of a Name field with the string value of the list's index. It seems that the reader's first issue -- that sorting large lists could lead to catastrophic performance concerns -- had been transformed into the argument that performing additional comparisons was going to be inordinately costly.</p><p>I've updated the article (and the subsequent figures) to reflect Accounts inserted into the list in a far more random fashion, with more fields filled out, to show that it doesn't significantly affect performance. Indeed, the numbers are virtually the same. No matter, though -- I'm sure I'll have to fire up JMeter and livestream the new quadsort algorithm before this particular person is happy 🤣</p><div class="contentnav-0-0-7" data-no-search=""><a href="#stress-testing-the-crud-implementation" class="h2" data-content-highlight="stress-testing-the-crud-implementation">Stress Testing The Crud Implementation</a><a href="#implementing-custom-sorting-in-apex" class="h2" data-content-highlight="implementing-custom-sorting-in-apex">Implementing Custom Sorting In Apex</a><a href="#an-example-comparable-implementation-online" class="h3" data-content-highlight="an-example-comparable-implementation-online">An Example Comparable Implementation Online</a><a href="#joys-of-apex-suggested-comparable-implementation" class="h3" data-content-highlight="joys-of-apex-suggested-comparable-implementation">Joys Of Apex Suggested Comparable Implementation</a><a href="#conclusion-on-sorting-performance-in-apex" class="h2" data-content-highlight="conclusion-on-sorting-performance-in-apex">Conclusion On Sorting Performance In Apex</a></div></div><div id="-codedoc-toc" class="toc-0-0-4"><div class="content-0-0-5"><p><a href="/joys-of-apex/">Home</a>
<a href="/joys-of-apex/apex-logging-service">Apex Logging Service</a>
<a href="/joys-of-apex/apex-object-oriented-basics">Apex Object-Oriented Basics</a>
<a href="/joys-of-apex/batchable-and-queueable-apex">Batchable And Queueable Apex</a>
<a href="/joys-of-apex/building-a-better-singleton">Building A Better Singleton</a>
<a href="/joys-of-apex/continuous-integration-with-sfdx">Continuous Integration With SFDX</a>
<a href="/joys-of-apex/dependency-injection-factory-pattern">Dependency Injection &amp; Factory Pattern</a>
<a href="/joys-of-apex/enum-apex-class-gotchas">Enum Apex Class Gotchas</a>
<a href="/joys-of-apex/extendable-apis">Extendable Apis</a>
<a href="/joys-of-apex/future-method-callout-callback">Future Methods, Callouts &amp; Callbacks</a>
<a href="/joys-of-apex/idiomatic-salesforce-apex">Idiomatic Salesforce Apex</a>
<a href="/joys-of-apex/intro">Introduction &amp; Testing Philosophy</a>
<a href="/joys-of-apex/lazy-iterators">Lazy Iterators</a>
<a href="/joys-of-apex/lightweight-trigger-handler">Lightweight Trigger Handler</a>
<a href="/joys-of-apex/lwc-composable-modal">LWC Composable Modal</a>
<a href="/joys-of-apex/lwc-composable-pagination">LWC Composable Pagination</a>
<a href="/joys-of-apex/mocking-dml">Mocking DML</a>
<a href="/joys-of-apex/react-versus-lightning-web-components">React Versus Lightning Web Components</a>
<a href="/joys-of-apex/repository-pattern">Repository Pattern</a>
<a href="/joys-of-apex/sorting-and-performance-in-apex">Sorting And Performance In Apex</a>
<a href="/joys-of-apex/test-driven-development-example">Test Driven Development Example</a>
<a href="/joys-of-apex/writing-performant-apex-tests">Writing Performant Apex Tests</a></p><p><br><br></p><p><a href="https://www.jamessimone.net/">Read more tech articles</a></p></div></div><div class="footer-0-0-3"><div class="left"><script id="LATBQWt_cR">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("LATBQWt_cR", "BWW0vHR4333HbDOiwZ67JA==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script></div><div class="main"><div class="inside"></div></div><div class="right"><script id="nqUWmLEJSA">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("nqUWmLEJSA", "6yEdMfRRlNsUBKSBOTazFg==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script></div></div><script id="EYbxwdZnYQ">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("EYbxwdZnYQ", "wh9V9isakhdwzlz9ZUjvyw==", {"namespace":"/joys-of-apex"});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script></body></html>